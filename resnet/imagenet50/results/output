/home/xiao/anaconda2/envs/tf/bin/python /home/xiao/projects/MSDNet/ResNet50.py
Using TensorFlow backend.
2017-11-25 22:08:42.988787: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-25 22:08:42.988813: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-25 22:08:42.988818: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-11-25 22:08:42.988823: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-25 22:08:42.988828: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-11-25 22:08:43.179079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.6705
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 10.54GiB
2017-11-25 22:08:43.179099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2017-11-25 22:08:43.179103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2017-11-25 22:08:43.179112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
2017-11-25 22:08:45.704376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
[4.4115202243511495, 0.026041666666666668]
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 64)   4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 64)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 64)   36928       activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 64)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  16640       activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 64)   16448       activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 64)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 64)   36928       activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 64)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  16640       activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
ee2b (Activation)               (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 64)   16448       ee2b[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 64)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 64)   36928       activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 64)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  16640       activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 ee2b[0][0]
__________________________________________________________________________________________________
ee2c (Activation)               (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 128)  32896       ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 28, 28, 128)  0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 128)  147584      activation_9[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 28, 28, 128)  0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  66048       activation_10[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_11[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 128)  0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 128)  147584      activation_12[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 128)  0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  66048       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_11[0][0]
__________________________________________________________________________________________________
ee3b (Activation)               (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 128)  65664       ee3b[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 128)  0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 128)  147584      activation_14[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 128)  0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  66048       activation_15[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 ee3b[0][0]
__________________________________________________________________________________________________
ee3c (Activation)               (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 128)  65664       ee3c[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 128)  0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 128)  147584      activation_16[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 128)  0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  66048       activation_17[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 ee3c[0][0]
__________________________________________________________________________________________________
ee3d (Activation)               (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 256)  131328      ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 14, 14, 256)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_18[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 14, 14, 256)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_19[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 1024) 525312      ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 1024) 4096        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_20[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 14, 14, 256)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_21[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 14, 14, 256)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_22[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           bn4b_branch2c[0][0]
                                                                 activation_20[0][0]
__________________________________________________________________________________________________
ee4b (Activation)               (None, 14, 14, 1024) 0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 256)  262400      ee4b[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 256)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_23[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 256)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_24[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           bn4c_branch2c[0][0]
                                                                 ee4b[0][0]
__________________________________________________________________________________________________
ee4c (Activation)               (None, 14, 14, 1024) 0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 256)  262400      ee4c[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 256)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_25[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 256)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_26[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           bn4d_branch2c[0][0]
                                                                 ee4c[0][0]
__________________________________________________________________________________________________
ee4d (Activation)               (None, 14, 14, 1024) 0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 256)  262400      ee4d[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 256)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_27[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 256)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_28[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 1024) 0           bn4e_branch2c[0][0]
                                                                 ee4d[0][0]
__________________________________________________________________________________________________
ee4e (Activation)               (None, 14, 14, 1024) 0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 256)  262400      ee4e[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 256)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_29[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 256)  0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_30[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 1024) 0           bn4f_branch2c[0][0]
                                                                 ee4e[0][0]
__________________________________________________________________________________________________
ee4f (Activation)               (None, 14, 14, 1024) 0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 512)    524800      ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 512)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 512)    2359808     activation_31[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 512)    2048        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 512)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 2048)   1050624     activation_32[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 2048)   2099200     ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 2048)   8192        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_33[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 512)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 512)    2359808     activation_34[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 512)    2048        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 512)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 2048)   1050624     activation_35[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           bn5b_branch2c[0][0]
                                                                 activation_33[0][0]
__________________________________________________________________________________________________
ee5b (Activation)               (None, 7, 7, 2048)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     ee5b[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 512)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 512)    2359808     activation_36[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 512)    2048        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 512)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 2048)   1050624     activation_37[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           bn5c_branch2c[0][0]
                                                                 ee5b[0][0]
__________________________________________________________________________________________________
ee5c (Activation)               (None, 7, 7, 2048)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 2048)   0           ee5c[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 50)           102450      flatten_1[0][0]
==================================================================================================
Total params: 23,690,162
Trainable params: 23,637,042
Non-trainable params: 53,120
__________________________________________________________________________________________________
Epoch 1/20
875/998 [=========================>....] - ETA: 2:21 - loss: 0.8529 - acc: 0.7554/home/xiao/anaconda2/envs/tf/lib/python3.5/site-packages/PIL/TiffImagePlugin.py:742: UserWarning: Corrupt EXIF data.  Expecting to read 4 bytes but only got 0.
  warnings.warn(str(msg))
997/998 [============================>.] - ETA: 1s - loss: 0.8202 - acc: 0.7633Epoch 00001: val_acc improved from -inf to 0.81410, saving model to ./resnet/imagenet/results/100_1/100_best.h5
Epoch 00001: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 1167s 1s/step - loss: 0.8200 - acc: 0.7633 - val_loss: 0.6241 - val_acc: 0.8141
Epoch 2/20
997/998 [============================>.] - ETA: 0s - loss: 0.4918 - acc: 0.8468Epoch 00002: val_acc did not improve
Epoch 00002: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 725s 727ms/step - loss: 0.4918 - acc: 0.8468 - val_loss: 0.6383 - val_acc: 0.8121
Epoch 3/20
997/998 [============================>.] - ETA: 0s - loss: 0.4046 - acc: 0.8724Epoch 00003: val_acc improved from 0.81410 to 0.81651, saving model to ./resnet/imagenet/results/100_1/100_best.h5
Epoch 00003: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 660s 661ms/step - loss: 0.4045 - acc: 0.8725 - val_loss: 0.6333 - val_acc: 0.8165
Epoch 4/20
997/998 [============================>.] - ETA: 0s - loss: 0.3403 - acc: 0.8899Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.3402 - acc: 0.8900 - val_loss: 0.7231 - val_acc: 0.7885
Epoch 5/20
997/998 [============================>.] - ETA: 0s - loss: 0.2950 - acc: 0.9027Epoch 00005: val_acc improved from 0.81651 to 0.81691, saving model to ./resnet/imagenet/results/100_1/100_best.h5
Epoch 00005: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 648s 650ms/step - loss: 0.2949 - acc: 0.9028 - val_loss: 0.6668 - val_acc: 0.8169
Epoch 6/20
997/998 [============================>.] - ETA: 0s - loss: 0.2564 - acc: 0.9154Epoch 00006: val_acc improved from 0.81691 to 0.82652, saving model to ./resnet/imagenet/results/100_1/100_best.h5
Epoch 00006: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.2563 - acc: 0.9154 - val_loss: 0.6812 - val_acc: 0.8265
Epoch 7/20
997/998 [============================>.] - ETA: 0s - loss: 0.2354 - acc: 0.9219Epoch 00007: val_acc did not improve
Epoch 00007: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.2354 - acc: 0.9219 - val_loss: 0.6665 - val_acc: 0.8185
Epoch 8/20
997/998 [============================>.] - ETA: 0s - loss: 0.2059 - acc: 0.9317Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.2057 - acc: 0.9317 - val_loss: 0.7363 - val_acc: 0.8021
Epoch 9/20
997/998 [============================>.] - ETA: 0s - loss: 0.1904 - acc: 0.9348Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1903 - acc: 0.9348 - val_loss: 0.7374 - val_acc: 0.8053
Epoch 10/20
997/998 [============================>.] - ETA: 0s - loss: 0.1726 - acc: 0.9429Epoch 00010: val_acc did not improve
Epoch 00010: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 645s 646ms/step - loss: 0.1725 - acc: 0.9429 - val_loss: 0.7191 - val_acc: 0.8161
Epoch 11/20
997/998 [============================>.] - ETA: 0s - loss: 0.1644 - acc: 0.9449Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.1645 - acc: 0.9449 - val_loss: 0.7315 - val_acc: 0.8125
Epoch 12/20
997/998 [============================>.] - ETA: 0s - loss: 0.1419 - acc: 0.9520Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 652s 653ms/step - loss: 0.1420 - acc: 0.9519 - val_loss: 0.8208 - val_acc: 0.8089
Epoch 13/20
997/998 [============================>.] - ETA: 0s - loss: 0.1390 - acc: 0.9529Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 647s 649ms/step - loss: 0.1389 - acc: 0.9529 - val_loss: 0.7530 - val_acc: 0.8161
Epoch 14/20
997/998 [============================>.] - ETA: 0s - loss: 0.1362 - acc: 0.9540Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1361 - acc: 0.9540 - val_loss: 0.8515 - val_acc: 0.7969
Epoch 15/20
997/998 [============================>.] - ETA: 0s - loss: 0.1224 - acc: 0.9591Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.1224 - acc: 0.9591 - val_loss: 0.8372 - val_acc: 0.8085
Epoch 16/20
997/998 [============================>.] - ETA: 0s - loss: 0.1170 - acc: 0.9610Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 646s 648ms/step - loss: 0.1171 - acc: 0.9610 - val_loss: 0.8128 - val_acc: 0.8089
Epoch 17/20
997/998 [============================>.] - ETA: 0s - loss: 0.1098 - acc: 0.9631Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 648s 650ms/step - loss: 0.1098 - acc: 0.9631 - val_loss: 0.8386 - val_acc: 0.8113
Epoch 18/20
997/998 [============================>.] - ETA: 0s - loss: 0.1087 - acc: 0.9631Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.1087 - acc: 0.9631 - val_loss: 0.9303 - val_acc: 0.8045
Epoch 19/20
997/998 [============================>.] - ETA: 0s - loss: 0.1042 - acc: 0.9644Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 647s 649ms/step - loss: 0.1042 - acc: 0.9644 - val_loss: 0.8609 - val_acc: 0.8217
Epoch 20/20
997/998 [============================>.] - ETA: 0s - loss: 0.0980 - acc: 0.9667Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/imagenet/results/100_1/100.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0980 - acc: 0.9667 - val_loss: 0.8578 - val_acc: 0.8105
Training resnet90 for imagenet
2017-11-26 01:57:16.819183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
[3.6410918663709593, 0.31610576923076922]
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 64)   4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 64)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   18464       activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 64)   16448       activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 64)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   18464       activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
ee2b (Activation)               (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 64)   16448       ee2b[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 64)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   18464       activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 ee2b[0][0]
__________________________________________________________________________________________________
ee2c (Activation)               (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 128)  32896       ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 28, 28, 128)  0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_9[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_10[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_11[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 128)  0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_12[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_11[0][0]
__________________________________________________________________________________________________
ee3b (Activation)               (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 128)  65664       ee3b[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 128)  0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_14[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_15[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 ee3b[0][0]
__________________________________________________________________________________________________
ee3c (Activation)               (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 128)  65664       ee3c[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 128)  0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_16[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_17[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 ee3c[0][0]
__________________________________________________________________________________________________
ee3d (Activation)               (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 256)  131328      ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 14, 14, 256)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_18[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_19[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 1024) 525312      ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 1024) 4096        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_20[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 14, 14, 256)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_21[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_22[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           bn4b_branch2c[0][0]
                                                                 activation_20[0][0]
__________________________________________________________________________________________________
ee4b (Activation)               (None, 14, 14, 1024) 0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 256)  262400      ee4b[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 256)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_23[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_24[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           bn4c_branch2c[0][0]
                                                                 ee4b[0][0]
__________________________________________________________________________________________________
ee4c (Activation)               (None, 14, 14, 1024) 0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 256)  262400      ee4c[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 256)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_25[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_26[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           bn4d_branch2c[0][0]
                                                                 ee4c[0][0]
__________________________________________________________________________________________________
ee4d (Activation)               (None, 14, 14, 1024) 0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 256)  262400      ee4d[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 256)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_27[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_28[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 1024) 0           bn4e_branch2c[0][0]
                                                                 ee4d[0][0]
__________________________________________________________________________________________________
ee4e (Activation)               (None, 14, 14, 1024) 0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 256)  262400      ee4e[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 256)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_29[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_30[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 1024) 0           bn4f_branch2c[0][0]
                                                                 ee4e[0][0]
__________________________________________________________________________________________________
ee4f (Activation)               (None, 14, 14, 1024) 0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 512)    524800      ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 512)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 256)    1179904     activation_31[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_32[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 2048)   2099200     ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 2048)   8192        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_33[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 512)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 256)    1179904     activation_34[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_35[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           bn5b_branch2c[0][0]
                                                                 activation_33[0][0]
__________________________________________________________________________________________________
ee5b (Activation)               (None, 7, 7, 2048)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     ee5b[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 512)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 256)    1179904     activation_36[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_37[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           bn5c_branch2c[0][0]
                                                                 ee5b[0][0]
__________________________________________________________________________________________________
ee5c (Activation)               (None, 7, 7, 2048)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 2048)   0           ee5c[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 50)           102450      flatten_1[0][0]
==================================================================================================
Total params: 15,507,154
Trainable params: 15,457,810
Non-trainable params: 49,344
__________________________________________________________________________________________________
Epoch 1/20
997/998 [============================>.] - ETA: 0s - loss: 0.2342 - acc: 0.9251Epoch 00001: val_acc improved from -inf to 0.78766, saving model to ./resnet/imagenet/results/90_1/90_best.h5
Epoch 00001: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 692s 694ms/step - loss: 0.2340 - acc: 0.9252 - val_loss: 0.8295 - val_acc: 0.7877
Epoch 2/20
997/998 [============================>.] - ETA: 0s - loss: 0.1564 - acc: 0.9474Epoch 00002: val_acc improved from 0.78766 to 0.79607, saving model to ./resnet/imagenet/results/90_1/90_best.h5
Epoch 00002: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.1566 - acc: 0.9473 - val_loss: 0.9210 - val_acc: 0.7961
Epoch 3/20
997/998 [============================>.] - ETA: 0s - loss: 0.1397 - acc: 0.9534Epoch 00003: val_acc improved from 0.79607 to 0.80409, saving model to ./resnet/imagenet/results/90_1/90_best.h5
Epoch 00003: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.1397 - acc: 0.9534 - val_loss: 0.8613 - val_acc: 0.8041
Epoch 4/20
997/998 [============================>.] - ETA: 0s - loss: 0.1262 - acc: 0.9573Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.1262 - acc: 0.9573 - val_loss: 0.9267 - val_acc: 0.7921
Epoch 5/20
997/998 [============================>.] - ETA: 0s - loss: 0.1227 - acc: 0.9592Epoch 00005: val_acc did not improve
Epoch 00005: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.1227 - acc: 0.9592 - val_loss: 0.9364 - val_acc: 0.7985
Epoch 6/20
997/998 [============================>.] - ETA: 0s - loss: 0.1146 - acc: 0.9616Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 653s 654ms/step - loss: 0.1146 - acc: 0.9617 - val_loss: 1.0043 - val_acc: 0.7981
Epoch 7/20
997/998 [============================>.] - ETA: 0s - loss: 0.1092 - acc: 0.9631Epoch 00007: val_acc did not improve
Epoch 00007: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 653s 655ms/step - loss: 0.1092 - acc: 0.9631 - val_loss: 0.8953 - val_acc: 0.7957
Epoch 8/20
997/998 [============================>.] - ETA: 0s - loss: 0.1056 - acc: 0.9646Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 653s 654ms/step - loss: 0.1056 - acc: 0.9646 - val_loss: 0.9606 - val_acc: 0.7873
Epoch 9/20
997/998 [============================>.] - ETA: 0s - loss: 0.0966 - acc: 0.9676Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 652s 654ms/step - loss: 0.0966 - acc: 0.9675 - val_loss: 0.9733 - val_acc: 0.7997
Epoch 10/20
997/998 [============================>.] - ETA: 0s - loss: 0.0910 - acc: 0.9698Epoch 00010: val_acc did not improve
Epoch 00010: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.0910 - acc: 0.9698 - val_loss: 0.9880 - val_acc: 0.7961
Epoch 11/20
997/998 [============================>.] - ETA: 0s - loss: 0.0937 - acc: 0.9679Epoch 00011: val_acc improved from 0.80409 to 0.81250, saving model to ./resnet/imagenet/results/90_1/90_best.h5
Epoch 00011: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 652s 653ms/step - loss: 0.0937 - acc: 0.9679 - val_loss: 0.9341 - val_acc: 0.8125
Epoch 12/20
997/998 [============================>.] - ETA: 0s - loss: 0.0897 - acc: 0.9695Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.0897 - acc: 0.9695 - val_loss: 1.0056 - val_acc: 0.8045
Epoch 13/20
997/998 [============================>.] - ETA: 0s - loss: 0.0863 - acc: 0.9709Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0862 - acc: 0.9709 - val_loss: 0.9737 - val_acc: 0.7965
Epoch 14/20
997/998 [============================>.] - ETA: 0s - loss: 0.0803 - acc: 0.9728Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 651s 653ms/step - loss: 0.0803 - acc: 0.9728 - val_loss: 0.9343 - val_acc: 0.8089
Epoch 15/20
997/998 [============================>.] - ETA: 0s - loss: 0.0872 - acc: 0.9702Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 654s 655ms/step - loss: 0.0872 - acc: 0.9702 - val_loss: 0.9585 - val_acc: 0.8009
Epoch 16/20
997/998 [============================>.] - ETA: 0s - loss: 0.0763 - acc: 0.9742Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.0763 - acc: 0.9742 - val_loss: 0.9684 - val_acc: 0.8033
Epoch 17/20
997/998 [============================>.] - ETA: 0s - loss: 0.0761 - acc: 0.9748Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.0761 - acc: 0.9748 - val_loss: 1.0350 - val_acc: 0.7949
Epoch 18/20
997/998 [============================>.] - ETA: 0s - loss: 0.0786 - acc: 0.9735Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.0785 - acc: 0.9735 - val_loss: 1.0388 - val_acc: 0.7965
Epoch 19/20
997/998 [============================>.] - ETA: 0s - loss: 0.0741 - acc: 0.9751Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0741 - acc: 0.9752 - val_loss: 1.0020 - val_acc: 0.8037
Epoch 20/20
997/998 [============================>.] - ETA: 0s - loss: 0.0678 - acc: 0.9774Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/imagenet/results/90_1/90.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0678 - acc: 0.9774 - val_loss: 1.0657 - val_acc: 0.8037
Training resnet80 for imagenet
2017-11-26 05:36:51.804995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
[4.5402308305104571, 0.18549679487179488]
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
ee2b (Activation)               (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   8224        ee2b[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 ee2b[0][0]
__________________________________________________________________________________________________
ee2c (Activation)               (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 64)   16448       ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 28, 28, 64)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_9[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_10[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_11[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_12[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_11[0][0]
__________________________________________________________________________________________________
ee3b (Activation)               (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 64)   32832       ee3b[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_14[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_15[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 ee3b[0][0]
__________________________________________________________________________________________________
ee3c (Activation)               (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 64)   32832       ee3c[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_16[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_17[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 ee3c[0][0]
__________________________________________________________________________________________________
ee3d (Activation)               (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_18[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_19[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 1024) 525312      ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 1024) 4096        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_20[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_21[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_22[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           bn4b_branch2c[0][0]
                                                                 activation_20[0][0]
__________________________________________________________________________________________________
ee4b (Activation)               (None, 14, 14, 1024) 0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 128)  131200      ee4b[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_23[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_24[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           bn4c_branch2c[0][0]
                                                                 ee4b[0][0]
__________________________________________________________________________________________________
ee4c (Activation)               (None, 14, 14, 1024) 0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 128)  131200      ee4c[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_25[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_26[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           bn4d_branch2c[0][0]
                                                                 ee4c[0][0]
__________________________________________________________________________________________________
ee4d (Activation)               (None, 14, 14, 1024) 0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 128)  131200      ee4d[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_27[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_28[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 1024) 0           bn4e_branch2c[0][0]
                                                                 ee4d[0][0]
__________________________________________________________________________________________________
ee4e (Activation)               (None, 14, 14, 1024) 0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 128)  131200      ee4e[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_29[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_30[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 1024) 0           bn4f_branch2c[0][0]
                                                                 ee4e[0][0]
__________________________________________________________________________________________________
ee4f (Activation)               (None, 14, 14, 1024) 0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 256)    262400      ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_31[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_32[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 2048)   2099200     ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 2048)   8192        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 256)    524544      activation_33[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_34[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_35[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           bn5b_branch2c[0][0]
                                                                 activation_33[0][0]
__________________________________________________________________________________________________
ee5b (Activation)               (None, 7, 7, 2048)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 256)    524544      ee5b[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_36[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_37[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           bn5c_branch2c[0][0]
                                                                 ee5b[0][0]
__________________________________________________________________________________________________
ee5c (Activation)               (None, 7, 7, 2048)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 2048)   0           ee5c[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 50)           102450      flatten_1[0][0]
==================================================================================================
Total params: 10,503,666
Trainable params: 10,458,098
Non-trainable params: 45,568
__________________________________________________________________________________________________
Epoch 1/30
997/998 [============================>.] - ETA: 0s - loss: 0.2905 - acc: 0.9083Epoch 00001: val_acc improved from -inf to 0.77684, saving model to ./resnet/imagenet/results/80_1/80_best.h5
Epoch 00001: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 692s 693ms/step - loss: 0.2905 - acc: 0.9083 - val_loss: 0.9078 - val_acc: 0.7768
Epoch 2/30
997/998 [============================>.] - ETA: 0s - loss: 0.1570 - acc: 0.9475Epoch 00002: val_acc improved from 0.77684 to 0.80048, saving model to ./resnet/imagenet/results/80_1/80_best.h5
Epoch 00002: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 645s 646ms/step - loss: 0.1570 - acc: 0.9475 - val_loss: 0.8513 - val_acc: 0.8005
Epoch 3/30
997/998 [============================>.] - ETA: 0s - loss: 0.1328 - acc: 0.9572Epoch 00003: val_acc did not improve
Epoch 00003: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 653s 654ms/step - loss: 0.1328 - acc: 0.9572 - val_loss: 0.9090 - val_acc: 0.8001
Epoch 4/30
997/998 [============================>.] - ETA: 0s - loss: 0.1234 - acc: 0.9584Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.1233 - acc: 0.9584 - val_loss: 0.9794 - val_acc: 0.7933
Epoch 5/30
997/998 [============================>.] - ETA: 0s - loss: 0.1095 - acc: 0.9635Epoch 00005: val_acc improved from 0.80048 to 0.80168, saving model to ./resnet/imagenet/results/80_1/80_best.h5
Epoch 00005: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 649s 651ms/step - loss: 0.1095 - acc: 0.9635 - val_loss: 0.9326 - val_acc: 0.8017
Epoch 6/30
997/998 [============================>.] - ETA: 0s - loss: 0.1091 - acc: 0.9631Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 655s 656ms/step - loss: 0.1090 - acc: 0.9631 - val_loss: 0.9757 - val_acc: 0.7961
Epoch 7/30
997/998 [============================>.] - ETA: 0s - loss: 0.0969 - acc: 0.9676Epoch 00007: val_acc did not improve
Epoch 00007: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 651s 653ms/step - loss: 0.0969 - acc: 0.9676 - val_loss: 0.9984 - val_acc: 0.7833
Epoch 8/30
997/998 [============================>.] - ETA: 0s - loss: 0.0974 - acc: 0.9677Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0974 - acc: 0.9678 - val_loss: 1.0047 - val_acc: 0.7997
Epoch 9/30
997/998 [============================>.] - ETA: 0s - loss: 0.0890 - acc: 0.9701Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.0891 - acc: 0.9701 - val_loss: 1.0553 - val_acc: 0.7949
Epoch 10/30
997/998 [============================>.] - ETA: 0s - loss: 0.0894 - acc: 0.9701Epoch 00010: val_acc did not improve
Epoch 00010: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 653s 654ms/step - loss: 0.0894 - acc: 0.9701 - val_loss: 1.0874 - val_acc: 0.7897
Epoch 11/30
997/998 [============================>.] - ETA: 0s - loss: 0.0856 - acc: 0.9708Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0855 - acc: 0.9708 - val_loss: 1.0322 - val_acc: 0.7989
Epoch 12/30
997/998 [============================>.] - ETA: 0s - loss: 0.0863 - acc: 0.9709Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 652s 654ms/step - loss: 0.0862 - acc: 0.9709 - val_loss: 1.1078 - val_acc: 0.7776
Epoch 13/30
997/998 [============================>.] - ETA: 0s - loss: 0.0805 - acc: 0.9725Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 652s 653ms/step - loss: 0.0806 - acc: 0.9725 - val_loss: 1.0695 - val_acc: 0.7808
Epoch 14/30
997/998 [============================>.] - ETA: 0s - loss: 0.0764 - acc: 0.9740Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 647s 649ms/step - loss: 0.0764 - acc: 0.9740 - val_loss: 1.0699 - val_acc: 0.7829
Epoch 15/30
997/998 [============================>.] - ETA: 0s - loss: 0.0779 - acc: 0.9741Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 652s 654ms/step - loss: 0.0779 - acc: 0.9741 - val_loss: 1.1035 - val_acc: 0.7877
Epoch 16/30
997/998 [============================>.] - ETA: 0s - loss: 0.0751 - acc: 0.9742Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.0750 - acc: 0.9743 - val_loss: 1.0683 - val_acc: 0.8013
Epoch 17/30
997/998 [============================>.] - ETA: 0s - loss: 0.0739 - acc: 0.9745Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.0739 - acc: 0.9745 - val_loss: 1.0305 - val_acc: 0.7897
Epoch 18/30
997/998 [============================>.] - ETA: 0s - loss: 0.0690 - acc: 0.9762Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.0689 - acc: 0.9762 - val_loss: 1.0683 - val_acc: 0.7873
Epoch 19/30
997/998 [============================>.] - ETA: 0s - loss: 0.0715 - acc: 0.9758Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 645s 647ms/step - loss: 0.0714 - acc: 0.9758 - val_loss: 1.1576 - val_acc: 0.7821
Epoch 20/30
997/998 [============================>.] - ETA: 0s - loss: 0.0689 - acc: 0.9766Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.0688 - acc: 0.9766 - val_loss: 1.1170 - val_acc: 0.7933
Epoch 21/30
997/998 [============================>.] - ETA: 0s - loss: 0.0633 - acc: 0.9786Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 651s 653ms/step - loss: 0.0633 - acc: 0.9786 - val_loss: 1.1472 - val_acc: 0.7905
Epoch 22/30
997/998 [============================>.] - ETA: 0s - loss: 0.0659 - acc: 0.9775Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 646s 648ms/step - loss: 0.0658 - acc: 0.9776 - val_loss: 1.0937 - val_acc: 0.7969
Epoch 23/30
997/998 [============================>.] - ETA: 0s - loss: 0.0640 - acc: 0.9786Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.0640 - acc: 0.9786 - val_loss: 1.0911 - val_acc: 0.7889
Epoch 24/30
997/998 [============================>.] - ETA: 0s - loss: 0.0574 - acc: 0.9799Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0574 - acc: 0.9799 - val_loss: 1.0977 - val_acc: 0.7881
Epoch 25/30
997/998 [============================>.] - ETA: 0s - loss: 0.0622 - acc: 0.9789Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 652s 653ms/step - loss: 0.0621 - acc: 0.9789 - val_loss: 1.1158 - val_acc: 0.7776
Epoch 26/30
997/998 [============================>.] - ETA: 0s - loss: 0.0602 - acc: 0.9790Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.0602 - acc: 0.9790 - val_loss: 1.2171 - val_acc: 0.7873
Epoch 27/30
997/998 [============================>.] - ETA: 0s - loss: 0.0594 - acc: 0.9789Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0594 - acc: 0.9790 - val_loss: 1.0799 - val_acc: 0.7833
Epoch 28/30
997/998 [============================>.] - ETA: 0s - loss: 0.0586 - acc: 0.9795Epoch 00028: val_acc improved from 0.80168 to 0.80529, saving model to ./resnet/imagenet/results/80_1/80_best.h5
Epoch 00028: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 649s 651ms/step - loss: 0.0586 - acc: 0.9796 - val_loss: 1.0659 - val_acc: 0.8053
Epoch 29/30
997/998 [============================>.] - ETA: 0s - loss: 0.0579 - acc: 0.9802Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.0578 - acc: 0.9802 - val_loss: 1.1355 - val_acc: 0.7873
Epoch 30/30
997/998 [============================>.] - ETA: 0s - loss: 0.0548 - acc: 0.9810Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/imagenet/results/80_1/80.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.0548 - acc: 0.9810 - val_loss: 1.1495 - val_acc: 0.7873
Training resnet70 for imagenet
2017-11-26 11:04:39.550236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
[4.0540154224787006, 0.022435897435897436]
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
ee2b (Activation)               (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   8224        ee2b[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 ee2b[0][0]
__________________________________________________________________________________________________
ee2c (Activation)               (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 64)   16448       ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 28, 28, 64)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_9[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_10[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_11[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_12[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_11[0][0]
__________________________________________________________________________________________________
ee3b (Activation)               (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 64)   32832       ee3b[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_14[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_15[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 ee3b[0][0]
__________________________________________________________________________________________________
ee3c (Activation)               (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 64)   32832       ee3c[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_16[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_17[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 ee3c[0][0]
__________________________________________________________________________________________________
ee3d (Activation)               (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_18[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_19[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 512)  262656      ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 512)  2048        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 512)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 14, 14, 512)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_20[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_21[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_22[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 512)  0           bn4b_branch2c[0][0]
                                                                 activation_20[0][0]
__________________________________________________________________________________________________
ee4b (Activation)               (None, 14, 14, 512)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee4b[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_23[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_24[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 512)  0           bn4c_branch2c[0][0]
                                                                 ee4b[0][0]
__________________________________________________________________________________________________
ee4c (Activation)               (None, 14, 14, 512)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee4c[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_25[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_26[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 512)  0           bn4d_branch2c[0][0]
                                                                 ee4c[0][0]
__________________________________________________________________________________________________
ee4d (Activation)               (None, 14, 14, 512)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee4d[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_27[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_28[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 512)  0           bn4e_branch2c[0][0]
                                                                 ee4d[0][0]
__________________________________________________________________________________________________
ee4e (Activation)               (None, 14, 14, 512)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee4e[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_29[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_30[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 512)  0           bn4f_branch2c[0][0]
                                                                 ee4e[0][0]
__________________________________________________________________________________________________
ee4f (Activation)               (None, 14, 14, 512)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 256)    131328      ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_31[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 1024)   263168      activation_32[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 1024)   525312      ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 1024)   4096        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 1024)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 1024)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 256)    262400      activation_33[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_34[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 1024)   263168      activation_35[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 1024)   0           bn5b_branch2c[0][0]
                                                                 activation_33[0][0]
__________________________________________________________________________________________________
ee5b (Activation)               (None, 7, 7, 1024)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 256)    262400      ee5b[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_36[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 1024)   263168      activation_37[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 1024)   0           bn5c_branch2c[0][0]
                                                                 ee5b[0][0]
__________________________________________________________________________________________________
ee5c (Activation)               (None, 7, 7, 1024)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 1024)   0           ee5c[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1024)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 50)           51250       flatten_1[0][0]
==================================================================================================
Total params: 6,416,370
Trainable params: 6,386,162
Non-trainable params: 30,208
__________________________________________________________________________________________________
Epoch 1/40
997/998 [============================>.] - ETA: 0s - loss: 2.3160 - acc: 0.3797Epoch 00001: val_acc improved from -inf to 0.55569, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00001: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 684s 686ms/step - loss: 2.3147 - acc: 0.3800 - val_loss: 1.5542 - val_acc: 0.5557
Epoch 2/40
997/998 [============================>.] - ETA: 0s - loss: 1.3881 - acc: 0.6039Epoch 00002: val_acc improved from 0.55569 to 0.63101, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00002: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 643s 644ms/step - loss: 1.3879 - acc: 0.6040 - val_loss: 1.3005 - val_acc: 0.6310
Epoch 3/40
997/998 [============================>.] - ETA: 0s - loss: 1.1062 - acc: 0.6778Epoch 00003: val_acc improved from 0.63101 to 0.68149, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00003: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 651s 652ms/step - loss: 1.1059 - acc: 0.6778 - val_loss: 1.1117 - val_acc: 0.6815
Epoch 4/40
997/998 [============================>.] - ETA: 0s - loss: 0.9512 - acc: 0.7185Epoch 00004: val_acc improved from 0.68149 to 0.68990, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00004: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 646s 648ms/step - loss: 0.9511 - acc: 0.7185 - val_loss: 1.0475 - val_acc: 0.6899
Epoch 5/40
997/998 [============================>.] - ETA: 0s - loss: 0.8407 - acc: 0.7478Epoch 00005: val_acc improved from 0.68990 to 0.71675, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00005: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 653s 654ms/step - loss: 0.8409 - acc: 0.7478 - val_loss: 1.0282 - val_acc: 0.7167
Epoch 6/40
997/998 [============================>.] - ETA: 0s - loss: 0.7553 - acc: 0.7704Epoch 00006: val_acc improved from 0.71675 to 0.73277, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00006: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.7552 - acc: 0.7704 - val_loss: 0.9533 - val_acc: 0.7328
Epoch 7/40
997/998 [============================>.] - ETA: 0s - loss: 0.6819 - acc: 0.7909Epoch 00007: val_acc improved from 0.73277 to 0.74479, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00007: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 652s 654ms/step - loss: 0.6818 - acc: 0.7910 - val_loss: 0.9369 - val_acc: 0.7448
Epoch 8/40
997/998 [============================>.] - ETA: 0s - loss: 0.6216 - acc: 0.8092Epoch 00008: val_acc improved from 0.74479 to 0.75120, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00008: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 651s 653ms/step - loss: 0.6216 - acc: 0.8092 - val_loss: 0.8527 - val_acc: 0.7512
Epoch 9/40
997/998 [============================>.] - ETA: 0s - loss: 0.5659 - acc: 0.8236Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.5657 - acc: 0.8237 - val_loss: 0.9486 - val_acc: 0.7404
Epoch 10/40
997/998 [============================>.] - ETA: 0s - loss: 0.5187 - acc: 0.8367Epoch 00010: val_acc did not improve
Epoch 00010: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.5187 - acc: 0.8367 - val_loss: 0.9340 - val_acc: 0.7496
Epoch 11/40
997/998 [============================>.] - ETA: 0s - loss: 0.4789 - acc: 0.8474Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.4788 - acc: 0.8475 - val_loss: 0.8929 - val_acc: 0.7444
Epoch 12/40
997/998 [============================>.] - ETA: 0s - loss: 0.4488 - acc: 0.8574Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.4486 - acc: 0.8574 - val_loss: 0.9018 - val_acc: 0.7436
Epoch 13/40
997/998 [============================>.] - ETA: 0s - loss: 0.4100 - acc: 0.8684Epoch 00013: val_acc improved from 0.75120 to 0.77043, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00013: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.4100 - acc: 0.8684 - val_loss: 0.8537 - val_acc: 0.7704
Epoch 14/40
997/998 [============================>.] - ETA: 0s - loss: 0.3786 - acc: 0.8779Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 652s 653ms/step - loss: 0.3785 - acc: 0.8779 - val_loss: 0.9262 - val_acc: 0.7620
Epoch 15/40
997/998 [============================>.] - ETA: 0s - loss: 0.3535 - acc: 0.8848Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 644s 645ms/step - loss: 0.3535 - acc: 0.8848 - val_loss: 0.9571 - val_acc: 0.7584
Epoch 16/40
997/998 [============================>.] - ETA: 0s - loss: 0.3257 - acc: 0.8927Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 649s 651ms/step - loss: 0.3257 - acc: 0.8927 - val_loss: 0.9931 - val_acc: 0.7596
Epoch 17/40
997/998 [============================>.] - ETA: 0s - loss: 0.3011 - acc: 0.9014Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.3011 - acc: 0.9014 - val_loss: 1.0304 - val_acc: 0.7448
Epoch 18/40
997/998 [============================>.] - ETA: 0s - loss: 0.2848 - acc: 0.9065Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 653s 654ms/step - loss: 0.2848 - acc: 0.9065 - val_loss: 1.0016 - val_acc: 0.7528
Epoch 19/40
997/998 [============================>.] - ETA: 0s - loss: 0.2603 - acc: 0.9136Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.2602 - acc: 0.9136 - val_loss: 1.0010 - val_acc: 0.7660
Epoch 20/40
997/998 [============================>.] - ETA: 0s - loss: 0.2495 - acc: 0.9173Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.2495 - acc: 0.9173 - val_loss: 0.9375 - val_acc: 0.7508
Epoch 21/40
997/998 [============================>.] - ETA: 0s - loss: 0.2345 - acc: 0.9233Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 652s 653ms/step - loss: 0.2343 - acc: 0.9233 - val_loss: 0.9693 - val_acc: 0.7608
Epoch 22/40
997/998 [============================>.] - ETA: 0s - loss: 0.2198 - acc: 0.9270Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.2198 - acc: 0.9270 - val_loss: 1.0938 - val_acc: 0.7476
Epoch 23/40
997/998 [============================>.] - ETA: 0s - loss: 0.2066 - acc: 0.9311Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.2065 - acc: 0.9311 - val_loss: 1.0798 - val_acc: 0.7612
Epoch 24/40
997/998 [============================>.] - ETA: 0s - loss: 0.1952 - acc: 0.9342Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 652s 653ms/step - loss: 0.1951 - acc: 0.9342 - val_loss: 1.0523 - val_acc: 0.7572
Epoch 25/40
997/998 [============================>.] - ETA: 0s - loss: 0.1883 - acc: 0.9363Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 647s 649ms/step - loss: 0.1882 - acc: 0.9363 - val_loss: 1.0769 - val_acc: 0.7600
Epoch 26/40
997/998 [============================>.] - ETA: 0s - loss: 0.1750 - acc: 0.9409Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1749 - acc: 0.9409 - val_loss: 1.0955 - val_acc: 0.7572
Epoch 27/40
997/998 [============================>.] - ETA: 0s - loss: 0.1668 - acc: 0.9440Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.1669 - acc: 0.9440 - val_loss: 1.1411 - val_acc: 0.7524
Epoch 28/40
997/998 [============================>.] - ETA: 0s - loss: 0.1601 - acc: 0.9455Epoch 00028: val_acc improved from 0.77043 to 0.77083, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00028: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.1601 - acc: 0.9455 - val_loss: 1.1150 - val_acc: 0.7708
Epoch 29/40
997/998 [============================>.] - ETA: 0s - loss: 0.1538 - acc: 0.9489Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.1537 - acc: 0.9489 - val_loss: 1.1979 - val_acc: 0.7436
Epoch 30/40
997/998 [============================>.] - ETA: 0s - loss: 0.1498 - acc: 0.9501Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 648s 650ms/step - loss: 0.1497 - acc: 0.9502 - val_loss: 1.1940 - val_acc: 0.7584
Epoch 31/40
997/998 [============================>.] - ETA: 0s - loss: 0.1496 - acc: 0.9490Epoch 00031: val_acc did not improve
Epoch 00031: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1495 - acc: 0.9490 - val_loss: 1.1799 - val_acc: 0.7408
Epoch 32/40
997/998 [============================>.] - ETA: 0s - loss: 0.1360 - acc: 0.9545Epoch 00032: val_acc improved from 0.77083 to 0.77644, saving model to ./resnet/imagenet/results/70_1/70_best.h5
Epoch 00032: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 645s 646ms/step - loss: 0.1359 - acc: 0.9546 - val_loss: 1.0486 - val_acc: 0.7764
Epoch 33/40
997/998 [============================>.] - ETA: 0s - loss: 0.1303 - acc: 0.9564Epoch 00033: val_acc did not improve
Epoch 00033: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 653s 654ms/step - loss: 0.1304 - acc: 0.9564 - val_loss: 1.1208 - val_acc: 0.7544
Epoch 34/40
997/998 [============================>.] - ETA: 0s - loss: 0.1303 - acc: 0.9563Epoch 00034: val_acc did not improve
Epoch 00034: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.1303 - acc: 0.9563 - val_loss: 1.1459 - val_acc: 0.7620
Epoch 35/40
997/998 [============================>.] - ETA: 0s - loss: 0.1231 - acc: 0.9592Epoch 00035: val_acc did not improve
Epoch 00035: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1230 - acc: 0.9592 - val_loss: 1.2278 - val_acc: 0.7380
Epoch 36/40
997/998 [============================>.] - ETA: 0s - loss: 0.1199 - acc: 0.9593Epoch 00036: val_acc did not improve
Epoch 00036: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 654s 655ms/step - loss: 0.1199 - acc: 0.9592 - val_loss: 1.1919 - val_acc: 0.7600
Epoch 37/40
997/998 [============================>.] - ETA: 0s - loss: 0.1152 - acc: 0.9622Epoch 00037: val_acc did not improve
Epoch 00037: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 648s 650ms/step - loss: 0.1152 - acc: 0.9622 - val_loss: 1.2115 - val_acc: 0.7612
Epoch 38/40
997/998 [============================>.] - ETA: 0s - loss: 0.1152 - acc: 0.9599Epoch 00038: val_acc did not improve
Epoch 00038: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 644s 645ms/step - loss: 0.1153 - acc: 0.9599 - val_loss: 1.1783 - val_acc: 0.7604
Epoch 39/40
997/998 [============================>.] - ETA: 0s - loss: 0.1149 - acc: 0.9622Epoch 00039: val_acc did not improve
Epoch 00039: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 654s 655ms/step - loss: 0.1148 - acc: 0.9622 - val_loss: 1.2726 - val_acc: 0.7420
Epoch 40/40
997/998 [============================>.] - ETA: 0s - loss: 0.1063 - acc: 0.9640Epoch 00040: val_acc did not improve
Epoch 00040: saving model to ./resnet/imagenet/results/70_1/70.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.1063 - acc: 0.9640 - val_loss: 1.1790 - val_acc: 0.7648
Training resnet60 for imagenet
2017-11-26 18:20:04.221624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
[12.365144411722818, 0.055288461538461536]
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
ee2b (Activation)               (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   8224        ee2b[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 ee2b[0][0]
__________________________________________________________________________________________________
ee2c (Activation)               (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 64)   16448       ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 28, 28, 64)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 32)   18464       activation_9[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_10[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_11[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 32)   18464       activation_12[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_11[0][0]
__________________________________________________________________________________________________
ee3b (Activation)               (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 64)   32832       ee3b[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 32)   18464       activation_14[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_15[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 ee3b[0][0]
__________________________________________________________________________________________________
ee3c (Activation)               (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 64)   32832       ee3c[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 32)   18464       activation_16[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_17[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 ee3c[0][0]
__________________________________________________________________________________________________
ee3d (Activation)               (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_18[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_19[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 512)  262656      ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 512)  2048        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 512)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 14, 14, 512)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_20[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_21[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_22[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 512)  0           bn4b_branch2c[0][0]
                                                                 activation_20[0][0]
__________________________________________________________________________________________________
ee4b (Activation)               (None, 14, 14, 512)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee4b[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_23[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_24[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 512)  0           bn4c_branch2c[0][0]
                                                                 ee4b[0][0]
__________________________________________________________________________________________________
ee4c (Activation)               (None, 14, 14, 512)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee4c[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_25[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_26[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 512)  0           bn4d_branch2c[0][0]
                                                                 ee4c[0][0]
__________________________________________________________________________________________________
ee4d (Activation)               (None, 14, 14, 512)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee4d[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_27[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_28[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 512)  0           bn4e_branch2c[0][0]
                                                                 ee4d[0][0]
__________________________________________________________________________________________________
ee4e (Activation)               (None, 14, 14, 512)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 128)  65664       ee4e[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_29[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_30[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 512)  0           bn4f_branch2c[0][0]
                                                                 ee4e[0][0]
__________________________________________________________________________________________________
ee4f (Activation)               (None, 14, 14, 512)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 256)    131328      ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 128)    295040      activation_31[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_32[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 1024)   525312      ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 1024)   4096        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 1024)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 1024)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 256)    262400      activation_33[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 128)    295040      activation_34[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_35[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 1024)   0           bn5b_branch2c[0][0]
                                                                 activation_33[0][0]
__________________________________________________________________________________________________
ee5b (Activation)               (None, 7, 7, 1024)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 256)    262400      ee5b[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 128)    295040      activation_36[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_37[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 1024)   0           bn5c_branch2c[0][0]
                                                                 ee5b[0][0]
__________________________________________________________________________________________________
ee5c (Activation)               (None, 7, 7, 1024)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 1024)   0           ee5c[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1024)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 50)           51250       flatten_1[0][0]
==================================================================================================
Total params: 4,355,698
Trainable params: 4,327,282
Non-trainable params: 28,416
__________________________________________________________________________________________________
Epoch 1/40
997/998 [============================>.] - ETA: 0s - loss: 0.6143 - acc: 0.8104Epoch 00001: val_acc improved from -inf to 0.72516, saving model to ./resnet/imagenet/results/60_1/60_best.h5
Epoch 00001: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 692s 693ms/step - loss: 0.6140 - acc: 0.8105 - val_loss: 1.1300 - val_acc: 0.7252
Epoch 2/40
997/998 [============================>.] - ETA: 0s - loss: 0.3900 - acc: 0.8745Epoch 00002: val_acc improved from 0.72516 to 0.72596, saving model to ./resnet/imagenet/results/60_1/60_best.h5
Epoch 00002: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.3899 - acc: 0.8745 - val_loss: 1.1874 - val_acc: 0.7260
Epoch 3/40
997/998 [============================>.] - ETA: 0s - loss: 0.3207 - acc: 0.8948Epoch 00003: val_acc did not improve
Epoch 00003: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.3207 - acc: 0.8949 - val_loss: 1.1059 - val_acc: 0.7248
Epoch 4/40
997/998 [============================>.] - ETA: 0s - loss: 0.2787 - acc: 0.9083Epoch 00004: val_acc improved from 0.72596 to 0.73037, saving model to ./resnet/imagenet/results/60_1/60_best.h5
Epoch 00004: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.2786 - acc: 0.9083 - val_loss: 1.1832 - val_acc: 0.7304
Epoch 5/40
997/998 [============================>.] - ETA: 0s - loss: 0.2521 - acc: 0.9159Epoch 00005: val_acc improved from 0.73037 to 0.73958, saving model to ./resnet/imagenet/results/60_1/60_best.h5
Epoch 00005: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.2520 - acc: 0.9159 - val_loss: 1.1706 - val_acc: 0.7396
Epoch 6/40
997/998 [============================>.] - ETA: 0s - loss: 0.2287 - acc: 0.9245Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.2286 - acc: 0.9245 - val_loss: 1.2499 - val_acc: 0.7392
Epoch 7/40
997/998 [============================>.] - ETA: 0s - loss: 0.2164 - acc: 0.9275Epoch 00007: val_acc improved from 0.73958 to 0.75200, saving model to ./resnet/imagenet/results/60_1/60_best.h5
Epoch 00007: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.2165 - acc: 0.9275 - val_loss: 1.1301 - val_acc: 0.7520
Epoch 8/40
997/998 [============================>.] - ETA: 0s - loss: 0.1967 - acc: 0.9345Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 645s 646ms/step - loss: 0.1968 - acc: 0.9344 - val_loss: 1.2913 - val_acc: 0.7228
Epoch 9/40
997/998 [============================>.] - ETA: 0s - loss: 0.1916 - acc: 0.9364Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 647s 649ms/step - loss: 0.1918 - acc: 0.9364 - val_loss: 1.2760 - val_acc: 0.7444
Epoch 10/40
997/998 [============================>.] - ETA: 0s - loss: 0.1805 - acc: 0.9397Epoch 00010: val_acc did not improve
Epoch 00010: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.1806 - acc: 0.9396 - val_loss: 1.1970 - val_acc: 0.7448
Epoch 11/40
997/998 [============================>.] - ETA: 0s - loss: 0.1650 - acc: 0.9451Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 647s 649ms/step - loss: 0.1649 - acc: 0.9452 - val_loss: 1.3032 - val_acc: 0.7312
Epoch 12/40
997/998 [============================>.] - ETA: 0s - loss: 0.1666 - acc: 0.9446Epoch 00012: val_acc improved from 0.75200 to 0.75481, saving model to ./resnet/imagenet/results/60_1/60_best.h5
Epoch 00012: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.1665 - acc: 0.9446 - val_loss: 1.2072 - val_acc: 0.7548
Epoch 13/40
997/998 [============================>.] - ETA: 0s - loss: 0.1596 - acc: 0.9479Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 649s 651ms/step - loss: 0.1596 - acc: 0.9479 - val_loss: 1.2405 - val_acc: 0.7368
Epoch 14/40
997/998 [============================>.] - ETA: 0s - loss: 0.1473 - acc: 0.9506Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 646s 648ms/step - loss: 0.1473 - acc: 0.9506 - val_loss: 1.3215 - val_acc: 0.7368
Epoch 15/40
997/998 [============================>.] - ETA: 0s - loss: 0.1408 - acc: 0.9530Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.1408 - acc: 0.9531 - val_loss: 1.2972 - val_acc: 0.7436
Epoch 16/40
997/998 [============================>.] - ETA: 0s - loss: 0.1375 - acc: 0.9538Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.1375 - acc: 0.9538 - val_loss: 1.2914 - val_acc: 0.7384
Epoch 17/40
997/998 [============================>.] - ETA: 0s - loss: 0.1351 - acc: 0.9545Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 644s 645ms/step - loss: 0.1351 - acc: 0.9545 - val_loss: 1.3185 - val_acc: 0.7492
Epoch 18/40
997/998 [============================>.] - ETA: 0s - loss: 0.1301 - acc: 0.9568Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.1301 - acc: 0.9568 - val_loss: 1.3462 - val_acc: 0.7448
Epoch 19/40
997/998 [============================>.] - ETA: 0s - loss: 0.1233 - acc: 0.9582Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1233 - acc: 0.9582 - val_loss: 1.3780 - val_acc: 0.7300
Epoch 20/40
997/998 [============================>.] - ETA: 0s - loss: 0.1243 - acc: 0.9575Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.1242 - acc: 0.9576 - val_loss: 1.2949 - val_acc: 0.7444
Epoch 21/40
997/998 [============================>.] - ETA: 0s - loss: 0.1211 - acc: 0.9598Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 652s 653ms/step - loss: 0.1211 - acc: 0.9598 - val_loss: 1.2989 - val_acc: 0.7448
Epoch 22/40
997/998 [============================>.] - ETA: 0s - loss: 0.1111 - acc: 0.9628Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.1111 - acc: 0.9628 - val_loss: 1.2664 - val_acc: 0.7548
Epoch 23/40
997/998 [============================>.] - ETA: 0s - loss: 0.1132 - acc: 0.9614Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.1132 - acc: 0.9614 - val_loss: 1.3828 - val_acc: 0.7312
Epoch 24/40
997/998 [============================>.] - ETA: 0s - loss: 0.1121 - acc: 0.9622Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.1120 - acc: 0.9622 - val_loss: 1.3226 - val_acc: 0.7536
Epoch 25/40
997/998 [============================>.] - ETA: 0s - loss: 0.1066 - acc: 0.9640Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.1066 - acc: 0.9640 - val_loss: 1.3829 - val_acc: 0.7368
Epoch 26/40
997/998 [============================>.] - ETA: 0s - loss: 0.1014 - acc: 0.9655Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 649s 651ms/step - loss: 0.1014 - acc: 0.9655 - val_loss: 1.3572 - val_acc: 0.7444
Epoch 27/40
997/998 [============================>.] - ETA: 0s - loss: 0.1090 - acc: 0.9629Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1089 - acc: 0.9629 - val_loss: 1.3298 - val_acc: 0.7492
Epoch 28/40
997/998 [============================>.] - ETA: 0s - loss: 0.0950 - acc: 0.9682Epoch 00028: val_acc did not improve
Epoch 00028: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 646s 648ms/step - loss: 0.0950 - acc: 0.9682 - val_loss: 1.3905 - val_acc: 0.7448
Epoch 29/40
997/998 [============================>.] - ETA: 0s - loss: 0.0979 - acc: 0.9673Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 644s 646ms/step - loss: 0.0979 - acc: 0.9674 - val_loss: 1.3766 - val_acc: 0.7488
Epoch 30/40
997/998 [============================>.] - ETA: 0s - loss: 0.0958 - acc: 0.9681Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.0958 - acc: 0.9680 - val_loss: 1.3500 - val_acc: 0.7464
Epoch 31/40
997/998 [============================>.] - ETA: 0s - loss: 0.0924 - acc: 0.9688Epoch 00031: val_acc improved from 0.75481 to 0.75841, saving model to ./resnet/imagenet/results/60_1/60_best.h5
Epoch 00031: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.0924 - acc: 0.9687 - val_loss: 1.3121 - val_acc: 0.7584
Epoch 32/40
997/998 [============================>.] - ETA: 0s - loss: 0.0945 - acc: 0.9681Epoch 00032: val_acc did not improve
Epoch 00032: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.0945 - acc: 0.9681 - val_loss: 1.3469 - val_acc: 0.7504
Epoch 33/40
997/998 [============================>.] - ETA: 0s - loss: 0.0871 - acc: 0.9704Epoch 00033: val_acc did not improve
Epoch 00033: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.0871 - acc: 0.9704 - val_loss: 1.4833 - val_acc: 0.7464
Epoch 34/40
997/998 [============================>.] - ETA: 0s - loss: 0.0914 - acc: 0.9695Epoch 00034: val_acc did not improve
Epoch 00034: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.0914 - acc: 0.9695 - val_loss: 1.4397 - val_acc: 0.7372
Epoch 35/40
997/998 [============================>.] - ETA: 0s - loss: 0.0889 - acc: 0.9709Epoch 00035: val_acc did not improve
Epoch 00035: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 648s 650ms/step - loss: 0.0889 - acc: 0.9709 - val_loss: 1.4241 - val_acc: 0.7552
Epoch 36/40
997/998 [============================>.] - ETA: 0s - loss: 0.0846 - acc: 0.9716Epoch 00036: val_acc did not improve
Epoch 00036: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.0845 - acc: 0.9716 - val_loss: 1.4243 - val_acc: 0.7512
Epoch 37/40
997/998 [============================>.] - ETA: 0s - loss: 0.0887 - acc: 0.9699Epoch 00037: val_acc did not improve
Epoch 00037: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0888 - acc: 0.9699 - val_loss: 1.3862 - val_acc: 0.7536
Epoch 38/40
997/998 [============================>.] - ETA: 0s - loss: 0.0859 - acc: 0.9715Epoch 00038: val_acc did not improve
Epoch 00038: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 648s 650ms/step - loss: 0.0859 - acc: 0.9715 - val_loss: 1.3867 - val_acc: 0.7396
Epoch 39/40
997/998 [============================>.] - ETA: 0s - loss: 0.0818 - acc: 0.9722Epoch 00039: val_acc did not improve
Epoch 00039: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.0817 - acc: 0.9722 - val_loss: 1.3858 - val_acc: 0.7440
Epoch 40/40
997/998 [============================>.] - ETA: 0s - loss: 0.0833 - acc: 0.9717Epoch 00040: val_acc did not improve
Epoch 00040: saving model to ./resnet/imagenet/results/60_1/60.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.0833 - acc: 0.9717 - val_loss: 1.3857 - val_acc: 0.7532
Training resnet50 for imagenet
2017-11-27 01:34:38.114595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
[4.6552587778140335, 0.11137820512820513]
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
ee2b (Activation)               (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   8224        ee2b[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 ee2b[0][0]
__________________________________________________________________________________________________
ee2c (Activation)               (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 32)   8224        ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 28, 28, 32)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_9[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_10[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 32)   16416       activation_11[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_12[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_11[0][0]
__________________________________________________________________________________________________
ee3b (Activation)               (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 32)   16416       ee3b[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_14[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_15[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 ee3b[0][0]
__________________________________________________________________________________________________
ee3c (Activation)               (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 32)   16416       ee3c[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_16[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_17[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 ee3c[0][0]
__________________________________________________________________________________________________
ee3d (Activation)               (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 64)   32832       ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_18[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_19[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 512)  262656      ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 512)  2048        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 512)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 14, 14, 512)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 64)   32832       activation_20[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_21[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_22[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 512)  0           bn4b_branch2c[0][0]
                                                                 activation_20[0][0]
__________________________________________________________________________________________________
ee4b (Activation)               (None, 14, 14, 512)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 64)   32832       ee4b[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_23[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_24[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 512)  0           bn4c_branch2c[0][0]
                                                                 ee4b[0][0]
__________________________________________________________________________________________________
ee4c (Activation)               (None, 14, 14, 512)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 64)   32832       ee4c[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_25[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_26[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 512)  0           bn4d_branch2c[0][0]
                                                                 ee4c[0][0]
__________________________________________________________________________________________________
ee4d (Activation)               (None, 14, 14, 512)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 64)   32832       ee4d[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_27[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_28[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 512)  0           bn4e_branch2c[0][0]
                                                                 ee4d[0][0]
__________________________________________________________________________________________________
ee4e (Activation)               (None, 14, 14, 512)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 64)   32832       ee4e[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_29[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_30[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 512)  0           bn4f_branch2c[0][0]
                                                                 ee4e[0][0]
__________________________________________________________________________________________________
ee4f (Activation)               (None, 14, 14, 512)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 128)    65664       ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_31[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_32[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 1024)   525312      ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 1024)   4096        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 1024)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 1024)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 128)    131200      activation_33[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_34[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_35[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 1024)   0           bn5b_branch2c[0][0]
                                                                 activation_33[0][0]
__________________________________________________________________________________________________
ee5b (Activation)               (None, 7, 7, 1024)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 128)    131200      ee5b[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_36[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_37[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 1024)   0           bn5c_branch2c[0][0]
                                                                 ee5b[0][0]
__________________________________________________________________________________________________
ee5c (Activation)               (None, 7, 7, 1024)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 1024)   0           ee5c[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1024)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 50)           51250       flatten_1[0][0]
==================================================================================================
Total params: 3,069,170
Trainable params: 3,042,546
Non-trainable params: 26,624
__________________________________________________________________________________________________
Epoch 1/40
997/998 [============================>.] - ETA: 0s - loss: 0.7870 - acc: 0.7712Epoch 00001: val_acc improved from -inf to 0.71875, saving model to ./resnet/imagenet/results/50_1/50_best.h5
Epoch 00001: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 689s 690ms/step - loss: 0.7868 - acc: 0.7712 - val_loss: 1.1364 - val_acc: 0.7188
Epoch 2/40
997/998 [============================>.] - ETA: 0s - loss: 0.4471 - acc: 0.8556Epoch 00002: val_acc did not improve
Epoch 00002: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 643s 644ms/step - loss: 0.4470 - acc: 0.8555 - val_loss: 1.1584 - val_acc: 0.7159
Epoch 3/40
997/998 [============================>.] - ETA: 0s - loss: 0.3559 - acc: 0.8837Epoch 00003: val_acc improved from 0.71875 to 0.74079, saving model to ./resnet/imagenet/results/50_1/50_best.h5
Epoch 00003: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.3558 - acc: 0.8838 - val_loss: 1.1294 - val_acc: 0.7408
Epoch 4/40
997/998 [============================>.] - ETA: 0s - loss: 0.3073 - acc: 0.8995Epoch 00004: val_acc improved from 0.74079 to 0.74599, saving model to ./resnet/imagenet/results/50_1/50_best.h5
Epoch 00004: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.3072 - acc: 0.8995 - val_loss: 1.1552 - val_acc: 0.7460
Epoch 5/40
997/998 [============================>.] - ETA: 0s - loss: 0.2697 - acc: 0.9098Epoch 00005: val_acc did not improve
Epoch 00005: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 650ms/step - loss: 0.2697 - acc: 0.9099 - val_loss: 1.1797 - val_acc: 0.7348
Epoch 6/40
997/998 [============================>.] - ETA: 0s - loss: 0.2500 - acc: 0.9155Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 647s 649ms/step - loss: 0.2498 - acc: 0.9156 - val_loss: 1.2094 - val_acc: 0.7320
Epoch 7/40
997/998 [============================>.] - ETA: 0s - loss: 0.2284 - acc: 0.9236Epoch 00007: val_acc did not improve
Epoch 00007: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 645s 646ms/step - loss: 0.2284 - acc: 0.9236 - val_loss: 1.1709 - val_acc: 0.7376
Epoch 8/40
997/998 [============================>.] - ETA: 0s - loss: 0.2094 - acc: 0.9306Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.2094 - acc: 0.9306 - val_loss: 1.2171 - val_acc: 0.7372
Epoch 9/40
997/998 [============================>.] - ETA: 0s - loss: 0.1925 - acc: 0.9351Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.1926 - acc: 0.9351 - val_loss: 1.2717 - val_acc: 0.7340
Epoch 10/40
997/998 [============================>.] - ETA: 0s - loss: 0.1840 - acc: 0.9382Epoch 00010: val_acc improved from 0.74599 to 0.74639, saving model to ./resnet/imagenet/results/50_1/50_best.h5
Epoch 00010: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.1839 - acc: 0.9382 - val_loss: 1.2285 - val_acc: 0.7464
Epoch 11/40
997/998 [============================>.] - ETA: 0s - loss: 0.1757 - acc: 0.9398Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.1757 - acc: 0.9398 - val_loss: 1.2844 - val_acc: 0.7408
Epoch 12/40
997/998 [============================>.] - ETA: 0s - loss: 0.1652 - acc: 0.9448Epoch 00012: val_acc improved from 0.74639 to 0.74840, saving model to ./resnet/imagenet/results/50_1/50_best.h5
Epoch 00012: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 651s 652ms/step - loss: 0.1652 - acc: 0.9448 - val_loss: 1.2216 - val_acc: 0.7484
Epoch 13/40
997/998 [============================>.] - ETA: 0s - loss: 0.1572 - acc: 0.9475Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1572 - acc: 0.9475 - val_loss: 1.2133 - val_acc: 0.7452
Epoch 14/40
997/998 [============================>.] - ETA: 0s - loss: 0.1506 - acc: 0.9495Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 650s 652ms/step - loss: 0.1506 - acc: 0.9495 - val_loss: 1.3322 - val_acc: 0.7316
Epoch 15/40
997/998 [============================>.] - ETA: 0s - loss: 0.1454 - acc: 0.9507Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.1454 - acc: 0.9507 - val_loss: 1.3003 - val_acc: 0.7480
Epoch 16/40
997/998 [============================>.] - ETA: 0s - loss: 0.1424 - acc: 0.9522Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 646s 648ms/step - loss: 0.1424 - acc: 0.9522 - val_loss: 1.3622 - val_acc: 0.7304
Epoch 17/40
997/998 [============================>.] - ETA: 0s - loss: 0.1334 - acc: 0.9547Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.1334 - acc: 0.9548 - val_loss: 1.3209 - val_acc: 0.7436
Epoch 18/40
997/998 [============================>.] - ETA: 0s - loss: 0.1357 - acc: 0.9546Epoch 00018: val_acc improved from 0.74840 to 0.75921, saving model to ./resnet/imagenet/results/50_1/50_best.h5
Epoch 00018: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 646s 648ms/step - loss: 0.1357 - acc: 0.9546 - val_loss: 1.2800 - val_acc: 0.7592
Epoch 19/40
997/998 [============================>.] - ETA: 0s - loss: 0.1257 - acc: 0.9577Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 645s 647ms/step - loss: 0.1257 - acc: 0.9577 - val_loss: 1.2436 - val_acc: 0.7588
Epoch 20/40
997/998 [============================>.] - ETA: 0s - loss: 0.1214 - acc: 0.9582Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 644s 645ms/step - loss: 0.1213 - acc: 0.9582 - val_loss: 1.3068 - val_acc: 0.7480
Epoch 21/40
997/998 [============================>.] - ETA: 0s - loss: 0.1193 - acc: 0.9590Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.1193 - acc: 0.9591 - val_loss: 1.3635 - val_acc: 0.7280
Epoch 22/40
997/998 [============================>.] - ETA: 0s - loss: 0.1182 - acc: 0.9597Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.1182 - acc: 0.9597 - val_loss: 1.3615 - val_acc: 0.7424
Epoch 23/40
997/998 [============================>.] - ETA: 0s - loss: 0.1144 - acc: 0.9611Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1144 - acc: 0.9611 - val_loss: 1.3768 - val_acc: 0.7456
Epoch 24/40
997/998 [============================>.] - ETA: 0s - loss: 0.1092 - acc: 0.9641Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.1092 - acc: 0.9641 - val_loss: 1.4429 - val_acc: 0.7360
Epoch 25/40
997/998 [============================>.] - ETA: 0s - loss: 0.1084 - acc: 0.9636Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.1084 - acc: 0.9636 - val_loss: 1.3361 - val_acc: 0.7504
Epoch 26/40
997/998 [============================>.] - ETA: 0s - loss: 0.1066 - acc: 0.9637Epoch 00026: val_acc improved from 0.75921 to 0.76522, saving model to ./resnet/imagenet/results/50_1/50_best.h5
Epoch 00026: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.1066 - acc: 0.9637 - val_loss: 1.3526 - val_acc: 0.7652
Epoch 27/40
997/998 [============================>.] - ETA: 0s - loss: 0.1039 - acc: 0.9645Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.1040 - acc: 0.9645 - val_loss: 1.3838 - val_acc: 0.7420
Epoch 28/40
997/998 [============================>.] - ETA: 0s - loss: 0.1016 - acc: 0.9652Epoch 00028: val_acc did not improve
Epoch 00028: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 644s 645ms/step - loss: 0.1015 - acc: 0.9653 - val_loss: 1.3176 - val_acc: 0.7428
Epoch 29/40
997/998 [============================>.] - ETA: 0s - loss: 0.1017 - acc: 0.9647Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.1016 - acc: 0.9648 - val_loss: 1.4813 - val_acc: 0.7376
Epoch 30/40
997/998 [============================>.] - ETA: 0s - loss: 0.0977 - acc: 0.9665Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 645s 647ms/step - loss: 0.0976 - acc: 0.9665 - val_loss: 1.3440 - val_acc: 0.7432
Epoch 31/40
997/998 [============================>.] - ETA: 0s - loss: 0.0959 - acc: 0.9674Epoch 00031: val_acc did not improve
Epoch 00031: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.0959 - acc: 0.9674 - val_loss: 1.3101 - val_acc: 0.7592
Epoch 32/40
997/998 [============================>.] - ETA: 0s - loss: 0.0963 - acc: 0.9676Epoch 00032: val_acc did not improve
Epoch 00032: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.0962 - acc: 0.9676 - val_loss: 1.3855 - val_acc: 0.7328
Epoch 33/40
997/998 [============================>.] - ETA: 0s - loss: 0.0892 - acc: 0.9705Epoch 00033: val_acc did not improve
Epoch 00033: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.0892 - acc: 0.9705 - val_loss: 1.3802 - val_acc: 0.7632
Epoch 34/40
997/998 [============================>.] - ETA: 0s - loss: 0.0887 - acc: 0.9703Epoch 00034: val_acc did not improve
Epoch 00034: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.0886 - acc: 0.9703 - val_loss: 1.4531 - val_acc: 0.7316
Epoch 35/40
997/998 [============================>.] - ETA: 0s - loss: 0.0877 - acc: 0.9711Epoch 00035: val_acc did not improve
Epoch 00035: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.0877 - acc: 0.9711 - val_loss: 1.3693 - val_acc: 0.7368
Epoch 36/40
997/998 [============================>.] - ETA: 0s - loss: 0.0873 - acc: 0.9707Epoch 00036: val_acc did not improve
Epoch 00036: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.0874 - acc: 0.9707 - val_loss: 1.5422 - val_acc: 0.7304
Epoch 37/40
997/998 [============================>.] - ETA: 0s - loss: 0.0836 - acc: 0.9718Epoch 00037: val_acc did not improve
Epoch 00037: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 645s 646ms/step - loss: 0.0835 - acc: 0.9718 - val_loss: 1.4814 - val_acc: 0.7328
Epoch 38/40
997/998 [============================>.] - ETA: 0s - loss: 0.0830 - acc: 0.9718Epoch 00038: val_acc did not improve
Epoch 00038: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.0829 - acc: 0.9718 - val_loss: 1.4793 - val_acc: 0.7380
Epoch 39/40
997/998 [============================>.] - ETA: 0s - loss: 0.0880 - acc: 0.9702Epoch 00039: val_acc did not improve
Epoch 00039: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.0879 - acc: 0.9702 - val_loss: 1.4930 - val_acc: 0.7408
Epoch 40/40
997/998 [============================>.] - ETA: 0s - loss: 0.0820 - acc: 0.9719Epoch 00040: val_acc did not improve
Epoch 00040: saving model to ./resnet/imagenet/results/50_1/50.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.0820 - acc: 0.9719 - val_loss: 1.6140 - val_acc: 0.7280
Training resnet40 for imagenet
2017-11-27 08:49:08.734370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
[5.7070154410142164, 0.017628205128205128]
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 128)  4224        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 128)  8320        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 128)  512         res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 128)  512         res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 128)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 128)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   4128        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 128)  4224        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 128)  512         res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 128)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
ee2b (Activation)               (None, 55, 55, 128)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   4128        ee2b[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 128)  4224        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 128)  512         res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 128)  0           bn2c_branch2c[0][0]
                                                                 ee2b[0][0]
__________________________________________________________________________________________________
ee2c (Activation)               (None, 55, 55, 128)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 32)   4128        ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 28, 28, 32)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_9[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 256)  8448        activation_10[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 256)  33024       ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 256)  1024        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 256)  1024        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 256)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 256)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 32)   8224        activation_11[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_12[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 256)  8448        activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 256)  1024        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 256)  0           bn3b_branch2c[0][0]
                                                                 activation_11[0][0]
__________________________________________________________________________________________________
ee3b (Activation)               (None, 28, 28, 256)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 32)   8224        ee3b[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_14[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 256)  8448        activation_15[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 256)  1024        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 256)  0           bn3c_branch2c[0][0]
                                                                 ee3b[0][0]
__________________________________________________________________________________________________
ee3c (Activation)               (None, 28, 28, 256)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 32)   8224        ee3c[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_16[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 256)  8448        activation_17[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 256)  1024        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 256)  0           bn3d_branch2c[0][0]
                                                                 ee3c[0][0]
__________________________________________________________________________________________________
ee3d (Activation)               (None, 28, 28, 256)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 64)   16448       ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_18[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_19[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 256)  65792       ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 256)  1024        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 256)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 14, 14, 256)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 64)   16448       activation_20[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_21[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_22[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 256)  0           bn4b_branch2c[0][0]
                                                                 activation_20[0][0]
__________________________________________________________________________________________________
ee4b (Activation)               (None, 14, 14, 256)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 64)   16448       ee4b[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_23[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_24[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 256)  0           bn4c_branch2c[0][0]
                                                                 ee4b[0][0]
__________________________________________________________________________________________________
ee4c (Activation)               (None, 14, 14, 256)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 64)   16448       ee4c[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_25[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_26[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 256)  0           bn4d_branch2c[0][0]
                                                                 ee4c[0][0]
__________________________________________________________________________________________________
ee4d (Activation)               (None, 14, 14, 256)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 64)   16448       ee4d[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_27[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_28[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 256)  0           bn4e_branch2c[0][0]
                                                                 ee4d[0][0]
__________________________________________________________________________________________________
ee4e (Activation)               (None, 14, 14, 256)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 64)   16448       ee4e[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_29[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_30[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 256)  0           bn4f_branch2c[0][0]
                                                                 ee4e[0][0]
__________________________________________________________________________________________________
ee4f (Activation)               (None, 14, 14, 256)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 128)    32896       ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_31[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 512)    66048       activation_32[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 512)    131584      ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 512)    2048        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 512)    2048        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 512)    0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 512)    0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 128)    65664       activation_33[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_34[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 512)    66048       activation_35[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 512)    2048        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 512)    0           bn5b_branch2c[0][0]
                                                                 activation_33[0][0]
__________________________________________________________________________________________________
ee5b (Activation)               (None, 7, 7, 512)    0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 128)    65664       ee5b[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_36[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 512)    66048       activation_37[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 512)    2048        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 512)    0           bn5c_branch2c[0][0]
                                                                 ee5b[0][0]
__________________________________________________________________________________________________
ee5c (Activation)               (None, 7, 7, 512)    0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 512)    0           ee5c[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 512)          0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 50)           25650       flatten_1[0][0]
==================================================================================================
Total params: 1,680,114
Trainable params: 1,664,754
Non-trainable params: 15,360
__________________________________________________________________________________________________
Epoch 1/40
997/998 [============================>.] - ETA: 0s - loss: 3.5756 - acc: 0.1174Epoch 00001: val_acc improved from -inf to 0.18750, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00001: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 686s 687ms/step - loss: 3.5752 - acc: 0.1175 - val_loss: 3.1083 - val_acc: 0.1875
Epoch 2/40
997/998 [============================>.] - ETA: 0s - loss: 2.9107 - acc: 0.2336Epoch 00002: val_acc improved from 0.18750 to 0.26723, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00002: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 644s 646ms/step - loss: 2.9107 - acc: 0.2336 - val_loss: 2.7265 - val_acc: 0.2672
Epoch 3/40
997/998 [============================>.] - ETA: 0s - loss: 2.5813 - acc: 0.3057Epoch 00003: val_acc improved from 0.26723 to 0.34014, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00003: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 646s 647ms/step - loss: 2.5810 - acc: 0.3058 - val_loss: 2.4419 - val_acc: 0.3401
Epoch 4/40
997/998 [============================>.] - ETA: 0s - loss: 2.3338 - acc: 0.3664Epoch 00004: val_acc improved from 0.34014 to 0.39423, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00004: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 643s 645ms/step - loss: 2.3336 - acc: 0.3665 - val_loss: 2.1885 - val_acc: 0.3942
Epoch 5/40
997/998 [============================>.] - ETA: 0s - loss: 2.1222 - acc: 0.4154Epoch 00005: val_acc improved from 0.39423 to 0.42788, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00005: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 647s 648ms/step - loss: 2.1221 - acc: 0.4155 - val_loss: 2.1107 - val_acc: 0.4279
Epoch 6/40
997/998 [============================>.] - ETA: 0s - loss: 1.9519 - acc: 0.4575Epoch 00006: val_acc improved from 0.42788 to 0.45954, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00006: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 648s 649ms/step - loss: 1.9518 - acc: 0.4576 - val_loss: 1.9767 - val_acc: 0.4595
Epoch 7/40
997/998 [============================>.] - ETA: 0s - loss: 1.8000 - acc: 0.4961Epoch 00007: val_acc improved from 0.45954 to 0.46314, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00007: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 650s 651ms/step - loss: 1.7997 - acc: 0.4961 - val_loss: 1.9489 - val_acc: 0.4631
Epoch 8/40
997/998 [============================>.] - ETA: 0s - loss: 1.6743 - acc: 0.5276Epoch 00008: val_acc improved from 0.46314 to 0.51562, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00008: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 646s 647ms/step - loss: 1.6736 - acc: 0.5278 - val_loss: 1.7498 - val_acc: 0.5156
Epoch 9/40
997/998 [============================>.] - ETA: 0s - loss: 1.5663 - acc: 0.5555Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 649s 650ms/step - loss: 1.5661 - acc: 0.5555 - val_loss: 1.7744 - val_acc: 0.5124
Epoch 10/40
997/998 [============================>.] - ETA: 0s - loss: 1.4764 - acc: 0.5772Epoch 00010: val_acc improved from 0.51562 to 0.56250, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00010: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 646s 647ms/step - loss: 1.4765 - acc: 0.5772 - val_loss: 1.5964 - val_acc: 0.5625
Epoch 11/40
997/998 [============================>.] - ETA: 0s - loss: 1.3926 - acc: 0.6011Epoch 00011: val_acc improved from 0.56250 to 0.56691, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00011: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 646s 647ms/step - loss: 1.3925 - acc: 0.6011 - val_loss: 1.5381 - val_acc: 0.5669
Epoch 12/40
997/998 [============================>.] - ETA: 0s - loss: 1.3237 - acc: 0.6187Epoch 00012: val_acc improved from 0.56691 to 0.57692, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00012: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 650s 651ms/step - loss: 1.3236 - acc: 0.6187 - val_loss: 1.4816 - val_acc: 0.5769
Epoch 13/40
997/998 [============================>.] - ETA: 0s - loss: 1.2527 - acc: 0.6369Epoch 00013: val_acc improved from 0.57692 to 0.59736, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00013: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 645s 646ms/step - loss: 1.2526 - acc: 0.6369 - val_loss: 1.4382 - val_acc: 0.5974
Epoch 14/40
997/998 [============================>.] - ETA: 0s - loss: 1.2043 - acc: 0.6471Epoch 00014: val_acc improved from 0.59736 to 0.61819, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00014: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 646s 648ms/step - loss: 1.2041 - acc: 0.6472 - val_loss: 1.3310 - val_acc: 0.6182
Epoch 15/40
997/998 [============================>.] - ETA: 0s - loss: 1.1490 - acc: 0.6639Epoch 00015: val_acc improved from 0.61819 to 0.63902, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00015: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 648s 649ms/step - loss: 1.1490 - acc: 0.6639 - val_loss: 1.2972 - val_acc: 0.6390
Epoch 16/40
997/998 [============================>.] - ETA: 0s - loss: 1.1066 - acc: 0.6750Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 646s 647ms/step - loss: 1.1063 - acc: 0.6751 - val_loss: 1.3290 - val_acc: 0.6222
Epoch 17/40
997/998 [============================>.] - ETA: 0s - loss: 1.0644 - acc: 0.6860Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 647s 648ms/step - loss: 1.0643 - acc: 0.6860 - val_loss: 1.3635 - val_acc: 0.6294
Epoch 18/40
997/998 [============================>.] - ETA: 0s - loss: 1.0248 - acc: 0.6970Epoch 00018: val_acc improved from 0.63902 to 0.65865, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00018: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 647s 648ms/step - loss: 1.0250 - acc: 0.6969 - val_loss: 1.2726 - val_acc: 0.6587
Epoch 19/40
997/998 [============================>.] - ETA: 0s - loss: 0.9953 - acc: 0.7040Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 644s 645ms/step - loss: 0.9949 - acc: 0.7041 - val_loss: 1.1925 - val_acc: 0.6567
Epoch 20/40
997/998 [============================>.] - ETA: 0s - loss: 0.9626 - acc: 0.7143Epoch 00020: val_acc improved from 0.65865 to 0.66466, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00020: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 647s 648ms/step - loss: 0.9626 - acc: 0.7143 - val_loss: 1.2371 - val_acc: 0.6647
Epoch 21/40
997/998 [============================>.] - ETA: 0s - loss: 0.9274 - acc: 0.7222Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.9273 - acc: 0.7222 - val_loss: 1.3257 - val_acc: 0.6414
Epoch 22/40
997/998 [============================>.] - ETA: 0s - loss: 0.9040 - acc: 0.7294Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.9040 - acc: 0.7295 - val_loss: 1.2281 - val_acc: 0.6542
Epoch 23/40
997/998 [============================>.] - ETA: 0s - loss: 0.8739 - acc: 0.7367Epoch 00023: val_acc improved from 0.66466 to 0.66907, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00023: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 649s 650ms/step - loss: 0.8738 - acc: 0.7367 - val_loss: 1.1899 - val_acc: 0.6691
Epoch 24/40
997/998 [============================>.] - ETA: 0s - loss: 0.8440 - acc: 0.7457Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 648s 649ms/step - loss: 0.8441 - acc: 0.7457 - val_loss: 1.2364 - val_acc: 0.6611
Epoch 25/40
997/998 [============================>.] - ETA: 0s - loss: 0.8233 - acc: 0.7517Epoch 00025: val_acc improved from 0.66907 to 0.67748, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00025: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 646s 648ms/step - loss: 0.8230 - acc: 0.7519 - val_loss: 1.1907 - val_acc: 0.6775
Epoch 26/40
997/998 [============================>.] - ETA: 0s - loss: 0.8036 - acc: 0.7558Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 645s 647ms/step - loss: 0.8037 - acc: 0.7559 - val_loss: 1.2203 - val_acc: 0.6763
Epoch 27/40
997/998 [============================>.] - ETA: 0s - loss: 0.7773 - acc: 0.7636Epoch 00027: val_acc improved from 0.67748 to 0.67829, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00027: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 642s 644ms/step - loss: 0.7771 - acc: 0.7636 - val_loss: 1.1955 - val_acc: 0.6783
Epoch 28/40
997/998 [============================>.] - ETA: 0s - loss: 0.7506 - acc: 0.7707Epoch 00028: val_acc did not improve
Epoch 00028: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 646s 647ms/step - loss: 0.7506 - acc: 0.7707 - val_loss: 1.2423 - val_acc: 0.6631
Epoch 29/40
997/998 [============================>.] - ETA: 0s - loss: 0.7322 - acc: 0.7744Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.7321 - acc: 0.7745 - val_loss: 1.2630 - val_acc: 0.6627
Epoch 30/40
997/998 [============================>.] - ETA: 0s - loss: 0.7148 - acc: 0.7794Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 657s 659ms/step - loss: 0.7148 - acc: 0.7793 - val_loss: 1.1883 - val_acc: 0.6707
Epoch 31/40
997/998 [============================>.] - ETA: 0s - loss: 0.6918 - acc: 0.7855Epoch 00031: val_acc improved from 0.67829 to 0.69671, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00031: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 654s 655ms/step - loss: 0.6916 - acc: 0.7856 - val_loss: 1.1657 - val_acc: 0.6967
Epoch 32/40
997/998 [============================>.] - ETA: 0s - loss: 0.6811 - acc: 0.7901Epoch 00032: val_acc did not improve
Epoch 00032: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 654s 655ms/step - loss: 0.6810 - acc: 0.7901 - val_loss: 1.2050 - val_acc: 0.6875
Epoch 33/40
997/998 [============================>.] - ETA: 0s - loss: 0.6610 - acc: 0.7961Epoch 00033: val_acc did not improve
Epoch 00033: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 650s 651ms/step - loss: 0.6609 - acc: 0.7962 - val_loss: 1.2663 - val_acc: 0.6663
Epoch 34/40
997/998 [============================>.] - ETA: 0s - loss: 0.6429 - acc: 0.8025Epoch 00034: val_acc did not improve
Epoch 00034: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 645s 647ms/step - loss: 0.6427 - acc: 0.8025 - val_loss: 1.2026 - val_acc: 0.6815
Epoch 35/40
997/998 [============================>.] - ETA: 0s - loss: 0.6277 - acc: 0.8058Epoch 00035: val_acc did not improve
Epoch 00035: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 654s 655ms/step - loss: 0.6276 - acc: 0.8059 - val_loss: 1.1794 - val_acc: 0.6915
Epoch 36/40
997/998 [============================>.] - ETA: 0s - loss: 0.6117 - acc: 0.8101Epoch 00036: val_acc improved from 0.69671 to 0.69792, saving model to ./resnet/imagenet/results/40_1/40_best.h5
Epoch 00036: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 662s 663ms/step - loss: 0.6115 - acc: 0.8101 - val_loss: 1.1771 - val_acc: 0.6979
Epoch 37/40
997/998 [============================>.] - ETA: 0s - loss: 0.6006 - acc: 0.8120Epoch 00037: val_acc did not improve
Epoch 00037: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 661s 662ms/step - loss: 0.6008 - acc: 0.8119 - val_loss: 1.2751 - val_acc: 0.6631
Epoch 38/40
997/998 [============================>.] - ETA: 0s - loss: 0.5862 - acc: 0.8156Epoch 00038: val_acc did not improve
Epoch 00038: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 662s 663ms/step - loss: 0.5862 - acc: 0.8156 - val_loss: 1.2051 - val_acc: 0.6707
Epoch 39/40
997/998 [============================>.] - ETA: 0s - loss: 0.5668 - acc: 0.8218Epoch 00039: val_acc did not improve
Epoch 00039: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 658s 659ms/step - loss: 0.5667 - acc: 0.8218 - val_loss: 1.1956 - val_acc: 0.6931
Epoch 40/40
997/998 [============================>.] - ETA: 0s - loss: 0.5578 - acc: 0.8249Epoch 00040: val_acc did not improve
Epoch 00040: saving model to ./resnet/imagenet/results/40_1/40.h5
998/998 [==============================] - 662s 663ms/step - loss: 0.5578 - acc: 0.8249 - val_loss: 1.2701 - val_acc: 0.6775
Training resnet30 for imagenet
2017-11-27 16:04:45.432038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
[4.971954357929719, 0.015224358974358974]
Found 63911 images belonging to 50 classes.
Found 2500 images belonging to 50 classes.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 64)   2112        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 64)   4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 64)   256         res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 64)   0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 64)   0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   2080        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 64)   2112        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 64)   0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
ee2b (Activation)               (None, 55, 55, 64)   0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   2080        ee2b[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 64)   2112        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 64)   0           bn2c_branch2c[0][0]
                                                                 ee2b[0][0]
__________________________________________________________________________________________________
ee2c (Activation)               (None, 55, 55, 64)   0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 32)   2080        ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 28, 28, 32)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_9[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_10[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 128)  8320        ee2c[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 128)  512         res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 128)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 128)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_11[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_12[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 128)  0           bn3b_branch2c[0][0]
                                                                 activation_11[0][0]
__________________________________________________________________________________________________
ee3b (Activation)               (None, 28, 28, 128)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 32)   4128        ee3b[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_14[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_15[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 128)  0           bn3c_branch2c[0][0]
                                                                 ee3b[0][0]
__________________________________________________________________________________________________
ee3c (Activation)               (None, 28, 28, 128)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 32)   4128        ee3c[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_16[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_17[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 128)  0           bn3d_branch2c[0][0]
                                                                 ee3c[0][0]
__________________________________________________________________________________________________
ee3d (Activation)               (None, 28, 28, 128)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 64)   8256        ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_18[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_19[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 128)  16512       ee3d[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 128)  512         res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 128)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 14, 14, 128)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 64)   8256        activation_20[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_21[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_22[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 128)  0           bn4b_branch2c[0][0]
                                                                 activation_20[0][0]
__________________________________________________________________________________________________
ee4b (Activation)               (None, 14, 14, 128)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 64)   8256        ee4b[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_23[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_24[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 128)  0           bn4c_branch2c[0][0]
                                                                 ee4b[0][0]
__________________________________________________________________________________________________
ee4c (Activation)               (None, 14, 14, 128)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 64)   8256        ee4c[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_25[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_26[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 128)  0           bn4d_branch2c[0][0]
                                                                 ee4c[0][0]
__________________________________________________________________________________________________
ee4d (Activation)               (None, 14, 14, 128)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 64)   8256        ee4d[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_27[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_28[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 128)  0           bn4e_branch2c[0][0]
                                                                 ee4d[0][0]
__________________________________________________________________________________________________
ee4e (Activation)               (None, 14, 14, 128)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 64)   8256        ee4e[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_29[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_30[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 128)  0           bn4f_branch2c[0][0]
                                                                 ee4e[0][0]
__________________________________________________________________________________________________
ee4f (Activation)               (None, 14, 14, 128)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 128)    16512       ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_31[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 256)    33024       activation_32[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 256)    33024       ee4f[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 256)    1024        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 256)    0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 256)    0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 128)    32896       activation_33[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_34[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 256)    33024       activation_35[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 256)    0           bn5b_branch2c[0][0]
                                                                 activation_33[0][0]
__________________________________________________________________________________________________
ee5b (Activation)               (None, 7, 7, 256)    0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 128)    32896       ee5b[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_36[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 256)    33024       activation_37[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 256)    0           bn5c_branch2c[0][0]
                                                                 ee5b[0][0]
__________________________________________________________________________________________________
ee5c (Activation)               (None, 7, 7, 256)    0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 256)    0           ee5c[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 256)          0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 50)           12850       flatten_1[0][0]
==================================================================================================
Total params: 1,157,618
Trainable params: 1,147,890
Non-trainable params: 9,728
__________________________________________________________________________________________________
Epoch 1/40
997/998 [============================>.] - ETA: 0s - loss: 3.3452 - acc: 0.1444Epoch 00001: val_acc improved from -inf to 0.21354, saving model to ./resnet/imagenet/results/30_1/30_best.h5
Epoch 00001: saving model to ./resnet/imagenet/results/30_1/30.h5
998/998 [==============================] - 689s 691ms/step - loss: 3.3451 - acc: 0.1444 - val_loss: 2.9698 - val_acc: 0.2135
Epoch 2/40
997/998 [============================>.] - ETA: 0s - loss: 2.7618 - acc: 0.2586Epoch 00002: val_acc improved from 0.21354 to 0.31090, saving model to ./resnet/imagenet/results/30_1/30_best.h5
Epoch 00002: saving model to ./resnet/imagenet/results/30_1/30.h5
998/998 [==============================] - 648s 650ms/step - loss: 2.7617 - acc: 0.2586 - val_loss: 2.5624 - val_acc: 0.3109
Epoch 3/40
997/998 [============================>.] - ETA: 0s - loss: 2.4506 - acc: 0.3338Epoch 00003: val_acc improved from 0.31090 to 0.38622, saving model to ./resnet/imagenet/results/30_1/30_best.h5
Epoch 00003: saving model to ./resnet/imagenet/results/30_1/30.h5
998/998 [==============================] - 653s 655ms/step - loss: 2.4503 - acc: 0.3338 - val_loss: 2.3325 - val_acc: 0.3862
Epoch 4/40
997/998 [============================>.] - ETA: 0s - loss: 2.2137 - acc: 0.3914Epoch 00004: val_acc improved from 0.38622 to 0.41747, saving model to ./resnet/imagenet/results/30_1/30_best.h5
Epoch 00004: saving model to ./resnet/imagenet/results/30_1/30.h5
998/998 [==============================] - 653s 655ms/step - loss: 2.2136 - acc: 0.3914 - val_loss: 2.1121 - val_acc: 0.4175
Epoch 5/40
997/998 [============================>.] - ETA: 0s - loss: 2.0127 - acc: 0.4424Epoch 00005: val_acc improved from 0.41747 to 0.47196, saving model to ./resnet/imagenet/results/30_1/30_best.h5
Epoch 00005: saving model to ./resnet/imagenet/results/30_1/30.h5
998/998 [==============================] - 663s 664ms/step - loss: 2.0129 - acc: 0.4423 - val_loss: 1.9353 - val_acc: 0.4720
Epoch 6/40
997/998 [============================>.] - ETA: 0s - loss: 1.8616 - acc: 0.4777Epoch 00006: val_acc improved from 0.47196 to 0.48237, saving model to ./resnet/imagenet/results/30_1/30_best.h5
Epoch 00006: saving model to ./resnet/imagenet/results/30_1/30.h5
998/998 [==============================] - 653s 654ms/step - loss: 1.8616 - acc: 0.4777 - val_loss: 1.8916 - val_acc: 0.4824
Epoch 7/40
164/998 [===>..........................] - ETA: 6:15 - loss: 1.7596 - acc: 0.5070
Process finished with exit code 137 (interrupted by signal 9: SIGKILL)
