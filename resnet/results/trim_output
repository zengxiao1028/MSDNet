/home/xiao/anaconda2/envs/tf/bin/python /home/xiao/projects/MSDNet/ResNet50.py
Using TensorFlow backend.
2017-11-19 14:51:39.537093: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.537109: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.537113: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.537115: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.537118: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.776809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.6705
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 10.05GiB
2017-11-19 14:51:39.776831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2017-11-19 14:51:39.776835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2017-11-19 14:51:39.776840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
2017-11-19 14:51:42.138429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
##### Training resnet90 #####
2017-11-19 14:52:22.784216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[2.525744821780767, 0.083633814102564097]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 64)   4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 64)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   18464       activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 64)   16448       activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 64)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   18464       activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 64)   16448       activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 64)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   18464       activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 128)  32896       activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 128)  0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 128)  0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 128)  0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 128)  0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 256)  131328      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 256)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 1024) 525312      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 1024) 4096        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 256)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 1024) 0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 256)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 1024) 0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 256)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 1024) 0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 256)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 1024) 0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 1024) 0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 256)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 1024) 0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 1024) 0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 512)    524800      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 512)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 256)    1179904     activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 2048)   2099200     activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 2048)   8192        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 512)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 256)    1179904     activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 2048)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 512)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 256)    1179904     activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 2048)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 2048)   0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           20490       flatten_1[0][0]
==================================================================================================
Total params: 15,425,194
Trainable params: 15,375,850
Non-trainable params: 49,344
__________________________________________________________________________________________________
Epoch 1/20
780/781 [============================>.] - ETA: 0s - loss: 0.1998 - acc: 0.9374Epoch 00001: val_acc improved from -inf to 0.92037, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00001: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 482s 617ms/step - loss: 0.1998 - acc: 0.9374 - val_loss: 0.2635 - val_acc: 0.9204
Epoch 2/20
780/781 [============================>.] - ETA: 0s - loss: 0.1065 - acc: 0.9635Epoch 00002: val_acc improved from 0.92037 to 0.93690, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00002: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 482s 617ms/step - loss: 0.1064 - acc: 0.9636 - val_loss: 0.2101 - val_acc: 0.9369
Epoch 3/20
780/781 [============================>.] - ETA: 0s - loss: 0.0905 - acc: 0.9698Epoch 00003: val_acc improved from 0.93690 to 0.93971, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00003: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 474s 607ms/step - loss: 0.0905 - acc: 0.9698 - val_loss: 0.2090 - val_acc: 0.9397
Epoch 4/20
780/781 [============================>.] - ETA: 0s - loss: 0.0854 - acc: 0.9708Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 474s 607ms/step - loss: 0.0855 - acc: 0.9708 - val_loss: 0.2886 - val_acc: 0.9200
Epoch 5/20
780/781 [============================>.] - ETA: 0s - loss: 0.0802 - acc: 0.9729Epoch 00005: val_acc did not improve
Epoch 00005: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 474s 607ms/step - loss: 0.0801 - acc: 0.9730 - val_loss: 0.3267 - val_acc: 0.9170
Epoch 6/20
780/781 [============================>.] - ETA: 0s - loss: 0.0712 - acc: 0.9751Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 481s 616ms/step - loss: 0.0712 - acc: 0.9751 - val_loss: 0.2210 - val_acc: 0.9395
Epoch 7/20
780/781 [============================>.] - ETA: 0s - loss: 0.0688 - acc: 0.9765Epoch 00007: val_acc did not improve
Epoch 00007: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 492s 629ms/step - loss: 0.0688 - acc: 0.9765 - val_loss: 0.2448 - val_acc: 0.9393
Epoch 8/20
780/781 [============================>.] - ETA: 0s - loss: 0.0641 - acc: 0.9778Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 559s 715ms/step - loss: 0.0641 - acc: 0.9778 - val_loss: 0.2472 - val_acc: 0.9370
Epoch 9/20
780/781 [============================>.] - ETA: 0s - loss: 0.0654 - acc: 0.9779Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 549s 703ms/step - loss: 0.0653 - acc: 0.9780 - val_loss: 0.2402 - val_acc: 0.9327
Epoch 10/20
780/781 [============================>.] - ETA: 0s - loss: 0.0590 - acc: 0.9799Epoch 00010: val_acc improved from 0.93971 to 0.94374, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00010: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 475s 608ms/step - loss: 0.0590 - acc: 0.9799 - val_loss: 0.2028 - val_acc: 0.9437
Epoch 11/20
780/781 [============================>.] - ETA: 0s - loss: 0.0601 - acc: 0.9802Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 496s 635ms/step - loss: 0.0601 - acc: 0.9803 - val_loss: 0.2415 - val_acc: 0.9386
Epoch 12/20
780/781 [============================>.] - ETA: 0s - loss: 0.0577 - acc: 0.9802Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 617s 790ms/step - loss: 0.0577 - acc: 0.9802 - val_loss: 0.2123 - val_acc: 0.9437
Epoch 13/20
780/781 [============================>.] - ETA: 0s - loss: 0.0520 - acc: 0.9818Epoch 00013: val_acc improved from 0.94374 to 0.94605, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00013: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 545s 698ms/step - loss: 0.0519 - acc: 0.9818 - val_loss: 0.2208 - val_acc: 0.9461
Epoch 14/20
780/781 [============================>.] - ETA: 0s - loss: 0.0502 - acc: 0.9831Epoch 00014: val_acc improved from 0.94605 to 0.94626, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00014: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 623s 797ms/step - loss: 0.0502 - acc: 0.9831 - val_loss: 0.1981 - val_acc: 0.9463
Epoch 15/20
780/781 [============================>.] - ETA: 0s - loss: 0.0546 - acc: 0.9810Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 836s 1s/step - loss: 0.0546 - acc: 0.9811 - val_loss: 0.2289 - val_acc: 0.9382
Epoch 16/20
780/781 [============================>.] - ETA: 0s - loss: 0.0472 - acc: 0.9842Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 608s 778ms/step - loss: 0.0471 - acc: 0.9842 - val_loss: 0.2381 - val_acc: 0.9400
Epoch 17/20
780/781 [============================>.] - ETA: 0s - loss: 0.0510 - acc: 0.9830Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 671s 859ms/step - loss: 0.0510 - acc: 0.9830 - val_loss: 0.2826 - val_acc: 0.9307
Epoch 18/20
780/781 [============================>.] - ETA: 0s - loss: 0.0449 - acc: 0.9848Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 764s 979ms/step - loss: 0.0449 - acc: 0.9849 - val_loss: 0.2303 - val_acc: 0.9380
Epoch 19/20
780/781 [============================>.] - ETA: 0s - loss: 0.0464 - acc: 0.9838Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 704s 901ms/step - loss: 0.0463 - acc: 0.9838 - val_loss: 0.2671 - val_acc: 0.9367
Epoch 20/20
780/781 [============================>.] - ETA: 0s - loss: 0.0457 - acc: 0.9847Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 579s 742ms/step - loss: 0.0457 - acc: 0.9847 - val_loss: 0.2414 - val_acc: 0.9388
Traceback (most recent call last):
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 632, in <module>
    trimmer.trim()
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 574, in trim
    with open(self.target_config_path) as config_buffer:
FileNotFoundError: [Errno 2] No such file or directory: './resnet/configs80.json'
##### Training resnet80 #####

Process finished with exit code 1
/home/xiao/anaconda2/envs/tf/bin/python /home/xiao/projects/MSDNet/ResNet50.py
Using TensorFlow backend.
2017-11-19 18:05:50.637123: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.637140: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.637144: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.637146: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.637149: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.884770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.6705
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 10.05GiB
2017-11-19 18:05:50.884790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2017-11-19 18:05:50.884795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2017-11-19 18:05:50.884805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
##### Training resnet80 #####
2017-11-19 18:05:53.176032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
2017-11-19 18:06:19.613405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[2.3058214386304221, 0.12520032051282051]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 64)   16448       activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 1024) 525312      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 1024) 4096        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 1024) 0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 1024) 0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 1024) 0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 1024) 0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 1024) 0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 1024) 0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 1024) 0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 256)    262400      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 2048)   2099200     activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 2048)   8192        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 256)    524544      activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 2048)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 256)    524544      activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 2048)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 2048)   0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           20490       flatten_1[0][0]
==================================================================================================
Total params: 10,421,706
Trainable params: 10,376,138
Non-trainable params: 45,568
__________________________________________________________________________________________________
Epoch 1/20
780/781 [============================>.] - ETA: 0s - loss: 0.2166 - acc: 0.9315Epoch 00001: val_acc improved from -inf to 0.92137, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00001: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 428s 548ms/step - loss: 0.2163 - acc: 0.9315 - val_loss: 0.2728 - val_acc: 0.9214
Epoch 2/20
780/781 [============================>.] - ETA: 0s - loss: 0.1028 - acc: 0.9644Epoch 00002: val_acc improved from 0.92137 to 0.93307, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00002: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 422s 541ms/step - loss: 0.1030 - acc: 0.9643 - val_loss: 0.2381 - val_acc: 0.9331
Epoch 3/20
780/781 [============================>.] - ETA: 0s - loss: 0.0872 - acc: 0.9704Epoch 00003: val_acc improved from 0.93307 to 0.93388, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00003: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 424s 542ms/step - loss: 0.0871 - acc: 0.9705 - val_loss: 0.2329 - val_acc: 0.9339
Epoch 4/20
780/781 [============================>.] - ETA: 0s - loss: 0.0745 - acc: 0.9745Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 422s 540ms/step - loss: 0.0745 - acc: 0.9745 - val_loss: 0.2559 - val_acc: 0.9309
Epoch 5/20
780/781 [============================>.] - ETA: 0s - loss: 0.0713 - acc: 0.9759Epoch 00005: val_acc did not improve
Epoch 00005: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 424s 543ms/step - loss: 0.0712 - acc: 0.9759 - val_loss: 0.2666 - val_acc: 0.9284
Epoch 6/20
780/781 [============================>.] - ETA: 0s - loss: 0.0621 - acc: 0.9787Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 421s 539ms/step - loss: 0.0620 - acc: 0.9787 - val_loss: 0.2951 - val_acc: 0.9291
Epoch 7/20
780/781 [============================>.] - ETA: 0s - loss: 0.0661 - acc: 0.9770Epoch 00007: val_acc improved from 0.93388 to 0.93680, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00007: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 421s 539ms/step - loss: 0.0660 - acc: 0.9770 - val_loss: 0.2433 - val_acc: 0.9368
Epoch 8/20
780/781 [============================>.] - ETA: 0s - loss: 0.0593 - acc: 0.9799Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 425s 544ms/step - loss: 0.0593 - acc: 0.9800 - val_loss: 0.2870 - val_acc: 0.9309
Epoch 9/20
780/781 [============================>.] - ETA: 0s - loss: 0.0584 - acc: 0.9799Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 437s 559ms/step - loss: 0.0584 - acc: 0.9799 - val_loss: 0.2496 - val_acc: 0.9355
Epoch 10/20
780/781 [============================>.] - ETA: 0s - loss: 0.0536 - acc: 0.9816Epoch 00010: val_acc did not improve
Epoch 00010: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 421s 539ms/step - loss: 0.0537 - acc: 0.9816 - val_loss: 0.2679 - val_acc: 0.9327
Epoch 11/20
780/781 [============================>.] - ETA: 0s - loss: 0.0537 - acc: 0.9820Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 423s 541ms/step - loss: 0.0536 - acc: 0.9820 - val_loss: 0.2792 - val_acc: 0.9311
Epoch 12/20
780/781 [============================>.] - ETA: 0s - loss: 0.0512 - acc: 0.9819Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 423s 542ms/step - loss: 0.0512 - acc: 0.9819 - val_loss: 0.3461 - val_acc: 0.9205
Epoch 13/20
780/781 [============================>.] - ETA: 0s - loss: 0.0468 - acc: 0.9842Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 423s 542ms/step - loss: 0.0468 - acc: 0.9843 - val_loss: 0.2502 - val_acc: 0.9323
Epoch 14/20
780/781 [============================>.] - ETA: 0s - loss: 0.0472 - acc: 0.9846Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 433s 554ms/step - loss: 0.0472 - acc: 0.9846 - val_loss: 0.2789 - val_acc: 0.9331
Epoch 15/20
780/781 [============================>.] - ETA: 0s - loss: 0.0493 - acc: 0.9835Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 429s 549ms/step - loss: 0.0493 - acc: 0.9834 - val_loss: 0.2991 - val_acc: 0.9285
Epoch 16/20
780/781 [============================>.] - ETA: 0s - loss: 0.0451 - acc: 0.9839Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 433s 554ms/step - loss: 0.0451 - acc: 0.9839 - val_loss: 0.2588 - val_acc: 0.9363
Epoch 17/20
780/781 [============================>.] - ETA: 0s - loss: 0.0441 - acc: 0.9847Epoch 00017: val_acc improved from 0.93680 to 0.94022, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00017: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 428s 548ms/step - loss: 0.0441 - acc: 0.9847 - val_loss: 0.2666 - val_acc: 0.9402
Epoch 18/20
780/781 [============================>.] - ETA: 0s - loss: 0.0447 - acc: 0.9849Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 439s 562ms/step - loss: 0.0447 - acc: 0.9850 - val_loss: 0.2857 - val_acc: 0.9303
Epoch 19/20
780/781 [============================>.] - ETA: 0s - loss: 0.0407 - acc: 0.9857Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 432s 553ms/step - loss: 0.0407 - acc: 0.9857 - val_loss: 0.3599 - val_acc: 0.9210
Epoch 20/20
780/781 [============================>.] - ETA: 0s - loss: 0.0384 - acc: 0.9865Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 481s 616ms/step - loss: 0.0385 - acc: 0.9865 - val_loss: 0.2645 - val_acc: 0.9382
##### Training resnet70 #####
Traceback (most recent call last):
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 639, in <module>
    trimmer.trim()
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 596, in trim
    trimmed_model = resnet.trim(target_config['model']['filters'],target_config['model']['name'])
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 386, in trim
    w = np.reshape(w.T, (-1, w.shape[0], w.shape[1], w.shape[3]))
IndexError: tuple index out of range

Process finished with exit code 1
