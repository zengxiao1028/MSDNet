/home/xiao/anaconda2/envs/tf/bin/python /home/xiao/projects/MSDNet/ResNet50.py
Using TensorFlow backend.
2017-11-19 14:51:39.537093: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.537109: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.537113: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.537115: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.537118: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 14:51:39.776809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.6705
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 10.05GiB
2017-11-19 14:51:39.776831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2017-11-19 14:51:39.776835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2017-11-19 14:51:39.776840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
2017-11-19 14:51:42.138429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
##### Training resnet90 #####
2017-11-19 14:52:22.784216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[2.525744821780767, 0.083633814102564097]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 64)   4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 64)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   18464       activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 64)   16448       activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 64)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   18464       activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 64)   16448       activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 64)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   18464       activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 128)  32896       activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 128)  0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 128)  0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 128)  0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 128)  0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 64)   73792       activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 256)  131328      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 256)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 1024) 525312      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 1024) 4096        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 256)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 1024) 0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 256)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 1024) 0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 256)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 1024) 0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 256)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 1024) 0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 1024) 0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 256)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 128)  295040      activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 1024) 0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 1024) 0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 512)    524800      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 512)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 256)    1179904     activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 2048)   2099200     activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 2048)   8192        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 512)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 256)    1179904     activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 2048)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 512)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 256)    1179904     activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 2048)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 2048)   0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           20490       flatten_1[0][0]
==================================================================================================
Total params: 15,425,194
Trainable params: 15,375,850
Non-trainable params: 49,344
__________________________________________________________________________________________________
Epoch 1/20
780/781 [============================>.] - ETA: 0s - loss: 0.1998 - acc: 0.9374Epoch 00001: val_acc improved from -inf to 0.92037, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00001: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 482s 617ms/step - loss: 0.1998 - acc: 0.9374 - val_loss: 0.2635 - val_acc: 0.9204
Epoch 2/20
780/781 [============================>.] - ETA: 0s - loss: 0.1065 - acc: 0.9635Epoch 00002: val_acc improved from 0.92037 to 0.93690, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00002: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 482s 617ms/step - loss: 0.1064 - acc: 0.9636 - val_loss: 0.2101 - val_acc: 0.9369
Epoch 3/20
780/781 [============================>.] - ETA: 0s - loss: 0.0905 - acc: 0.9698Epoch 00003: val_acc improved from 0.93690 to 0.93971, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00003: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 474s 607ms/step - loss: 0.0905 - acc: 0.9698 - val_loss: 0.2090 - val_acc: 0.9397
Epoch 4/20
780/781 [============================>.] - ETA: 0s - loss: 0.0854 - acc: 0.9708Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 474s 607ms/step - loss: 0.0855 - acc: 0.9708 - val_loss: 0.2886 - val_acc: 0.9200
Epoch 5/20
780/781 [============================>.] - ETA: 0s - loss: 0.0802 - acc: 0.9729Epoch 00005: val_acc did not improve
Epoch 00005: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 474s 607ms/step - loss: 0.0801 - acc: 0.9730 - val_loss: 0.3267 - val_acc: 0.9170
Epoch 6/20
780/781 [============================>.] - ETA: 0s - loss: 0.0712 - acc: 0.9751Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 481s 616ms/step - loss: 0.0712 - acc: 0.9751 - val_loss: 0.2210 - val_acc: 0.9395
Epoch 7/20
780/781 [============================>.] - ETA: 0s - loss: 0.0688 - acc: 0.9765Epoch 00007: val_acc did not improve
Epoch 00007: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 492s 629ms/step - loss: 0.0688 - acc: 0.9765 - val_loss: 0.2448 - val_acc: 0.9393
Epoch 8/20
780/781 [============================>.] - ETA: 0s - loss: 0.0641 - acc: 0.9778Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 559s 715ms/step - loss: 0.0641 - acc: 0.9778 - val_loss: 0.2472 - val_acc: 0.9370
Epoch 9/20
780/781 [============================>.] - ETA: 0s - loss: 0.0654 - acc: 0.9779Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 549s 703ms/step - loss: 0.0653 - acc: 0.9780 - val_loss: 0.2402 - val_acc: 0.9327
Epoch 10/20
780/781 [============================>.] - ETA: 0s - loss: 0.0590 - acc: 0.9799Epoch 00010: val_acc improved from 0.93971 to 0.94374, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00010: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 475s 608ms/step - loss: 0.0590 - acc: 0.9799 - val_loss: 0.2028 - val_acc: 0.9437
Epoch 11/20
780/781 [============================>.] - ETA: 0s - loss: 0.0601 - acc: 0.9802Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 496s 635ms/step - loss: 0.0601 - acc: 0.9803 - val_loss: 0.2415 - val_acc: 0.9386
Epoch 12/20
780/781 [============================>.] - ETA: 0s - loss: 0.0577 - acc: 0.9802Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 617s 790ms/step - loss: 0.0577 - acc: 0.9802 - val_loss: 0.2123 - val_acc: 0.9437
Epoch 13/20
780/781 [============================>.] - ETA: 0s - loss: 0.0520 - acc: 0.9818Epoch 00013: val_acc improved from 0.94374 to 0.94605, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00013: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 545s 698ms/step - loss: 0.0519 - acc: 0.9818 - val_loss: 0.2208 - val_acc: 0.9461
Epoch 14/20
780/781 [============================>.] - ETA: 0s - loss: 0.0502 - acc: 0.9831Epoch 00014: val_acc improved from 0.94605 to 0.94626, saving model to ./resnet/results/90_1/90_best.h5
Epoch 00014: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 623s 797ms/step - loss: 0.0502 - acc: 0.9831 - val_loss: 0.1981 - val_acc: 0.9463
Epoch 15/20
780/781 [============================>.] - ETA: 0s - loss: 0.0546 - acc: 0.9810Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 836s 1s/step - loss: 0.0546 - acc: 0.9811 - val_loss: 0.2289 - val_acc: 0.9382
Epoch 16/20
780/781 [============================>.] - ETA: 0s - loss: 0.0472 - acc: 0.9842Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 608s 778ms/step - loss: 0.0471 - acc: 0.9842 - val_loss: 0.2381 - val_acc: 0.9400
Epoch 17/20
780/781 [============================>.] - ETA: 0s - loss: 0.0510 - acc: 0.9830Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 671s 859ms/step - loss: 0.0510 - acc: 0.9830 - val_loss: 0.2826 - val_acc: 0.9307
Epoch 18/20
780/781 [============================>.] - ETA: 0s - loss: 0.0449 - acc: 0.9848Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 764s 979ms/step - loss: 0.0449 - acc: 0.9849 - val_loss: 0.2303 - val_acc: 0.9380
Epoch 19/20
780/781 [============================>.] - ETA: 0s - loss: 0.0464 - acc: 0.9838Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 704s 901ms/step - loss: 0.0463 - acc: 0.9838 - val_loss: 0.2671 - val_acc: 0.9367
Epoch 20/20
780/781 [============================>.] - ETA: 0s - loss: 0.0457 - acc: 0.9847Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/results/90_1/90.h5
781/781 [==============================] - 579s 742ms/step - loss: 0.0457 - acc: 0.9847 - val_loss: 0.2414 - val_acc: 0.9388
Traceback (most recent call last):
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 632, in <module>
    trimmer.trim()
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 574, in trim
    with open(self.target_config_path) as config_buffer:
FileNotFoundError: [Errno 2] No such file or directory: './resnet/configs80.json'
##### Training resnet80 #####

Process finished with exit code 1
/home/xiao/anaconda2/envs/tf/bin/python /home/xiao/projects/MSDNet/ResNet50.py
Using TensorFlow backend.
2017-11-19 18:05:50.637123: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.637140: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.637144: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.637146: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.637149: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 18:05:50.884770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.6705
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 10.05GiB
2017-11-19 18:05:50.884790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2017-11-19 18:05:50.884795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2017-11-19 18:05:50.884805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
##### Training resnet80 #####
2017-11-19 18:05:53.176032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
2017-11-19 18:06:19.613405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[2.3058214386304221, 0.12520032051282051]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 64)   16448       activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 1024) 525312      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 1024) 4096        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 1024) 0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 1024) 0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 1024) 0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 1024) 0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 1024) 0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 128)  131200      activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 1024) 132096      activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 1024) 0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 1024) 0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 256)    262400      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 2048)   2099200     activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 2048)   8192        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 256)    524544      activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 2048)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 256)    524544      activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 2048)   526336      activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 2048)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 2048)   0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           20490       flatten_1[0][0]
==================================================================================================
Total params: 10,421,706
Trainable params: 10,376,138
Non-trainable params: 45,568
__________________________________________________________________________________________________
Epoch 1/20
780/781 [============================>.] - ETA: 0s - loss: 0.2166 - acc: 0.9315Epoch 00001: val_acc improved from -inf to 0.92137, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00001: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 428s 548ms/step - loss: 0.2163 - acc: 0.9315 - val_loss: 0.2728 - val_acc: 0.9214
Epoch 2/20
780/781 [============================>.] - ETA: 0s - loss: 0.1028 - acc: 0.9644Epoch 00002: val_acc improved from 0.92137 to 0.93307, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00002: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 422s 541ms/step - loss: 0.1030 - acc: 0.9643 - val_loss: 0.2381 - val_acc: 0.9331
Epoch 3/20
780/781 [============================>.] - ETA: 0s - loss: 0.0872 - acc: 0.9704Epoch 00003: val_acc improved from 0.93307 to 0.93388, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00003: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 424s 542ms/step - loss: 0.0871 - acc: 0.9705 - val_loss: 0.2329 - val_acc: 0.9339
Epoch 4/20
780/781 [============================>.] - ETA: 0s - loss: 0.0745 - acc: 0.9745Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 422s 540ms/step - loss: 0.0745 - acc: 0.9745 - val_loss: 0.2559 - val_acc: 0.9309
Epoch 5/20
780/781 [============================>.] - ETA: 0s - loss: 0.0713 - acc: 0.9759Epoch 00005: val_acc did not improve
Epoch 00005: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 424s 543ms/step - loss: 0.0712 - acc: 0.9759 - val_loss: 0.2666 - val_acc: 0.9284
Epoch 6/20
780/781 [============================>.] - ETA: 0s - loss: 0.0621 - acc: 0.9787Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 421s 539ms/step - loss: 0.0620 - acc: 0.9787 - val_loss: 0.2951 - val_acc: 0.9291
Epoch 7/20
780/781 [============================>.] - ETA: 0s - loss: 0.0661 - acc: 0.9770Epoch 00007: val_acc improved from 0.93388 to 0.93680, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00007: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 421s 539ms/step - loss: 0.0660 - acc: 0.9770 - val_loss: 0.2433 - val_acc: 0.9368
Epoch 8/20
780/781 [============================>.] - ETA: 0s - loss: 0.0593 - acc: 0.9799Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 425s 544ms/step - loss: 0.0593 - acc: 0.9800 - val_loss: 0.2870 - val_acc: 0.9309
Epoch 9/20
780/781 [============================>.] - ETA: 0s - loss: 0.0584 - acc: 0.9799Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 437s 559ms/step - loss: 0.0584 - acc: 0.9799 - val_loss: 0.2496 - val_acc: 0.9355
Epoch 10/20
780/781 [============================>.] - ETA: 0s - loss: 0.0536 - acc: 0.9816Epoch 00010: val_acc did not improve
Epoch 00010: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 421s 539ms/step - loss: 0.0537 - acc: 0.9816 - val_loss: 0.2679 - val_acc: 0.9327
Epoch 11/20
780/781 [============================>.] - ETA: 0s - loss: 0.0537 - acc: 0.9820Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 423s 541ms/step - loss: 0.0536 - acc: 0.9820 - val_loss: 0.2792 - val_acc: 0.9311
Epoch 12/20
780/781 [============================>.] - ETA: 0s - loss: 0.0512 - acc: 0.9819Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 423s 542ms/step - loss: 0.0512 - acc: 0.9819 - val_loss: 0.3461 - val_acc: 0.9205
Epoch 13/20
780/781 [============================>.] - ETA: 0s - loss: 0.0468 - acc: 0.9842Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 423s 542ms/step - loss: 0.0468 - acc: 0.9843 - val_loss: 0.2502 - val_acc: 0.9323
Epoch 14/20
780/781 [============================>.] - ETA: 0s - loss: 0.0472 - acc: 0.9846Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 433s 554ms/step - loss: 0.0472 - acc: 0.9846 - val_loss: 0.2789 - val_acc: 0.9331
Epoch 15/20
780/781 [============================>.] - ETA: 0s - loss: 0.0493 - acc: 0.9835Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 429s 549ms/step - loss: 0.0493 - acc: 0.9834 - val_loss: 0.2991 - val_acc: 0.9285
Epoch 16/20
780/781 [============================>.] - ETA: 0s - loss: 0.0451 - acc: 0.9839Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 433s 554ms/step - loss: 0.0451 - acc: 0.9839 - val_loss: 0.2588 - val_acc: 0.9363
Epoch 17/20
780/781 [============================>.] - ETA: 0s - loss: 0.0441 - acc: 0.9847Epoch 00017: val_acc improved from 0.93680 to 0.94022, saving model to ./resnet/results/80_1/80_best.h5
Epoch 00017: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 428s 548ms/step - loss: 0.0441 - acc: 0.9847 - val_loss: 0.2666 - val_acc: 0.9402
Epoch 18/20
780/781 [============================>.] - ETA: 0s - loss: 0.0447 - acc: 0.9849Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 439s 562ms/step - loss: 0.0447 - acc: 0.9850 - val_loss: 0.2857 - val_acc: 0.9303
Epoch 19/20
780/781 [============================>.] - ETA: 0s - loss: 0.0407 - acc: 0.9857Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 432s 553ms/step - loss: 0.0407 - acc: 0.9857 - val_loss: 0.3599 - val_acc: 0.9210
Epoch 20/20
780/781 [============================>.] - ETA: 0s - loss: 0.0384 - acc: 0.9865Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/results/80_1/80.h5
781/781 [==============================] - 481s 616ms/step - loss: 0.0385 - acc: 0.9865 - val_loss: 0.2645 - val_acc: 0.9382
##### Training resnet70 #####
Traceback (most recent call last):
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 639, in <module>
    trimmer.trim()
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 596, in trim
    trimmed_model = resnet.trim(target_config['model']['filters'],target_config['model']['name'])
  File "/home/xiao/projects/MSDNet/ResNet50.py", line 386, in trim
    w = np.reshape(w.T, (-1, w.shape[0], w.shape[1], w.shape[3]))
IndexError: tuple index out of range

Process finished with exit code 1
/home/xiao/anaconda2/envs/tf/bin/python /home/xiao/projects/MSDNet/ResNet50.py
Using TensorFlow backend.
2017-11-19 22:34:19.926457: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 22:34:19.926475: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 22:34:19.926479: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 22:34:19.926482: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 22:34:19.926485: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-11-19 22:34:20.144669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.6705
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 10.06GiB
2017-11-19 22:34:20.144688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2017-11-19 22:34:20.144692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2017-11-19 22:34:20.144698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
##### Training resnet70 #####
2017-11-19 22:34:22.346914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
2017-11-19 22:34:48.706454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[2.36281048028897, 0.090745192307692304]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 64)   16448       activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 64)   36928       activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  33280       activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 512)  262656      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 512)  2048        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 512)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 512)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 512)  0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 512)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 512)  0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 512)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 512)  0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 512)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 512)  0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 512)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 128)  147584      activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 512)  66048       activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 512)  0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 512)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 256)    131328      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 1024)   263168      activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 1024)   525312      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 1024)   4096        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 1024)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 1024)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 256)    262400      activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 1024)   263168      activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 1024)   0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 1024)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 256)    262400      activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 256)    590080      activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 1024)   263168      activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 1024)   0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 1024)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 1024)   0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1024)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           10250       flatten_1[0][0]
==================================================================================================
Total params: 6,375,370
Trainable params: 6,345,162
Non-trainable params: 30,208
__________________________________________________________________________________________________
Epoch 1/30
780/781 [============================>.] - ETA: 0s - loss: 1.1755 - acc: 0.5829Epoch 00001: val_acc improved from -inf to 0.73918, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00001: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 381s 488ms/step - loss: 1.1751 - acc: 0.5830 - val_loss: 0.7596 - val_acc: 0.7392
Epoch 2/30
780/781 [============================>.] - ETA: 0s - loss: 0.6879 - acc: 0.7604Epoch 00002: val_acc improved from 0.73918 to 0.80636, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00002: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 484ms/step - loss: 0.6877 - acc: 0.7604 - val_loss: 0.5532 - val_acc: 0.8064
Epoch 3/30
780/781 [============================>.] - ETA: 0s - loss: 0.5345 - acc: 0.8152Epoch 00003: val_acc improved from 0.80636 to 0.84048, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00003: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 379s 485ms/step - loss: 0.5344 - acc: 0.8152 - val_loss: 0.4614 - val_acc: 0.8405
Epoch 4/30
780/781 [============================>.] - ETA: 0s - loss: 0.4523 - acc: 0.8419Epoch 00004: val_acc improved from 0.84048 to 0.84662, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00004: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 485ms/step - loss: 0.4522 - acc: 0.8420 - val_loss: 0.4553 - val_acc: 0.8466
Epoch 5/30
780/781 [============================>.] - ETA: 0s - loss: 0.3948 - acc: 0.8629Epoch 00005: val_acc improved from 0.84662 to 0.87128, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00005: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 484ms/step - loss: 0.3948 - acc: 0.8629 - val_loss: 0.3699 - val_acc: 0.8713
Epoch 6/30
780/781 [============================>.] - ETA: 0s - loss: 0.3552 - acc: 0.8757Epoch 00006: val_acc improved from 0.87128 to 0.87631, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00006: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 484ms/step - loss: 0.3554 - acc: 0.8756 - val_loss: 0.3690 - val_acc: 0.8763
Epoch 7/30
780/781 [============================>.] - ETA: 0s - loss: 0.3178 - acc: 0.8882Epoch 00007: val_acc improved from 0.87631 to 0.88587, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00007: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 485ms/step - loss: 0.3179 - acc: 0.8882 - val_loss: 0.3264 - val_acc: 0.8859
Epoch 8/30
780/781 [============================>.] - ETA: 0s - loss: 0.2908 - acc: 0.8976Epoch 00008: val_acc improved from 0.88587 to 0.89342, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00008: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 379s 485ms/step - loss: 0.2910 - acc: 0.8975 - val_loss: 0.3109 - val_acc: 0.8934
Epoch 9/30
780/781 [============================>.] - ETA: 0s - loss: 0.2673 - acc: 0.9067Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 377s 483ms/step - loss: 0.2673 - acc: 0.9066 - val_loss: 0.3510 - val_acc: 0.8860
Epoch 10/30
780/781 [============================>.] - ETA: 0s - loss: 0.2463 - acc: 0.9136Epoch 00010: val_acc improved from 0.89342 to 0.89412, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00010: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 484ms/step - loss: 0.2462 - acc: 0.9136 - val_loss: 0.3139 - val_acc: 0.8941
Epoch 11/30
780/781 [============================>.] - ETA: 0s - loss: 0.2282 - acc: 0.9203Epoch 00011: val_acc improved from 0.89412 to 0.90197, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00011: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 485ms/step - loss: 0.2282 - acc: 0.9203 - val_loss: 0.3019 - val_acc: 0.9020
Epoch 12/30
780/781 [============================>.] - ETA: 0s - loss: 0.2135 - acc: 0.9245Epoch 00012: val_acc improved from 0.90197 to 0.90409, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00012: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 485ms/step - loss: 0.2136 - acc: 0.9245 - val_loss: 0.3103 - val_acc: 0.9041
Epoch 13/30
780/781 [============================>.] - ETA: 0s - loss: 0.1981 - acc: 0.9304Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 377s 483ms/step - loss: 0.1982 - acc: 0.9304 - val_loss: 0.3106 - val_acc: 0.9029
Epoch 14/30
780/781 [============================>.] - ETA: 0s - loss: 0.1811 - acc: 0.9360Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 377s 483ms/step - loss: 0.1812 - acc: 0.9360 - val_loss: 0.3503 - val_acc: 0.8968
Epoch 15/30
780/781 [============================>.] - ETA: 0s - loss: 0.1804 - acc: 0.9379Epoch 00015: val_acc improved from 0.90409 to 0.90992, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00015: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 485ms/step - loss: 0.1805 - acc: 0.9378 - val_loss: 0.2881 - val_acc: 0.9099
Epoch 16/30
780/781 [============================>.] - ETA: 0s - loss: 0.1648 - acc: 0.9422Epoch 00016: val_acc improved from 0.90992 to 0.91556, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00016: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 484ms/step - loss: 0.1650 - acc: 0.9421 - val_loss: 0.2707 - val_acc: 0.9156
Epoch 17/30
780/781 [============================>.] - ETA: 0s - loss: 0.1551 - acc: 0.9453Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 483ms/step - loss: 0.1550 - acc: 0.9453 - val_loss: 0.3170 - val_acc: 0.9006
Epoch 18/30
780/781 [============================>.] - ETA: 0s - loss: 0.1469 - acc: 0.9489Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 377s 483ms/step - loss: 0.1469 - acc: 0.9489 - val_loss: 0.2917 - val_acc: 0.9119
Epoch 19/30
780/781 [============================>.] - ETA: 0s - loss: 0.1382 - acc: 0.9519Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 378s 484ms/step - loss: 0.1381 - acc: 0.9519 - val_loss: 0.2935 - val_acc: 0.9145
Epoch 20/30
780/781 [============================>.] - ETA: 0s - loss: 0.1327 - acc: 0.9534Epoch 00020: val_acc improved from 0.91556 to 0.91757, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00020: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 379s 486ms/step - loss: 0.1326 - acc: 0.9534 - val_loss: 0.2912 - val_acc: 0.9176
Epoch 21/30
780/781 [============================>.] - ETA: 0s - loss: 0.1251 - acc: 0.9553Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 377s 483ms/step - loss: 0.1250 - acc: 0.9553 - val_loss: 0.3024 - val_acc: 0.9112
Epoch 22/30
780/781 [============================>.] - ETA: 0s - loss: 0.1216 - acc: 0.9569Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 377s 483ms/step - loss: 0.1217 - acc: 0.9568 - val_loss: 0.3263 - val_acc: 0.9046
Epoch 23/30
780/781 [============================>.] - ETA: 0s - loss: 0.1153 - acc: 0.9599Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 377s 483ms/step - loss: 0.1152 - acc: 0.9600 - val_loss: 0.2860 - val_acc: 0.9156
Epoch 24/30
780/781 [============================>.] - ETA: 0s - loss: 0.1091 - acc: 0.9613Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 383s 491ms/step - loss: 0.1092 - acc: 0.9612 - val_loss: 0.3071 - val_acc: 0.9114
Epoch 25/30
780/781 [============================>.] - ETA: 0s - loss: 0.1056 - acc: 0.9622Epoch 00025: val_acc improved from 0.91757 to 0.91868, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00025: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 383s 491ms/step - loss: 0.1057 - acc: 0.9621 - val_loss: 0.3006 - val_acc: 0.9187
Epoch 26/30
780/781 [============================>.] - ETA: 0s - loss: 0.1033 - acc: 0.9638Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 380s 487ms/step - loss: 0.1034 - acc: 0.9638 - val_loss: 0.2888 - val_acc: 0.9174
Epoch 27/30
780/781 [============================>.] - ETA: 0s - loss: 0.0963 - acc: 0.9662Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 391s 500ms/step - loss: 0.0963 - acc: 0.9662 - val_loss: 0.2964 - val_acc: 0.9176
Epoch 28/30
780/781 [============================>.] - ETA: 0s - loss: 0.0927 - acc: 0.9665Epoch 00028: val_acc improved from 0.91868 to 0.92099, saving model to ./resnet/results/70_1/70_best.h5
Epoch 00028: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 382s 489ms/step - loss: 0.0926 - acc: 0.9666 - val_loss: 0.2952 - val_acc: 0.9210
Epoch 29/30
780/781 [============================>.] - ETA: 0s - loss: 0.0932 - acc: 0.9669Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 380s 486ms/step - loss: 0.0933 - acc: 0.9669 - val_loss: 0.3114 - val_acc: 0.9144
Epoch 30/30
780/781 [============================>.] - ETA: 0s - loss: 0.0832 - acc: 0.9703Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/results/70_1/70.h5
781/781 [==============================] - 403s 516ms/step - loss: 0.0832 - acc: 0.9703 - val_loss: 0.3122 - val_acc: 0.9138
##### Training resnet60 #####
2017-11-20 01:46:55.734813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[2.3614762975619388, 0.30188301282051283]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 64)   16448       activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 64)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 32)   18464       activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 64)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 32)   18464       activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 64)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 32)   18464       activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 64)   32832       activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 64)   256         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 64)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 32)   18464       activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 128)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 512)  262656      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 512)  2048        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 512)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 512)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 128)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 512)  0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 512)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 128)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 512)  0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 512)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 128)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 512)  0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 512)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 128)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 512)  0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 512)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 128)  65664       activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 128)  0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 64)   73792       activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 512)  0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 512)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 256)    131328      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 256)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 128)    295040      activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 1024)   525312      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 1024)   4096        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 1024)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 1024)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 256)    262400      activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 256)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 128)    295040      activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 1024)   0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 1024)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 256)    262400      activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 256)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 128)    295040      activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 1024)   0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 1024)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 1024)   0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1024)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           10250       flatten_1[0][0]
==================================================================================================
Total params: 4,314,698
Trainable params: 4,286,282
Non-trainable params: 28,416
__________________________________________________________________________________________________
Epoch 1/40
780/781 [============================>.] - ETA: 0s - loss: 0.2729 - acc: 0.9039Epoch 00001: val_acc improved from -inf to 0.89443, saving model to ./resnet/results/60_1/60_best.h5
Epoch 00001: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 383s 490ms/step - loss: 0.2728 - acc: 0.9040 - val_loss: 0.3384 - val_acc: 0.8944
Epoch 2/40
780/781 [============================>.] - ETA: 0s - loss: 0.1939 - acc: 0.9310Epoch 00002: val_acc improved from 0.89443 to 0.89895, saving model to ./resnet/results/60_1/60_best.h5
Epoch 00002: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 369s 473ms/step - loss: 0.1938 - acc: 0.9311 - val_loss: 0.3359 - val_acc: 0.8990
Epoch 3/40
780/781 [============================>.] - ETA: 0s - loss: 0.1691 - acc: 0.9407Epoch 00003: val_acc improved from 0.89895 to 0.90177, saving model to ./resnet/results/60_1/60_best.h5
Epoch 00003: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 490s 628ms/step - loss: 0.1691 - acc: 0.9407 - val_loss: 0.3387 - val_acc: 0.9018
Epoch 4/40
780/781 [============================>.] - ETA: 0s - loss: 0.1556 - acc: 0.9450Epoch 00004: val_acc improved from 0.90177 to 0.91093, saving model to ./resnet/results/60_1/60_best.h5
Epoch 00004: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 733s 939ms/step - loss: 0.1556 - acc: 0.9450 - val_loss: 0.3061 - val_acc: 0.9109
Epoch 5/40
780/781 [============================>.] - ETA: 0s - loss: 0.1414 - acc: 0.9501Epoch 00005: val_acc did not improve
Epoch 00005: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 743s 951ms/step - loss: 0.1415 - acc: 0.9501 - val_loss: 0.3572 - val_acc: 0.8974
Epoch 6/40
780/781 [============================>.] - ETA: 0s - loss: 0.1377 - acc: 0.9518Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 483s 618ms/step - loss: 0.1378 - acc: 0.9518 - val_loss: 0.3343 - val_acc: 0.9026
Epoch 7/40
780/781 [============================>.] - ETA: 0s - loss: 0.1261 - acc: 0.9548Epoch 00007: val_acc did not improve
Epoch 00007: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 741s 948ms/step - loss: 0.1262 - acc: 0.9547 - val_loss: 0.3454 - val_acc: 0.9035
Epoch 8/40
780/781 [============================>.] - ETA: 1s - loss: 0.1202 - acc: 0.9577Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 1017s 1s/step - loss: 0.1203 - acc: 0.9576 - val_loss: 0.3521 - val_acc: 0.9037
Epoch 9/40
780/781 [============================>.] - ETA: 0s - loss: 0.1147 - acc: 0.9601Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 549s 702ms/step - loss: 0.1147 - acc: 0.9601 - val_loss: 0.3174 - val_acc: 0.9105
Epoch 10/40
780/781 [============================>.] - ETA: 0s - loss: 0.1097 - acc: 0.9618Epoch 00010: val_acc improved from 0.91093 to 0.91254, saving model to ./resnet/results/60_1/60_best.h5
Epoch 00010: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 425s 544ms/step - loss: 0.1097 - acc: 0.9618 - val_loss: 0.3302 - val_acc: 0.9125
Epoch 11/40
780/781 [============================>.] - ETA: 0s - loss: 0.1057 - acc: 0.9629Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 533s 682ms/step - loss: 0.1057 - acc: 0.9629 - val_loss: 0.3296 - val_acc: 0.9076
Epoch 12/40
780/781 [============================>.] - ETA: 0s - loss: 0.0989 - acc: 0.9650Epoch 00012: val_acc improved from 0.91254 to 0.91546, saving model to ./resnet/results/60_1/60_best.h5
Epoch 00012: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 659s 844ms/step - loss: 0.0988 - acc: 0.9650 - val_loss: 0.3103 - val_acc: 0.9155
Epoch 13/40
780/781 [============================>.] - ETA: 0s - loss: 0.0980 - acc: 0.9654Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 567s 726ms/step - loss: 0.0981 - acc: 0.9654 - val_loss: 0.3491 - val_acc: 0.9058
Epoch 14/40
780/781 [============================>.] - ETA: 0s - loss: 0.0909 - acc: 0.9684Epoch 00014: val_acc improved from 0.91546 to 0.92009, saving model to ./resnet/results/60_1/60_best.h5
Epoch 00014: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 695s 890ms/step - loss: 0.0909 - acc: 0.9684 - val_loss: 0.2889 - val_acc: 0.9201
Epoch 15/40
780/781 [============================>.] - ETA: 1s - loss: 0.0897 - acc: 0.9684Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 858s 1s/step - loss: 0.0897 - acc: 0.9683 - val_loss: 0.3299 - val_acc: 0.9080
Epoch 16/40
780/781 [============================>.] - ETA: 0s - loss: 0.0878 - acc: 0.9699Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 407s 521ms/step - loss: 0.0878 - acc: 0.9699 - val_loss: 0.3277 - val_acc: 0.9146
Epoch 17/40
780/781 [============================>.] - ETA: 0s - loss: 0.0845 - acc: 0.9703Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 409s 524ms/step - loss: 0.0845 - acc: 0.9703 - val_loss: 0.3031 - val_acc: 0.9137
Epoch 18/40
780/781 [============================>.] - ETA: 0s - loss: 0.0798 - acc: 0.9727Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 471s 603ms/step - loss: 0.0799 - acc: 0.9727 - val_loss: 0.3512 - val_acc: 0.9103
Epoch 19/40
780/781 [============================>.] - ETA: 0s - loss: 0.0800 - acc: 0.9725Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 555s 711ms/step - loss: 0.0800 - acc: 0.9725 - val_loss: 0.3055 - val_acc: 0.9158
Epoch 20/40
780/781 [============================>.] - ETA: 0s - loss: 0.0764 - acc: 0.9735Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 415s 531ms/step - loss: 0.0764 - acc: 0.9735 - val_loss: 0.3220 - val_acc: 0.9150
Epoch 21/40
780/781 [============================>.] - ETA: 0s - loss: 0.0752 - acc: 0.9747Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 410s 525ms/step - loss: 0.0751 - acc: 0.9747 - val_loss: 0.3230 - val_acc: 0.9163
Epoch 22/40
780/781 [============================>.] - ETA: 0s - loss: 0.0713 - acc: 0.9743Epoch 00022: val_acc improved from 0.92009 to 0.92502, saving model to ./resnet/results/60_1/60_best.h5
Epoch 00022: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 555s 711ms/step - loss: 0.0713 - acc: 0.9743 - val_loss: 0.2812 - val_acc: 0.9250
Epoch 23/40
780/781 [============================>.] - ETA: 0s - loss: 0.0722 - acc: 0.9743Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 404s 517ms/step - loss: 0.0723 - acc: 0.9743 - val_loss: 0.3253 - val_acc: 0.9165
Epoch 24/40
780/781 [============================>.] - ETA: 0s - loss: 0.0701 - acc: 0.9758Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 403s 516ms/step - loss: 0.0700 - acc: 0.9759 - val_loss: 0.3273 - val_acc: 0.9120
Epoch 25/40
780/781 [============================>.] - ETA: 0s - loss: 0.0681 - acc: 0.9767Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 404s 518ms/step - loss: 0.0681 - acc: 0.9767 - val_loss: 0.3649 - val_acc: 0.9089
Epoch 26/40
780/781 [============================>.] - ETA: 0s - loss: 0.0687 - acc: 0.9759Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 404s 517ms/step - loss: 0.0686 - acc: 0.9759 - val_loss: 0.3556 - val_acc: 0.9138
Epoch 27/40
780/781 [============================>.] - ETA: 0s - loss: 0.0686 - acc: 0.9756Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 416s 533ms/step - loss: 0.0686 - acc: 0.9756 - val_loss: 0.3493 - val_acc: 0.9102
Epoch 28/40
780/781 [============================>.] - ETA: 0s - loss: 0.0615 - acc: 0.9783Epoch 00028: val_acc did not improve
Epoch 00028: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 511s 654ms/step - loss: 0.0614 - acc: 0.9783 - val_loss: 0.3196 - val_acc: 0.9172
Epoch 29/40
780/781 [============================>.] - ETA: 0s - loss: 0.0577 - acc: 0.9800Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 446s 571ms/step - loss: 0.0576 - acc: 0.9800 - val_loss: 0.3605 - val_acc: 0.9145
Epoch 30/40
780/781 [============================>.] - ETA: 0s - loss: 0.0614 - acc: 0.9786Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 402s 514ms/step - loss: 0.0614 - acc: 0.9786 - val_loss: 0.3195 - val_acc: 0.9197
Epoch 31/40
780/781 [============================>.] - ETA: 0s - loss: 0.0576 - acc: 0.9803Epoch 00031: val_acc did not improve
Epoch 00031: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 496s 636ms/step - loss: 0.0577 - acc: 0.9802 - val_loss: 0.3238 - val_acc: 0.9202
Epoch 32/40
780/781 [============================>.] - ETA: 0s - loss: 0.0580 - acc: 0.9797Epoch 00032: val_acc did not improve
Epoch 00032: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 612s 783ms/step - loss: 0.0580 - acc: 0.9797 - val_loss: 0.3665 - val_acc: 0.9108
Epoch 33/40
780/781 [============================>.] - ETA: 0s - loss: 0.0594 - acc: 0.9794Epoch 00033: val_acc did not improve
Epoch 00033: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 543s 696ms/step - loss: 0.0594 - acc: 0.9794 - val_loss: 0.3034 - val_acc: 0.9229
Epoch 34/40
780/781 [============================>.] - ETA: 0s - loss: 0.0536 - acc: 0.9819Epoch 00034: val_acc did not improve
Epoch 00034: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 642s 822ms/step - loss: 0.0537 - acc: 0.9818 - val_loss: 0.4140 - val_acc: 0.9061
Epoch 35/40
780/781 [============================>.] - ETA: 0s - loss: 0.0560 - acc: 0.9806Epoch 00035: val_acc did not improve
Epoch 00035: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 746s 956ms/step - loss: 0.0560 - acc: 0.9806 - val_loss: 0.3703 - val_acc: 0.9147
Epoch 36/40
780/781 [============================>.] - ETA: 0s - loss: 0.0531 - acc: 0.9820Epoch 00036: val_acc did not improve
Epoch 00036: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 409s 523ms/step - loss: 0.0531 - acc: 0.9820 - val_loss: 0.4200 - val_acc: 0.9034
Epoch 37/40
780/781 [============================>.] - ETA: 0s - loss: 0.0546 - acc: 0.9807Epoch 00037: val_acc did not improve
Epoch 00037: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 394s 505ms/step - loss: 0.0545 - acc: 0.9807 - val_loss: 0.3539 - val_acc: 0.9143
Epoch 38/40
780/781 [============================>.] - ETA: 0s - loss: 0.0501 - acc: 0.9820Epoch 00038: val_acc improved from 0.92502 to 0.92603, saving model to ./resnet/results/60_1/60_best.h5
Epoch 00038: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 434s 556ms/step - loss: 0.0502 - acc: 0.9820 - val_loss: 0.3153 - val_acc: 0.9260
Epoch 39/40
780/781 [============================>.] - ETA: 0s - loss: 0.0502 - acc: 0.9826Epoch 00039: val_acc did not improve
Epoch 00039: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 593s 760ms/step - loss: 0.0502 - acc: 0.9826 - val_loss: 0.4614 - val_acc: 0.9016
Epoch 40/40
780/781 [============================>.] - ETA: 0s - loss: 0.0508 - acc: 0.9822Epoch 00040: val_acc did not improve
Epoch 00040: saving model to ./resnet/results/60_1/60.h5
781/781 [==============================] - 548s 702ms/step - loss: 0.0508 - acc: 0.9822 - val_loss: 0.3432 - val_acc: 0.9187
##### Training resnet50 #####
2017-11-20 07:43:29.343815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[4.4262452278381739, 0.12279647435897435]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 256)  16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 256)  1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 256)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   8224        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 256)  8448        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 256)  1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 256)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 32)   8224        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 512)  131584      activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 32)   16416       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 32)   16416       activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 32)   16416       activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 512)  16896       activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 512)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 64)   32832       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 512)  262656      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 512)  2048        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 512)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 512)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 64)   32832       activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 512)  0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 512)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 64)   32832       activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 512)  0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 512)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 64)   32832       activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 512)  0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 512)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 64)   32832       activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 512)  0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 512)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 64)   32832       activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 512)  33280       activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 512)  2048        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 512)  0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 512)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 128)    65664       activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 1024)   525312      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 1024)   4096        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 1024)   0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 1024)   0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 128)    131200      activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 1024)   0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 1024)   0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 128)    131200      activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 1024)   132096      activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 1024)   4096        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 1024)   0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 1024)   0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 1024)   0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1024)         0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           10250       flatten_1[0][0]
==================================================================================================
Total params: 3,028,170
Trainable params: 3,001,546
Non-trainable params: 26,624
__________________________________________________________________________________________________
Epoch 1/40
780/781 [============================>.] - ETA: 0s - loss: 0.2827 - acc: 0.9039Epoch 00001: val_acc improved from -inf to 0.89864, saving model to ./resnet/results/50_1/50_best.h5
Epoch 00001: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 392s 502ms/step - loss: 0.2828 - acc: 0.9040 - val_loss: 0.3274 - val_acc: 0.8986
Epoch 2/40
780/781 [============================>.] - ETA: 0s - loss: 0.1719 - acc: 0.9393Epoch 00002: val_acc improved from 0.89864 to 0.90570, saving model to ./resnet/results/50_1/50_best.h5
Epoch 00002: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 351s 450ms/step - loss: 0.1719 - acc: 0.9393 - val_loss: 0.3181 - val_acc: 0.9057
Epoch 3/40
780/781 [============================>.] - ETA: 0s - loss: 0.1451 - acc: 0.9481Epoch 00003: val_acc did not improve
Epoch 00003: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 355s 455ms/step - loss: 0.1450 - acc: 0.9481 - val_loss: 0.3568 - val_acc: 0.9029
Epoch 4/40
780/781 [============================>.] - ETA: 0s - loss: 0.1314 - acc: 0.9541Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 503s 644ms/step - loss: 0.1314 - acc: 0.9541 - val_loss: 0.3531 - val_acc: 0.9035
Epoch 5/40
780/781 [============================>.] - ETA: 0s - loss: 0.1147 - acc: 0.9599Epoch 00005: val_acc did not improve
Epoch 00005: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 386s 495ms/step - loss: 0.1148 - acc: 0.9599 - val_loss: 0.3638 - val_acc: 0.9047
Epoch 6/40
780/781 [============================>.] - ETA: 0s - loss: 0.1098 - acc: 0.9608Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 347s 445ms/step - loss: 0.1098 - acc: 0.9608 - val_loss: 0.3564 - val_acc: 0.9037
Epoch 7/40
780/781 [============================>.] - ETA: 0s - loss: 0.1005 - acc: 0.9645Epoch 00007: val_acc improved from 0.90570 to 0.91033, saving model to ./resnet/results/50_1/50_best.h5
Epoch 00007: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 348s 446ms/step - loss: 0.1004 - acc: 0.9645 - val_loss: 0.3331 - val_acc: 0.9103
Epoch 8/40
780/781 [============================>.] - ETA: 0s - loss: 0.0984 - acc: 0.9650Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 374s 479ms/step - loss: 0.0984 - acc: 0.9650 - val_loss: 0.4191 - val_acc: 0.8964
Epoch 9/40
780/781 [============================>.] - ETA: 0s - loss: 0.0904 - acc: 0.9680Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 445s 569ms/step - loss: 0.0904 - acc: 0.9680 - val_loss: 0.3801 - val_acc: 0.8991
Epoch 10/40
780/781 [============================>.] - ETA: 0s - loss: 0.0858 - acc: 0.9698Epoch 00010: val_acc did not improve
Epoch 00010: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 368s 471ms/step - loss: 0.0857 - acc: 0.9699 - val_loss: 0.3730 - val_acc: 0.9072
Epoch 11/40
780/781 [============================>.] - ETA: 0s - loss: 0.0825 - acc: 0.9712Epoch 00011: val_acc improved from 0.91033 to 0.91284, saving model to ./resnet/results/50_1/50_best.h5
Epoch 00011: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 400s 513ms/step - loss: 0.0825 - acc: 0.9712 - val_loss: 0.3492 - val_acc: 0.9128
Epoch 12/40
780/781 [============================>.] - ETA: 0s - loss: 0.0764 - acc: 0.9733Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 497s 637ms/step - loss: 0.0764 - acc: 0.9733 - val_loss: 0.3560 - val_acc: 0.9126
Epoch 13/40
780/781 [============================>.] - ETA: 0s - loss: 0.0783 - acc: 0.9724Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 753s 964ms/step - loss: 0.0782 - acc: 0.9725 - val_loss: 0.3669 - val_acc: 0.9086
Epoch 14/40
780/781 [============================>.] - ETA: 0s - loss: 0.0740 - acc: 0.9747Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 726s 929ms/step - loss: 0.0740 - acc: 0.9747 - val_loss: 0.5347 - val_acc: 0.8782
Epoch 15/40
780/781 [============================>.] - ETA: 0s - loss: 0.0724 - acc: 0.9745Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 795s 1s/step - loss: 0.0724 - acc: 0.9745 - val_loss: 0.3941 - val_acc: 0.9060
Epoch 16/40
780/781 [============================>.] - ETA: 0s - loss: 0.0719 - acc: 0.9748Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 387s 495ms/step - loss: 0.0719 - acc: 0.9748 - val_loss: 0.3273 - val_acc: 0.9128
Epoch 17/40
780/781 [============================>.] - ETA: 0s - loss: 0.0702 - acc: 0.9759Epoch 00017: val_acc improved from 0.91284 to 0.91536, saving model to ./resnet/results/50_1/50_best.h5
Epoch 00017: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 756s 968ms/step - loss: 0.0702 - acc: 0.9759 - val_loss: 0.3272 - val_acc: 0.9154
Epoch 18/40
780/781 [============================>.] - ETA: 0s - loss: 0.0639 - acc: 0.9777Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 473s 605ms/step - loss: 0.0639 - acc: 0.9777 - val_loss: 0.3936 - val_acc: 0.9035
Epoch 19/40
780/781 [============================>.] - ETA: 0s - loss: 0.0679 - acc: 0.9764Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 603s 772ms/step - loss: 0.0679 - acc: 0.9764 - val_loss: 0.4027 - val_acc: 0.9039
Epoch 20/40
780/781 [============================>.] - ETA: 1s - loss: 0.0607 - acc: 0.9787Epoch 00020: val_acc improved from 0.91536 to 0.92089, saving model to ./resnet/results/50_1/50_best.h5
Epoch 00020: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 901s 1s/step - loss: 0.0607 - acc: 0.9787 - val_loss: 0.3333 - val_acc: 0.9209
Epoch 21/40
780/781 [============================>.] - ETA: 0s - loss: 0.0620 - acc: 0.9787Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 648s 829ms/step - loss: 0.0621 - acc: 0.9787 - val_loss: 0.3798 - val_acc: 0.9093
Epoch 22/40
780/781 [============================>.] - ETA: 0s - loss: 0.0587 - acc: 0.9794Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 365s 468ms/step - loss: 0.0587 - acc: 0.9795 - val_loss: 0.3914 - val_acc: 0.9123
Epoch 23/40
780/781 [============================>.] - ETA: 0s - loss: 0.0567 - acc: 0.9798Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 409s 524ms/step - loss: 0.0566 - acc: 0.9798 - val_loss: 0.3546 - val_acc: 0.9139
Epoch 24/40
780/781 [============================>.] - ETA: 0s - loss: 0.0599 - acc: 0.9790Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 517s 662ms/step - loss: 0.0599 - acc: 0.9791 - val_loss: 0.3754 - val_acc: 0.9124
Epoch 25/40
780/781 [============================>.] - ETA: 0s - loss: 0.0559 - acc: 0.9806Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 601s 770ms/step - loss: 0.0559 - acc: 0.9806 - val_loss: 0.4160 - val_acc: 0.9057
Epoch 26/40
780/781 [============================>.] - ETA: 1s - loss: 0.0523 - acc: 0.9818Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 984s 1s/step - loss: 0.0523 - acc: 0.9818 - val_loss: 0.3520 - val_acc: 0.9181
Epoch 27/40
780/781 [============================>.] - ETA: 0s - loss: 0.0583 - acc: 0.9796Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 491s 628ms/step - loss: 0.0583 - acc: 0.9797 - val_loss: 0.3462 - val_acc: 0.9146
Epoch 28/40
780/781 [============================>.] - ETA: 0s - loss: 0.0526 - acc: 0.9812Epoch 00028: val_acc did not improve
Epoch 00028: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 382s 489ms/step - loss: 0.0526 - acc: 0.9812 - val_loss: 0.4308 - val_acc: 0.9020
Epoch 29/40
780/781 [============================>.] - ETA: 0s - loss: 0.0514 - acc: 0.9820Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 534s 684ms/step - loss: 0.0514 - acc: 0.9820 - val_loss: 0.3628 - val_acc: 0.9125
Epoch 30/40
780/781 [============================>.] - ETA: 0s - loss: 0.0537 - acc: 0.9814Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 442s 567ms/step - loss: 0.0537 - acc: 0.9814 - val_loss: 0.3828 - val_acc: 0.9149
Epoch 31/40
780/781 [============================>.] - ETA: 0s - loss: 0.0510 - acc: 0.9822Epoch 00031: val_acc did not improve
Epoch 00031: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 364s 467ms/step - loss: 0.0510 - acc: 0.9821 - val_loss: 0.3964 - val_acc: 0.9113
Epoch 32/40
780/781 [============================>.] - ETA: 0s - loss: 0.0480 - acc: 0.9830Epoch 00032: val_acc did not improve
Epoch 00032: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 363s 464ms/step - loss: 0.0481 - acc: 0.9830 - val_loss: 0.4156 - val_acc: 0.9085
Epoch 33/40
780/781 [============================>.] - ETA: 0s - loss: 0.0497 - acc: 0.9828Epoch 00033: val_acc did not improve
Epoch 00033: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 351s 449ms/step - loss: 0.0498 - acc: 0.9827 - val_loss: 0.4697 - val_acc: 0.8989
Epoch 34/40
780/781 [============================>.] - ETA: 0s - loss: 0.0484 - acc: 0.9833Epoch 00034: val_acc did not improve
Epoch 00034: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 367s 470ms/step - loss: 0.0484 - acc: 0.9833 - val_loss: 0.3478 - val_acc: 0.9186
Epoch 35/40
780/781 [============================>.] - ETA: 0s - loss: 0.0464 - acc: 0.9841Epoch 00035: val_acc improved from 0.92089 to 0.92170, saving model to ./resnet/results/50_1/50_best.h5
Epoch 00035: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 354s 453ms/step - loss: 0.0464 - acc: 0.9841 - val_loss: 0.3478 - val_acc: 0.9217
Epoch 36/40
780/781 [============================>.] - ETA: 0s - loss: 0.0495 - acc: 0.9828Epoch 00036: val_acc did not improve
Epoch 00036: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 354s 453ms/step - loss: 0.0496 - acc: 0.9828 - val_loss: 0.3649 - val_acc: 0.9166
Epoch 37/40
780/781 [============================>.] - ETA: 0s - loss: 0.0462 - acc: 0.9837Epoch 00037: val_acc did not improve
Epoch 00037: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 353s 451ms/step - loss: 0.0463 - acc: 0.9837 - val_loss: 0.3769 - val_acc: 0.9161
Epoch 38/40
780/781 [============================>.] - ETA: 0s - loss: 0.0437 - acc: 0.9845Epoch 00038: val_acc did not improve
Epoch 00038: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 351s 450ms/step - loss: 0.0437 - acc: 0.9845 - val_loss: 0.3987 - val_acc: 0.9094
Epoch 39/40
780/781 [============================>.] - ETA: 0s - loss: 0.0430 - acc: 0.9849Epoch 00039: val_acc did not improve
Epoch 00039: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 353s 451ms/step - loss: 0.0429 - acc: 0.9850 - val_loss: 0.3399 - val_acc: 0.9217
Epoch 40/40
780/781 [============================>.] - ETA: 0s - loss: 0.0432 - acc: 0.9852Epoch 00040: val_acc did not improve
Epoch 00040: saving model to ./resnet/results/50_1/50.h5
781/781 [==============================] - 352s 451ms/step - loss: 0.0432 - acc: 0.9852 - val_loss: 0.4058 - val_acc: 0.9071
##### Training resnet40 #####
2017-11-20 13:03:47.813785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[4.1323971962317438, 0.10006009615384616]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 128)  4224        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 128)  8320        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 128)  512         res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 128)  512         res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 128)  0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 128)  0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   4128        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 128)  4224        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 128)  512         res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 128)  0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 128)  0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   4128        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 128)  4224        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 128)  512         res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 128)  0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 128)  0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 256)  8448        activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 256)  33024       activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 256)  1024        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 256)  1024        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 256)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 256)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 32)   8224        activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 256)  8448        activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 256)  1024        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 256)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 256)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 32)   8224        activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 256)  8448        activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 256)  1024        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 256)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 256)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 32)   8224        activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 256)  8448        activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 256)  1024        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 256)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 256)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 64)   16448       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 256)  65792       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 256)  1024        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 256)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 256)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 64)   16448       activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 256)  0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 256)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 64)   16448       activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 256)  0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 256)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 64)   16448       activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 256)  0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 256)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 64)   16448       activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 256)  0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 256)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 64)   16448       activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 256)  16640       activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 256)  1024        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 256)  0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 256)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 128)    32896       activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 512)    66048       activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 512)    131584      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 512)    2048        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 512)    2048        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 512)    0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 512)    0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 128)    65664       activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 512)    66048       activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 512)    2048        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 512)    0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 512)    0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 128)    65664       activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 512)    66048       activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 512)    2048        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 512)    0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 512)    0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 512)    0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 512)          0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           5130        flatten_1[0][0]
==================================================================================================
Total params: 1,659,594
Trainable params: 1,644,234
Non-trainable params: 15,360
__________________________________________________________________________________________________
Epoch 1/30
780/781 [============================>.] - ETA: 0s - loss: 1.8780 - acc: 0.3266Epoch 00001: val_acc improved from -inf to 0.44872, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00001: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 248s 318ms/step - loss: 1.8779 - acc: 0.3266 - val_loss: 1.4783 - val_acc: 0.4487
Epoch 2/30
780/781 [============================>.] - ETA: 0s - loss: 1.4392 - acc: 0.4761Epoch 00002: val_acc improved from 0.44872 to 0.54076, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00002: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 244s 313ms/step - loss: 1.4391 - acc: 0.4761 - val_loss: 1.2610 - val_acc: 0.5408
Epoch 3/30
780/781 [============================>.] - ETA: 0s - loss: 1.2551 - acc: 0.5443Epoch 00003: val_acc improved from 0.54076 to 0.59742, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00003: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 245s 313ms/step - loss: 1.2550 - acc: 0.5443 - val_loss: 1.1100 - val_acc: 0.5974
Epoch 4/30
780/781 [============================>.] - ETA: 0s - loss: 1.1069 - acc: 0.6018Epoch 00004: val_acc improved from 0.59742 to 0.63486, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00004: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 244s 312ms/step - loss: 1.1069 - acc: 0.6019 - val_loss: 1.0190 - val_acc: 0.6349
Epoch 5/30
780/781 [============================>.] - ETA: 0s - loss: 0.9927 - acc: 0.6455Epoch 00005: val_acc improved from 0.63486 to 0.66224, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00005: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 248s 318ms/step - loss: 0.9927 - acc: 0.6456 - val_loss: 0.9628 - val_acc: 0.6622
Epoch 6/30
780/781 [============================>.] - ETA: 0s - loss: 0.9014 - acc: 0.6805Epoch 00006: val_acc improved from 0.66224 to 0.71981, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00006: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 249s 319ms/step - loss: 0.9014 - acc: 0.6805 - val_loss: 0.7956 - val_acc: 0.7198
Epoch 7/30
780/781 [============================>.] - ETA: 0s - loss: 0.8283 - acc: 0.7070Epoch 00007: val_acc improved from 0.71981 to 0.73510, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00007: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 249s 318ms/step - loss: 0.8282 - acc: 0.7070 - val_loss: 0.7489 - val_acc: 0.7351
Epoch 8/30
780/781 [============================>.] - ETA: 0s - loss: 0.7535 - acc: 0.7340Epoch 00008: val_acc improved from 0.73510 to 0.75533, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00008: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 244s 312ms/step - loss: 0.7534 - acc: 0.7341 - val_loss: 0.7005 - val_acc: 0.7553
Epoch 9/30
780/781 [============================>.] - ETA: 0s - loss: 0.6922 - acc: 0.7574Epoch 00009: val_acc improved from 0.75533 to 0.77033, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00009: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 250s 320ms/step - loss: 0.6920 - acc: 0.7575 - val_loss: 0.6518 - val_acc: 0.7703
Epoch 10/30
780/781 [============================>.] - ETA: 0s - loss: 0.6480 - acc: 0.7725Epoch 00010: val_acc improved from 0.77033 to 0.80304, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00010: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 277s 354ms/step - loss: 0.6479 - acc: 0.7725 - val_loss: 0.5640 - val_acc: 0.8030
Epoch 11/30
780/781 [============================>.] - ETA: 0s - loss: 0.6055 - acc: 0.7877Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 244s 312ms/step - loss: 0.6054 - acc: 0.7877 - val_loss: 0.5619 - val_acc: 0.8028
Epoch 12/30
780/781 [============================>.] - ETA: 0s - loss: 0.5654 - acc: 0.8015Epoch 00012: val_acc improved from 0.80304 to 0.80626, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00012: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 264s 339ms/step - loss: 0.5656 - acc: 0.8015 - val_loss: 0.5413 - val_acc: 0.8063
Epoch 13/30
780/781 [============================>.] - ETA: 0s - loss: 0.5364 - acc: 0.8120Epoch 00013: val_acc improved from 0.80626 to 0.81471, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00013: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 249s 319ms/step - loss: 0.5364 - acc: 0.8120 - val_loss: 0.5409 - val_acc: 0.8147
Epoch 14/30
780/781 [============================>.] - ETA: 0s - loss: 0.5162 - acc: 0.8196Epoch 00014: val_acc improved from 0.81471 to 0.82377, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00014: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 257s 330ms/step - loss: 0.5165 - acc: 0.8194 - val_loss: 0.5205 - val_acc: 0.8238
Epoch 15/30
780/781 [============================>.] - ETA: 0s - loss: 0.4879 - acc: 0.8286Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 292s 374ms/step - loss: 0.4875 - acc: 0.8287 - val_loss: 0.5437 - val_acc: 0.8170
Epoch 16/30
780/781 [============================>.] - ETA: 0s - loss: 0.4604 - acc: 0.8365Epoch 00016: val_acc improved from 0.82377 to 0.83867, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00016: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 255s 327ms/step - loss: 0.4605 - acc: 0.8365 - val_loss: 0.4673 - val_acc: 0.8387
Epoch 17/30
780/781 [============================>.] - ETA: 0s - loss: 0.4467 - acc: 0.8441Epoch 00017: val_acc improved from 0.83867 to 0.84098, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00017: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 250s 320ms/step - loss: 0.4465 - acc: 0.8442 - val_loss: 0.4741 - val_acc: 0.8410
Epoch 18/30
780/781 [============================>.] - ETA: 0s - loss: 0.4240 - acc: 0.8507Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 315s 404ms/step - loss: 0.4241 - acc: 0.8507 - val_loss: 0.5509 - val_acc: 0.8182
Epoch 19/30
780/781 [============================>.] - ETA: 0s - loss: 0.4066 - acc: 0.8558Epoch 00019: val_acc improved from 0.84098 to 0.84913, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00019: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 261s 335ms/step - loss: 0.4069 - acc: 0.8557 - val_loss: 0.4491 - val_acc: 0.8491
Epoch 20/30
780/781 [============================>.] - ETA: 0s - loss: 0.3908 - acc: 0.8625Epoch 00020: val_acc improved from 0.84913 to 0.85497, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00020: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 251s 321ms/step - loss: 0.3907 - acc: 0.8625 - val_loss: 0.4427 - val_acc: 0.8550
Epoch 21/30
780/781 [============================>.] - ETA: 0s - loss: 0.3793 - acc: 0.8673Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 248s 318ms/step - loss: 0.3792 - acc: 0.8673 - val_loss: 0.4322 - val_acc: 0.8526
Epoch 22/30
780/781 [============================>.] - ETA: 0s - loss: 0.3631 - acc: 0.8719Epoch 00022: val_acc improved from 0.85497 to 0.85628, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00022: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 250s 320ms/step - loss: 0.3631 - acc: 0.8719 - val_loss: 0.4435 - val_acc: 0.8563
Epoch 23/30
780/781 [============================>.] - ETA: 0s - loss: 0.3498 - acc: 0.8774Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 247s 316ms/step - loss: 0.3501 - acc: 0.8773 - val_loss: 0.5609 - val_acc: 0.8197
Epoch 24/30
780/781 [============================>.] - ETA: 0s - loss: 0.3361 - acc: 0.8811Epoch 00024: val_acc improved from 0.85628 to 0.86463, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00024: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 245s 314ms/step - loss: 0.3361 - acc: 0.8812 - val_loss: 0.4206 - val_acc: 0.8646
Epoch 25/30
780/781 [============================>.] - ETA: 0s - loss: 0.3255 - acc: 0.8857Epoch 00025: val_acc improved from 0.86463 to 0.88114, saving model to ./resnet/results/40_1/40_best.h5
Epoch 00025: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 252s 322ms/step - loss: 0.3257 - acc: 0.8857 - val_loss: 0.3683 - val_acc: 0.8811
Epoch 26/30
780/781 [============================>.] - ETA: 0s - loss: 0.3189 - acc: 0.8893Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 243s 311ms/step - loss: 0.3190 - acc: 0.8892 - val_loss: 0.5084 - val_acc: 0.8369
Epoch 27/30
780/781 [============================>.] - ETA: 0s - loss: 0.3017 - acc: 0.8953Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 246s 315ms/step - loss: 0.3017 - acc: 0.8953 - val_loss: 0.3946 - val_acc: 0.8714
Epoch 28/30
780/781 [============================>.] - ETA: 0s - loss: 0.2976 - acc: 0.8948Epoch 00028: val_acc did not improve
Epoch 00028: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 267s 342ms/step - loss: 0.2974 - acc: 0.8949 - val_loss: 0.4587 - val_acc: 0.8502
Epoch 29/30
780/781 [============================>.] - ETA: 0s - loss: 0.2859 - acc: 0.8999Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 291s 372ms/step - loss: 0.2858 - acc: 0.8999 - val_loss: 0.4031 - val_acc: 0.8690
Epoch 30/30
780/781 [============================>.] - ETA: 0s - loss: 0.2769 - acc: 0.9022Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/results/40_1/40.h5
781/781 [==============================] - 261s 334ms/step - loss: 0.2769 - acc: 0.9022 - val_loss: 0.4387 - val_acc: 0.8609
##### Training resnet30 #####
2017-11-20 15:13:48.138689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[2.8356072000968151, 0.1187900641025641]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 64)   2112        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 64)   4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 64)   256         res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 64)   0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 64)   0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   2080        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 64)   2112        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 64)   0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 64)   0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   2080        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 64)   2112        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 64)   0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 64)   0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 32)   2080        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 128)  8320        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 128)  512         res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 128)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 128)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 128)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 128)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 128)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 128)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 128)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 128)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 64)   8256        activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 64)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 128)  16512       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 128)  512         res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 128)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 128)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 64)   8256        activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 64)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 128)  0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 128)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 64)   8256        activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 64)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 128)  0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 128)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 64)   8256        activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 64)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 128)  0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 128)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 64)   8256        activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 64)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 128)  0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 128)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 64)   8256        activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 64)   36928       activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 64)   256         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 64)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 128)  8320        activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 128)  0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 128)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 128)    16512       activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 128)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 256)    33024       activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 256)    33024       activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 256)    1024        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 256)    0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 256)    0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 128)    32896       activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 128)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 256)    33024       activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 256)    0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 256)    0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 128)    32896       activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 128)    147584      activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 128)    512         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 128)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 256)    33024       activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 256)    0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 256)    0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 256)    0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 256)          0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           2570        flatten_1[0][0]
==================================================================================================
Total params: 1,147,338
Trainable params: 1,137,610
Non-trainable params: 9,728
__________________________________________________________________________________________________
Epoch 1/30
780/781 [============================>.] - ETA: 0s - loss: 1.7709 - acc: 0.3483Epoch 00001: val_acc improved from -inf to 0.46825, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00001: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 197s 252ms/step - loss: 1.7706 - acc: 0.3484 - val_loss: 1.4371 - val_acc: 0.4682
Epoch 2/30
780/781 [============================>.] - ETA: 0s - loss: 1.3542 - acc: 0.5061Epoch 00002: val_acc improved from 0.46825 to 0.56029, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00002: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 246ms/step - loss: 1.3544 - acc: 0.5060 - val_loss: 1.2274 - val_acc: 0.5603
Epoch 3/30
780/781 [============================>.] - ETA: 0s - loss: 1.1819 - acc: 0.5724Epoch 00003: val_acc improved from 0.56029 to 0.62329, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00003: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 246ms/step - loss: 1.1819 - acc: 0.5724 - val_loss: 1.0359 - val_acc: 0.6233
Epoch 4/30
780/781 [============================>.] - ETA: 0s - loss: 1.0558 - acc: 0.6216Epoch 00004: val_acc improved from 0.62329 to 0.66254, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00004: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 246ms/step - loss: 1.0559 - acc: 0.6215 - val_loss: 0.9528 - val_acc: 0.6625
Epoch 5/30
780/781 [============================>.] - ETA: 0s - loss: 0.9659 - acc: 0.6553Epoch 00005: val_acc improved from 0.66254 to 0.67945, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00005: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 245ms/step - loss: 0.9660 - acc: 0.6553 - val_loss: 0.8952 - val_acc: 0.6794
Epoch 6/30
780/781 [============================>.] - ETA: 0s - loss: 0.8772 - acc: 0.6891Epoch 00006: val_acc improved from 0.67945 to 0.73732, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00006: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 245ms/step - loss: 0.8768 - acc: 0.6892 - val_loss: 0.7544 - val_acc: 0.7373
Epoch 7/30
780/781 [============================>.] - ETA: 0s - loss: 0.8168 - acc: 0.7139Epoch 00007: val_acc improved from 0.73732 to 0.74044, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00007: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 193s 247ms/step - loss: 0.8167 - acc: 0.7140 - val_loss: 0.7430 - val_acc: 0.7404
Epoch 8/30
780/781 [============================>.] - ETA: 0s - loss: 0.7529 - acc: 0.7367Epoch 00008: val_acc improved from 0.74044 to 0.75936, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00008: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 246ms/step - loss: 0.7527 - acc: 0.7367 - val_loss: 0.6780 - val_acc: 0.7594
Epoch 9/30
780/781 [============================>.] - ETA: 0s - loss: 0.7016 - acc: 0.7550Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 245ms/step - loss: 0.7016 - acc: 0.7550 - val_loss: 0.7192 - val_acc: 0.7558
Epoch 10/30
780/781 [============================>.] - ETA: 0s - loss: 0.6550 - acc: 0.7729Epoch 00010: val_acc improved from 0.75936 to 0.77587, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00010: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 245ms/step - loss: 0.6551 - acc: 0.7729 - val_loss: 0.6362 - val_acc: 0.7759
Epoch 11/30
780/781 [============================>.] - ETA: 0s - loss: 0.6214 - acc: 0.7824Epoch 00011: val_acc improved from 0.77587 to 0.79016, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00011: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 193s 247ms/step - loss: 0.6213 - acc: 0.7824 - val_loss: 0.5987 - val_acc: 0.7902
Epoch 12/30
780/781 [============================>.] - ETA: 0s - loss: 0.5907 - acc: 0.7928Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 193s 247ms/step - loss: 0.5907 - acc: 0.7928 - val_loss: 0.5967 - val_acc: 0.7880
Epoch 13/30
780/781 [============================>.] - ETA: 0s - loss: 0.5614 - acc: 0.8015Epoch 00013: val_acc improved from 0.79016 to 0.81773, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00013: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 245ms/step - loss: 0.5613 - acc: 0.8016 - val_loss: 0.5304 - val_acc: 0.8177
Epoch 14/30
780/781 [============================>.] - ETA: 0s - loss: 0.5379 - acc: 0.8135Epoch 00014: val_acc improved from 0.81773 to 0.82387, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00014: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 246ms/step - loss: 0.5377 - acc: 0.8135 - val_loss: 0.5192 - val_acc: 0.8239
Epoch 15/30
780/781 [============================>.] - ETA: 0s - loss: 0.5125 - acc: 0.8208Epoch 00015: val_acc improved from 0.82387 to 0.83223, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00015: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 245ms/step - loss: 0.5125 - acc: 0.8208 - val_loss: 0.4910 - val_acc: 0.8322
Epoch 16/30
780/781 [============================>.] - ETA: 0s - loss: 0.4952 - acc: 0.8271Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 245ms/step - loss: 0.4952 - acc: 0.8271 - val_loss: 0.5069 - val_acc: 0.8317
Epoch 17/30
780/781 [============================>.] - ETA: 0s - loss: 0.4728 - acc: 0.8326Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 245ms/step - loss: 0.4727 - acc: 0.8327 - val_loss: 0.5208 - val_acc: 0.8196
Epoch 18/30
780/781 [============================>.] - ETA: 0s - loss: 0.4633 - acc: 0.8376Epoch 00018: val_acc improved from 0.83223 to 0.84581, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00018: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 193s 247ms/step - loss: 0.4633 - acc: 0.8376 - val_loss: 0.4435 - val_acc: 0.8458
Epoch 19/30
780/781 [============================>.] - ETA: 0s - loss: 0.4440 - acc: 0.8457Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 246ms/step - loss: 0.4442 - acc: 0.8456 - val_loss: 0.4724 - val_acc: 0.8406
Epoch 20/30
780/781 [============================>.] - ETA: 0s - loss: 0.4298 - acc: 0.8486Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 193s 248ms/step - loss: 0.4301 - acc: 0.8485 - val_loss: 0.5675 - val_acc: 0.8156
Epoch 21/30
780/781 [============================>.] - ETA: 0s - loss: 0.4181 - acc: 0.8539Epoch 00021: val_acc improved from 0.84581 to 0.85457, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00021: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 193s 247ms/step - loss: 0.4181 - acc: 0.8539 - val_loss: 0.4280 - val_acc: 0.8546
Epoch 22/30
780/781 [============================>.] - ETA: 0s - loss: 0.4044 - acc: 0.8598Epoch 00022: val_acc improved from 0.85457 to 0.86121, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00022: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 193s 247ms/step - loss: 0.4044 - acc: 0.8598 - val_loss: 0.4215 - val_acc: 0.8612
Epoch 23/30
780/781 [============================>.] - ETA: 0s - loss: 0.3917 - acc: 0.8623Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 190s 244ms/step - loss: 0.3916 - acc: 0.8623 - val_loss: 0.4204 - val_acc: 0.8550
Epoch 24/30
780/781 [============================>.] - ETA: 0s - loss: 0.3830 - acc: 0.8652Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 244ms/step - loss: 0.3831 - acc: 0.8651 - val_loss: 0.4874 - val_acc: 0.8428
Epoch 25/30
780/781 [============================>.] - ETA: 0s - loss: 0.3714 - acc: 0.8699Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 245ms/step - loss: 0.3714 - acc: 0.8700 - val_loss: 0.4548 - val_acc: 0.8464
Epoch 26/30
780/781 [============================>.] - ETA: 0s - loss: 0.3590 - acc: 0.8736Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 244ms/step - loss: 0.3590 - acc: 0.8736 - val_loss: 0.4147 - val_acc: 0.8592
Epoch 27/30
780/781 [============================>.] - ETA: 0s - loss: 0.3484 - acc: 0.8787Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 244ms/step - loss: 0.3484 - acc: 0.8787 - val_loss: 0.4251 - val_acc: 0.8554
Epoch 28/30
780/781 [============================>.] - ETA: 0s - loss: 0.3477 - acc: 0.8777Epoch 00028: val_acc improved from 0.86121 to 0.87037, saving model to ./resnet/results/30_1/30_best.h5
Epoch 00028: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 192s 246ms/step - loss: 0.3476 - acc: 0.8777 - val_loss: 0.3943 - val_acc: 0.8704
Epoch 29/30
780/781 [============================>.] - ETA: 0s - loss: 0.3382 - acc: 0.8820Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 245ms/step - loss: 0.3383 - acc: 0.8820 - val_loss: 0.4252 - val_acc: 0.8606
Epoch 30/30
780/781 [============================>.] - ETA: 0s - loss: 0.3258 - acc: 0.8865Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/results/30_1/30.h5
781/781 [==============================] - 191s 245ms/step - loss: 0.3260 - acc: 0.8864 - val_loss: 0.4389 - val_acc: 0.8534
##### Training resnet20 #####
2017-11-20 16:51:37.710413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[5.8387254048616457, 0.14493189102564102]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 64)   2112        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 64)   4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 64)   256         res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 64)   0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 64)   0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   2080        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 64)   2112        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 64)   0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 64)   0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   2080        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 32)   9248        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 64)   2112        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 64)   0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 64)   0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 32)   2080        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 128)  8320        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 128)  512         res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 128)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 128)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 128)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 128)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 128)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 128)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 32)   9248        activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 128)  4224        activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 128)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 128)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 32)   0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 32)   9248        activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 32)   128         res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 32)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 128)  4224        activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 128)  16512       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 128)  512         res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 128)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 128)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 32)   0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 32)   9248        activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 32)   128         res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 32)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 128)  4224        activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 128)  0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 128)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 32)   0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 32)   9248        activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 32)   128         res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 32)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 128)  4224        activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 128)  0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 128)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 32)   0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 32)   9248        activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 32)   128         res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 32)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 128)  4224        activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 128)  0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 128)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 32)   0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 32)   9248        activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 32)   128         res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 32)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 128)  4224        activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 128)  0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 128)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 32)   0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 32)   9248        activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 32)   128         res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 32)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 128)  4224        activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 128)  0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 128)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 64)     8256        activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 64)     256         res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 64)     0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 64)     36928       activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 64)     256         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 64)     0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 256)    16640       activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 256)    33024       activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 256)    1024        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 256)    0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 256)    0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 64)     16448       activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 64)     256         res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 64)     0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 64)     36928       activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 64)     256         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 64)     0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 256)    16640       activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 256)    0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 256)    0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 64)     16448       activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 64)     256         res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 64)     0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 64)     36928       activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 64)     256         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 64)     0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 256)    16640       activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 256)    0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 256)    0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 256)    0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 256)          0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           2570        flatten_1[0][0]
==================================================================================================
Total params: 506,570
Trainable params: 498,378
Non-trainable params: 8,192
__________________________________________________________________________________________________
Epoch 1/30
780/781 [============================>.] - ETA: 0s - loss: 0.8478 - acc: 0.7015Epoch 00001: val_acc improved from -inf to 0.76753, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00001: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 194s 248ms/step - loss: 0.8473 - acc: 0.7017 - val_loss: 0.6645 - val_acc: 0.7675
Epoch 2/30
780/781 [============================>.] - ETA: 0s - loss: 0.6291 - acc: 0.7787Epoch 00002: val_acc improved from 0.76753 to 0.78110, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00002: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.6288 - acc: 0.7787 - val_loss: 0.6365 - val_acc: 0.7811
Epoch 3/30
780/781 [============================>.] - ETA: 0s - loss: 0.5678 - acc: 0.8015Epoch 00003: val_acc improved from 0.78110 to 0.80153, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00003: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.5679 - acc: 0.8014 - val_loss: 0.5864 - val_acc: 0.8015
Epoch 4/30
780/781 [============================>.] - ETA: 0s - loss: 0.5283 - acc: 0.8153Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.5281 - acc: 0.8154 - val_loss: 0.6405 - val_acc: 0.7843
Epoch 5/30
780/781 [============================>.] - ETA: 0s - loss: 0.4992 - acc: 0.8256Epoch 00005: val_acc improved from 0.80153 to 0.80395, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00005: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 240ms/step - loss: 0.4991 - acc: 0.8256 - val_loss: 0.5676 - val_acc: 0.8039
Epoch 6/30
780/781 [============================>.] - ETA: 0s - loss: 0.4802 - acc: 0.8310Epoch 00006: val_acc improved from 0.80395 to 0.82246, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00006: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 240ms/step - loss: 0.4802 - acc: 0.8310 - val_loss: 0.5254 - val_acc: 0.8225
Epoch 7/30
780/781 [============================>.] - ETA: 0s - loss: 0.4693 - acc: 0.8360Epoch 00007: val_acc did not improve
Epoch 00007: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.4694 - acc: 0.8360 - val_loss: 0.5414 - val_acc: 0.8213
Epoch 8/30
780/781 [============================>.] - ETA: 0s - loss: 0.4473 - acc: 0.8429Epoch 00008: val_acc improved from 0.82246 to 0.82750, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00008: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 241ms/step - loss: 0.4477 - acc: 0.8428 - val_loss: 0.4932 - val_acc: 0.8275
Epoch 9/30
780/781 [============================>.] - ETA: 0s - loss: 0.4346 - acc: 0.8486Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 241ms/step - loss: 0.4347 - acc: 0.8486 - val_loss: 0.5374 - val_acc: 0.8200
Epoch 10/30
780/781 [============================>.] - ETA: 0s - loss: 0.4257 - acc: 0.8509Epoch 00010: val_acc improved from 0.82750 to 0.84491, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00010: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 241ms/step - loss: 0.4256 - acc: 0.8509 - val_loss: 0.4703 - val_acc: 0.8449
Epoch 11/30
780/781 [============================>.] - ETA: 0s - loss: 0.4171 - acc: 0.8537Epoch 00011: val_acc improved from 0.84491 to 0.84974, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00011: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 189s 243ms/step - loss: 0.4168 - acc: 0.8537 - val_loss: 0.4355 - val_acc: 0.8497
Epoch 12/30
780/781 [============================>.] - ETA: 0s - loss: 0.4028 - acc: 0.8590Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 241ms/step - loss: 0.4030 - acc: 0.8589 - val_loss: 0.5470 - val_acc: 0.8222
Epoch 13/30
780/781 [============================>.] - ETA: 0s - loss: 0.4005 - acc: 0.8586Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 240ms/step - loss: 0.4006 - acc: 0.8585 - val_loss: 0.4397 - val_acc: 0.8449
Epoch 14/30
780/781 [============================>.] - ETA: 0s - loss: 0.3867 - acc: 0.8636Epoch 00014: val_acc improved from 0.84974 to 0.85246, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00014: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 241ms/step - loss: 0.3866 - acc: 0.8636 - val_loss: 0.4275 - val_acc: 0.8525
Epoch 15/30
780/781 [============================>.] - ETA: 0s - loss: 0.3854 - acc: 0.8650Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.3853 - acc: 0.8650 - val_loss: 0.4573 - val_acc: 0.8470
Epoch 16/30
780/781 [============================>.] - ETA: 0s - loss: 0.3712 - acc: 0.8699Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.3711 - acc: 0.8699 - val_loss: 0.5017 - val_acc: 0.8371
Epoch 17/30
780/781 [============================>.] - ETA: 0s - loss: 0.3725 - acc: 0.8686Epoch 00017: val_acc improved from 0.85246 to 0.86675, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00017: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 241ms/step - loss: 0.3722 - acc: 0.8687 - val_loss: 0.4084 - val_acc: 0.8667
Epoch 18/30
780/781 [============================>.] - ETA: 0s - loss: 0.3573 - acc: 0.8745Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.3576 - acc: 0.8743 - val_loss: 0.4903 - val_acc: 0.8430
Epoch 19/30
780/781 [============================>.] - ETA: 0s - loss: 0.3569 - acc: 0.8734Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 241ms/step - loss: 0.3572 - acc: 0.8734 - val_loss: 0.4583 - val_acc: 0.8465
Epoch 20/30
780/781 [============================>.] - ETA: 0s - loss: 0.3492 - acc: 0.8771Epoch 00020: val_acc improved from 0.86675 to 0.86896, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00020: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.3494 - acc: 0.8771 - val_loss: 0.3979 - val_acc: 0.8690
Epoch 21/30
780/781 [============================>.] - ETA: 0s - loss: 0.3386 - acc: 0.8823Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.3387 - acc: 0.8823 - val_loss: 0.4306 - val_acc: 0.8581
Epoch 22/30
780/781 [============================>.] - ETA: 0s - loss: 0.3302 - acc: 0.8839Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.3302 - acc: 0.8840 - val_loss: 0.4357 - val_acc: 0.8524
Epoch 23/30
780/781 [============================>.] - ETA: 0s - loss: 0.3301 - acc: 0.8845Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 239ms/step - loss: 0.3299 - acc: 0.8845 - val_loss: 0.4254 - val_acc: 0.8582
Epoch 24/30
780/781 [============================>.] - ETA: 0s - loss: 0.3261 - acc: 0.8858Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.3259 - acc: 0.8859 - val_loss: 0.4088 - val_acc: 0.8665
Epoch 25/30
780/781 [============================>.] - ETA: 0s - loss: 0.3203 - acc: 0.8875Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 240ms/step - loss: 0.3203 - acc: 0.8874 - val_loss: 0.4129 - val_acc: 0.8609
Epoch 26/30
780/781 [============================>.] - ETA: 0s - loss: 0.3152 - acc: 0.8887Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 239ms/step - loss: 0.3154 - acc: 0.8887 - val_loss: 0.4656 - val_acc: 0.8480
Epoch 27/30
780/781 [============================>.] - ETA: 0s - loss: 0.3111 - acc: 0.8900Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 239ms/step - loss: 0.3111 - acc: 0.8900 - val_loss: 0.4297 - val_acc: 0.8609
Epoch 28/30
780/781 [============================>.] - ETA: 0s - loss: 0.3066 - acc: 0.8916Epoch 00028: val_acc did not improve
Epoch 00028: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 240ms/step - loss: 0.3065 - acc: 0.8916 - val_loss: 0.5285 - val_acc: 0.8295
Epoch 29/30
780/781 [============================>.] - ETA: 0s - loss: 0.3009 - acc: 0.8941Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 187s 239ms/step - loss: 0.3009 - acc: 0.8942 - val_loss: 0.3925 - val_acc: 0.8662
Epoch 30/30
780/781 [============================>.] - ETA: 0s - loss: 0.3020 - acc: 0.8936Epoch 00030: val_acc improved from 0.86896 to 0.87581, saving model to ./resnet/results/20_1/20_best.h5
Epoch 00030: saving model to ./resnet/results/20_1/20.h5
781/781 [==============================] - 188s 241ms/step - loss: 0.3021 - acc: 0.8936 - val_loss: 0.3879 - val_acc: 0.8758

Process finished with exit code 0
/home/xiao/anaconda2/envs/tf/bin/python /home/xiao/projects/MSDNet/ResNet50.py
Using TensorFlow backend.
2017-11-20 20:31:43.112459: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-20 20:31:43.112476: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-20 20:31:43.112479: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-11-20 20:31:43.112482: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-20 20:31:43.112484: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-11-20 20:31:43.341006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.6705
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 10.00GiB
2017-11-20 20:31:43.341026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2017-11-20 20:31:43.341030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2017-11-20 20:31:43.341036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
##### Training resnet10 #####
2017-11-20 20:31:45.547513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
2017-11-20 20:32:12.678408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[12.284277053979727, 0.08153044871794872]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 64) 9472        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 64) 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 32)   2080        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 32)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 16)   4624        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 16)   64          res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 16)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 64)   1088        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 64)   4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 64)   256         res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 64)   0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 64)   0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 32)   2080        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 32)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 16)   4624        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 16)   64          res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 16)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 64)   1088        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 64)   0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 64)   0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 32)   2080        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 32)   128         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 32)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 16)   4624        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 16)   64          res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 16)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 64)   1088        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 64)   0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 64)   0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 32)   2080        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 32)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 16)   4624        activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 16)   64          res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 16)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 128)  2176        activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 128)  8320        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 128)  512         res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 128)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 128)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 32)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 16)   4624        activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 16)   64          res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 16)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 128)  2176        activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 128)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 128)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 32)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 16)   4624        activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 16)   64          res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 16)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 128)  2176        activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 128)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 128)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 32)   4128        activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 32)   128         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 32)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 16)   4624        activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 16)   64          res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 16)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 128)  2176        activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 128)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 128)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 32)   0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 16)   4624        activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 16)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 128)  16512       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 128)  512         res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 128)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 128)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 32)   0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 16)   4624        activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 16)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 128)  0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 128)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 32)   0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 16)   4624        activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 16)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 128)  0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 128)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 32)   0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 16)   4624        activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 16)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 128)  0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 128)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 32)   0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 16)   4624        activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 16)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 128)  0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 128)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 32)   4128        activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 32)   128         res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 32)   0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 16)   4624        activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 16)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 128)  0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 128)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 64)     8256        activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 64)     256         res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 64)     0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 32)     18464       activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 32)     128         res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 32)     0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 256)    8448        activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 256)    33024       activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 256)    1024        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 256)    0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 256)    0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 64)     16448       activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 64)     256         res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 64)     0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 32)     18464       activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 32)     128         res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 32)     0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 256)    8448        activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 256)    0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 256)    0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 64)     16448       activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 64)     256         res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 64)     0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 32)     18464       activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 32)     128         res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 32)     0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 256)    8448        activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 256)    0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 256)    0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 256)    0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 256)          0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           2570        flatten_1[0][0]
==================================================================================================
Total params: 341,722
Trainable params: 334,138
Non-trainable params: 7,584
__________________________________________________________________________________________________
Epoch 1/40
780/781 [============================>.] - ETA: 0s - loss: 0.8765 - acc: 0.6962Epoch 00001: val_acc improved from -inf to 0.73758, saving model to ./resnet/results/10_1/10_best.h5
Epoch 00001: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 186s 238ms/step - loss: 0.8762 - acc: 0.6962 - val_loss: 0.7677 - val_acc: 0.7376
Epoch 2/40
780/781 [============================>.] - ETA: 0s - loss: 0.6150 - acc: 0.7832Epoch 00002: val_acc improved from 0.73758 to 0.78221, saving model to ./resnet/results/10_1/10_best.h5
Epoch 00002: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 182s 233ms/step - loss: 0.6150 - acc: 0.7832 - val_loss: 0.6594 - val_acc: 0.7822
Epoch 3/40
780/781 [============================>.] - ETA: 0s - loss: 0.5466 - acc: 0.8081Epoch 00003: val_acc improved from 0.78221 to 0.81934, saving model to ./resnet/results/10_1/10_best.h5
Epoch 00003: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 182s 233ms/step - loss: 0.5465 - acc: 0.8082 - val_loss: 0.5322 - val_acc: 0.8193
Epoch 4/40
780/781 [============================>.] - ETA: 0s - loss: 0.5158 - acc: 0.8178Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 181s 232ms/step - loss: 0.5159 - acc: 0.8179 - val_loss: 0.5534 - val_acc: 0.8154
Epoch 5/40
780/781 [============================>.] - ETA: 0s - loss: 0.4841 - acc: 0.8301Epoch 00005: val_acc improved from 0.81934 to 0.82921, saving model to ./resnet/results/10_1/10_best.h5
Epoch 00005: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 182s 233ms/step - loss: 0.4842 - acc: 0.8301 - val_loss: 0.5019 - val_acc: 0.8292
Epoch 6/40
780/781 [============================>.] - ETA: 0s - loss: 0.4669 - acc: 0.8365Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 182s 233ms/step - loss: 0.4671 - acc: 0.8364 - val_loss: 0.5267 - val_acc: 0.8269
Epoch 7/40
780/781 [============================>.] - ETA: 0s - loss: 0.4472 - acc: 0.8423Epoch 00007: val_acc did not improve
Epoch 00007: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 182s 233ms/step - loss: 0.4472 - acc: 0.8422 - val_loss: 0.5076 - val_acc: 0.8271
Epoch 8/40
780/781 [============================>.] - ETA: 0s - loss: 0.4391 - acc: 0.8479Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 182s 233ms/step - loss: 0.4390 - acc: 0.8479 - val_loss: 0.5466 - val_acc: 0.8213
Epoch 9/40
780/781 [============================>.] - ETA: 0s - loss: 0.4251 - acc: 0.8511Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 182s 234ms/step - loss: 0.4249 - acc: 0.8512 - val_loss: 0.5412 - val_acc: 0.8224
Epoch 10/40
780/781 [============================>.] - ETA: 0s - loss: 0.4103 - acc: 0.8573Epoch 00010: val_acc improved from 0.82921 to 0.85296, saving model to ./resnet/results/10_1/10_best.h5
Epoch 00010: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 178s 228ms/step - loss: 0.4104 - acc: 0.8572 - val_loss: 0.4335 - val_acc: 0.8530
Epoch 11/40
780/781 [============================>.] - ETA: 0s - loss: 0.4041 - acc: 0.8602Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 181s 232ms/step - loss: 0.4042 - acc: 0.8602 - val_loss: 0.5744 - val_acc: 0.8104
Epoch 12/40
780/781 [============================>.] - ETA: 0s - loss: 0.4055 - acc: 0.8569Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 180s 230ms/step - loss: 0.4056 - acc: 0.8569 - val_loss: 0.4639 - val_acc: 0.8430
Epoch 13/40
780/781 [============================>.] - ETA: 0s - loss: 0.3973 - acc: 0.8618Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.3973 - acc: 0.8618 - val_loss: 0.6656 - val_acc: 0.7869
Epoch 14/40
780/781 [============================>.] - ETA: 0s - loss: 0.3840 - acc: 0.8654Epoch 00014: val_acc did not improve
Epoch 00014: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 181s 231ms/step - loss: 0.3839 - acc: 0.8655 - val_loss: 0.4709 - val_acc: 0.8483
Epoch 15/40
780/781 [============================>.] - ETA: 0s - loss: 0.3764 - acc: 0.8677Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 183s 234ms/step - loss: 0.3765 - acc: 0.8678 - val_loss: 0.5075 - val_acc: 0.8340
Epoch 16/40
780/781 [============================>.] - ETA: 0s - loss: 0.3703 - acc: 0.8693Epoch 00016: val_acc improved from 0.85296 to 0.85709, saving model to ./resnet/results/10_1/10_best.h5
Epoch 00016: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 183s 235ms/step - loss: 0.3702 - acc: 0.8693 - val_loss: 0.4349 - val_acc: 0.8571
Epoch 17/40
780/781 [============================>.] - ETA: 0s - loss: 0.3710 - acc: 0.8699Epoch 00017: val_acc did not improve
Epoch 00017: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 183s 235ms/step - loss: 0.3710 - acc: 0.8699 - val_loss: 0.4975 - val_acc: 0.8380
Epoch 18/40
780/781 [============================>.] - ETA: 0s - loss: 0.3568 - acc: 0.8742Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 183s 234ms/step - loss: 0.3567 - acc: 0.8743 - val_loss: 0.4862 - val_acc: 0.8410
Epoch 19/40
780/781 [============================>.] - ETA: 0s - loss: 0.3559 - acc: 0.8750Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 183s 234ms/step - loss: 0.3562 - acc: 0.8749 - val_loss: 0.4528 - val_acc: 0.8489
Epoch 20/40
780/781 [============================>.] - ETA: 0s - loss: 0.3473 - acc: 0.8772Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.3473 - acc: 0.8772 - val_loss: 0.5678 - val_acc: 0.8193
Epoch 21/40
780/781 [============================>.] - ETA: 0s - loss: 0.3461 - acc: 0.8791Epoch 00021: val_acc improved from 0.85709 to 0.85990, saving model to ./resnet/results/10_1/10_best.h5
Epoch 00021: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 178s 228ms/step - loss: 0.3460 - acc: 0.8791 - val_loss: 0.4180 - val_acc: 0.8599
Epoch 22/40
780/781 [============================>.] - ETA: 0s - loss: 0.3416 - acc: 0.8803Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.3416 - acc: 0.8803 - val_loss: 0.4925 - val_acc: 0.8348
Epoch 23/40
780/781 [============================>.] - ETA: 0s - loss: 0.3364 - acc: 0.8825Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.3362 - acc: 0.8825 - val_loss: 0.5054 - val_acc: 0.8331
Epoch 24/40
780/781 [============================>.] - ETA: 0s - loss: 0.3343 - acc: 0.8837Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.3344 - acc: 0.8837 - val_loss: 0.6807 - val_acc: 0.7962
Epoch 25/40
780/781 [============================>.] - ETA: 0s - loss: 0.3229 - acc: 0.8858Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 178s 228ms/step - loss: 0.3229 - acc: 0.8858 - val_loss: 0.4956 - val_acc: 0.8347
Epoch 26/40
780/781 [============================>.] - ETA: 0s - loss: 0.3261 - acc: 0.8845Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.3263 - acc: 0.8845 - val_loss: 0.4749 - val_acc: 0.8444
Epoch 27/40
780/781 [============================>.] - ETA: 0s - loss: 0.3213 - acc: 0.8866Epoch 00027: val_acc improved from 0.85990 to 0.86775, saving model to ./resnet/results/10_1/10_best.h5
Epoch 00027: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 178s 228ms/step - loss: 0.3213 - acc: 0.8866 - val_loss: 0.4183 - val_acc: 0.8678
Epoch 28/40
780/781 [============================>.] - ETA: 0s - loss: 0.3144 - acc: 0.8880Epoch 00028: val_acc did not improve
Epoch 00028: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 178s 227ms/step - loss: 0.3143 - acc: 0.8881 - val_loss: 0.5532 - val_acc: 0.8249
Epoch 29/40
780/781 [============================>.] - ETA: 0s - loss: 0.3159 - acc: 0.8890Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 226ms/step - loss: 0.3157 - acc: 0.8890 - val_loss: 0.6201 - val_acc: 0.8015
Epoch 30/40
780/781 [============================>.] - ETA: 0s - loss: 0.3143 - acc: 0.8889Epoch 00030: val_acc did not improve
Epoch 00030: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 226ms/step - loss: 0.3143 - acc: 0.8889 - val_loss: 0.4209 - val_acc: 0.8610
Epoch 31/40
780/781 [============================>.] - ETA: 0s - loss: 0.3053 - acc: 0.8920Epoch 00031: val_acc did not improve
Epoch 00031: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 226ms/step - loss: 0.3052 - acc: 0.8920 - val_loss: 0.4051 - val_acc: 0.8667
Epoch 32/40
780/781 [============================>.] - ETA: 0s - loss: 0.3011 - acc: 0.8936Epoch 00032: val_acc did not improve
Epoch 00032: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 226ms/step - loss: 0.3011 - acc: 0.8937 - val_loss: 0.4353 - val_acc: 0.8626
Epoch 33/40
780/781 [============================>.] - ETA: 0s - loss: 0.3020 - acc: 0.8926Epoch 00033: val_acc did not improve
Epoch 00033: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 176s 226ms/step - loss: 0.3024 - acc: 0.8925 - val_loss: 0.4088 - val_acc: 0.8651
Epoch 34/40
780/781 [============================>.] - ETA: 0s - loss: 0.2994 - acc: 0.8936Epoch 00034: val_acc did not improve
Epoch 00034: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.2998 - acc: 0.8935 - val_loss: 0.4127 - val_acc: 0.8599
Epoch 35/40
780/781 [============================>.] - ETA: 0s - loss: 0.2939 - acc: 0.8952Epoch 00035: val_acc did not improve
Epoch 00035: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.2937 - acc: 0.8952 - val_loss: 0.4235 - val_acc: 0.8593
Epoch 36/40
780/781 [============================>.] - ETA: 0s - loss: 0.2891 - acc: 0.8988Epoch 00036: val_acc did not improve
Epoch 00036: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 178s 228ms/step - loss: 0.2892 - acc: 0.8988 - val_loss: 0.5481 - val_acc: 0.8257
Epoch 37/40
780/781 [============================>.] - ETA: 0s - loss: 0.2879 - acc: 0.8981Epoch 00037: val_acc improved from 0.86775 to 0.87862, saving model to ./resnet/results/10_1/10_best.h5
Epoch 00037: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.2881 - acc: 0.8980 - val_loss: 0.3852 - val_acc: 0.8786
Epoch 38/40
780/781 [============================>.] - ETA: 0s - loss: 0.2892 - acc: 0.8983Epoch 00038: val_acc did not improve
Epoch 00038: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.2891 - acc: 0.8983 - val_loss: 0.5497 - val_acc: 0.8342
Epoch 39/40
780/781 [============================>.] - ETA: 0s - loss: 0.2830 - acc: 0.8988Epoch 00039: val_acc did not improve
Epoch 00039: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 176s 226ms/step - loss: 0.2830 - acc: 0.8988 - val_loss: 0.3760 - val_acc: 0.8759
Epoch 40/40
780/781 [============================>.] - ETA: 0s - loss: 0.2794 - acc: 0.9016Epoch 00040: val_acc did not improve
Epoch 00040: saving model to ./resnet/results/10_1/10.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.2795 - acc: 0.9016 - val_loss: 0.4238 - val_acc: 0.8622

/home/xiao/anaconda2/envs/tf/bin/python /home/xiao/projects/MSDNet/ResNet50.py
Using TensorFlow backend.
2017-11-21 10:46:37.400400: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 10:46:37.400422: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 10:46:37.400426: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 10:46:37.400429: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 10:46:37.400432: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 10:46:37.673492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.6705
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 10.02GiB
2017-11-21 10:46:37.673514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2017-11-21 10:46:37.673519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2017-11-21 10:46:37.673529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
##### Training resnetb0 #####
2017-11-21 10:46:40.096801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
2017-11-21 10:47:08.151009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[11.684295134666639, 0.10086137820512821]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 32) 4736        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 32) 128         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 32) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 32)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 16)   528         max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 16)   64          res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 16)   0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 16)   2320        activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 16)   64          res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 16)   0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 64)   1088        activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 64)   2112        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 64)   256         res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 64)   0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 64)   0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 16)   1040        activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 16)   64          res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 16)   0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 16)   2320        activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 16)   64          res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 16)   0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 64)   1088        activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 64)   0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 64)   0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 16)   1040        activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 16)   64          res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 16)   0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 16)   2320        activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 16)   64          res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 16)   0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 64)   1088        activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 64)   0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 64)   0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 16)   1040        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 16)   64          res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 16)   0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 16)   2320        activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 16)   64          res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 16)   0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 128)  2176        activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 128)  8320        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 128)  512         res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 128)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 128)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 16)   2064        activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 16)   64          res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 16)   0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 16)   2320        activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 16)   64          res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 16)   0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 128)  2176        activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 128)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 128)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 16)   2064        activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 16)   64          res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 16)   0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 16)   2320        activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 16)   64          res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 16)   0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 128)  2176        activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 128)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 128)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 16)   2064        activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 16)   64          res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 16)   0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 16)   2320        activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 16)   64          res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 16)   0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 128)  2176        activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 128)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 128)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 16)   2064        activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 16)   64          res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 16)   0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 16)   2320        activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 16)   0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 128)  16512       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 128)  512         res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 128)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 128)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 16)   2064        activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 16)   64          res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 16)   0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 16)   2320        activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 16)   0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 128)  0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 128)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 16)   2064        activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 16)   64          res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 16)   0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 16)   2320        activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 16)   0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 128)  0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 128)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 16)   2064        activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 16)   64          res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 16)   0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 16)   2320        activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 16)   0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 128)  0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 128)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 16)   2064        activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 16)   64          res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 16)   0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 16)   2320        activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 16)   0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 128)  0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 128)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 16)   2064        activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 16)   64          res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 16)   0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 16)   2320        activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 16)   64          res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 16)   0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 128)  2176        activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 128)  0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 128)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 16)     2064        activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 16)     64          res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 16)     0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 16)     2320        activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 16)     64          res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 16)     0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 256)    4352        activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 256)    33024       activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 256)    1024        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 256)    0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 256)    0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 16)     4112        activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 16)     64          res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 16)     0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 16)     2320        activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 16)     64          res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 16)     0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 256)    4352        activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 256)    0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 256)    0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 16)     4112        activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 16)     64          res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 16)     0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 16)     2320        activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 16)     64          res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 16)     0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 256)    4352        activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 256)    0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 256)    0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 256)    0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 256)          0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           2570        flatten_1[0][0]
==================================================================================================
Total params: 188,426
Trainable params: 181,706
Non-trainable params: 6,720
__________________________________________________________________________________________________
Epoch 1/40
780/781 [============================>.] - ETA: 0s - loss: 0.9046 - acc: 0.6897Epoch 00001: val_acc improved from -inf to 0.79427, saving model to ./resnet/results/b0_1/b0_best.h5
Epoch 00001: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 162s 207ms/step - loss: 0.9044 - acc: 0.6897 - val_loss: 0.6006 - val_acc: 0.7943
Epoch 2/40
780/781 [============================>.] - ETA: 0s - loss: 0.5717 - acc: 0.8002Epoch 00002: val_acc did not improve
Epoch 00002: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 201s 258ms/step - loss: 0.5719 - acc: 0.8001 - val_loss: 0.6387 - val_acc: 0.7846
Epoch 3/40
780/781 [============================>.] - ETA: 0s - loss: 0.5088 - acc: 0.8229Epoch 00003: val_acc improved from 0.79427 to 0.83927, saving model to ./resnet/results/b0_1/b0_best.h5
Epoch 00003: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 193s 247ms/step - loss: 0.5087 - acc: 0.8229 - val_loss: 0.4759 - val_acc: 0.8393
Epoch 4/40
780/781 [============================>.] - ETA: 0s - loss: 0.4791 - acc: 0.8313Epoch 00004: val_acc did not improve
Epoch 00004: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 169s 217ms/step - loss: 0.4791 - acc: 0.8313 - val_loss: 0.4833 - val_acc: 0.8333
Epoch 5/40
780/781 [============================>.] - ETA: 0s - loss: 0.4631 - acc: 0.8375Epoch 00005: val_acc did not improve
Epoch 00005: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 159s 204ms/step - loss: 0.4628 - acc: 0.8376 - val_loss: 0.6106 - val_acc: 0.7908
Epoch 6/40
780/781 [============================>.] - ETA: 0s - loss: 0.4449 - acc: 0.8453Epoch 00006: val_acc did not improve
Epoch 00006: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 152s 194ms/step - loss: 0.4450 - acc: 0.8453 - val_loss: 0.5232 - val_acc: 0.8214
Epoch 7/40
780/781 [============================>.] - ETA: 0s - loss: 0.4320 - acc: 0.8483Epoch 00007: val_acc improved from 0.83927 to 0.85125, saving model to ./resnet/results/b0_1/b0_best.h5
Epoch 00007: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 157s 201ms/step - loss: 0.4319 - acc: 0.8483 - val_loss: 0.4352 - val_acc: 0.8512
Epoch 8/40
780/781 [============================>.] - ETA: 0s - loss: 0.4217 - acc: 0.8529Epoch 00008: val_acc did not improve
Epoch 00008: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 151s 193ms/step - loss: 0.4216 - acc: 0.8530 - val_loss: 0.4644 - val_acc: 0.8434
Epoch 9/40
780/781 [============================>.] - ETA: 0s - loss: 0.4159 - acc: 0.8540Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 149s 191ms/step - loss: 0.4158 - acc: 0.8541 - val_loss: 0.4734 - val_acc: 0.8404
Epoch 10/40
780/781 [============================>.] - ETA: 0s - loss: 0.4061 - acc: 0.8574Epoch 00010: val_acc improved from 0.85125 to 0.85175, saving model to ./resnet/results/b0_1/b0_best.h5
Epoch 00010: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 152s 195ms/step - loss: 0.4062 - acc: 0.8574 - val_loss: 0.4403 - val_acc: 0.8518
Epoch 11/40
780/781 [============================>.] - ETA: 0s - loss: 0.3969 - acc: 0.8598Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 149s 191ms/step - loss: 0.3968 - acc: 0.8598 - val_loss: 0.4775 - val_acc: 0.8439
Epoch 12/40
780/781 [============================>.] - ETA: 0s - loss: 0.3955 - acc: 0.8611Epoch 00012: val_acc did not improve
Epoch 00012: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 382s 489ms/step - loss: 0.3955 - acc: 0.8611 - val_loss: 0.4620 - val_acc: 0.8427
Epoch 13/40
780/781 [============================>.] - ETA: 0s - loss: 0.3891 - acc: 0.8634Epoch 00013: val_acc improved from 0.85175 to 0.85517, saving model to ./resnet/results/b0_1/b0_best.h5
Epoch 00013: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 179s 230ms/step - loss: 0.3890 - acc: 0.8634 - val_loss: 0.4308 - val_acc: 0.8552
Epoch 14/40
780/781 [============================>.] - ETA: 0s - loss: 0.3842 - acc: 0.8666Epoch 00014: val_acc improved from 0.85517 to 0.85870, saving model to ./resnet/results/b0_1/b0_best.h5
Epoch 00014: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 176s 225ms/step - loss: 0.3841 - acc: 0.8667 - val_loss: 0.4278 - val_acc: 0.8587
Epoch 15/40
780/781 [============================>.] - ETA: 0s - loss: 0.3819 - acc: 0.8676Epoch 00015: val_acc did not improve
Epoch 00015: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 315s 404ms/step - loss: 0.3819 - acc: 0.8676 - val_loss: 0.4249 - val_acc: 0.8587
Epoch 16/40
780/781 [============================>.] - ETA: 0s - loss: 0.3756 - acc: 0.8682Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 185s 236ms/step - loss: 0.3758 - acc: 0.8683 - val_loss: 0.4287 - val_acc: 0.8577
Epoch 17/40
780/781 [============================>.] - ETA: 0s - loss: 0.3722 - acc: 0.8698Epoch 00017: val_acc improved from 0.85870 to 0.86433, saving model to ./resnet/results/b0_1/b0_best.h5
Epoch 00017: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 175s 224ms/step - loss: 0.3722 - acc: 0.8697 - val_loss: 0.4169 - val_acc: 0.8643
Epoch 18/40
780/781 [============================>.] - ETA: 0s - loss: 0.3700 - acc: 0.8712Epoch 00018: val_acc did not improve
Epoch 00018: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 185s 236ms/step - loss: 0.3701 - acc: 0.8712 - val_loss: 0.4520 - val_acc: 0.8503
Epoch 19/40
780/781 [============================>.] - ETA: 0s - loss: 0.3638 - acc: 0.8716Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 173s 222ms/step - loss: 0.3636 - acc: 0.8716 - val_loss: 0.4542 - val_acc: 0.8451
Epoch 20/40
780/781 [============================>.] - ETA: 0s - loss: 0.3646 - acc: 0.8729Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 158s 202ms/step - loss: 0.3644 - acc: 0.8730 - val_loss: 0.4690 - val_acc: 0.8445
Epoch 21/40
780/781 [============================>.] - ETA: 0s - loss: 0.3572 - acc: 0.8750Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 155s 198ms/step - loss: 0.3572 - acc: 0.8751 - val_loss: 0.4714 - val_acc: 0.8485
Epoch 22/40
780/781 [============================>.] - ETA: 0s - loss: 0.3542 - acc: 0.8768Epoch 00022: val_acc did not improve
Epoch 00022: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 175s 224ms/step - loss: 0.3544 - acc: 0.8768 - val_loss: 0.4619 - val_acc: 0.8484
Epoch 23/40
780/781 [============================>.] - ETA: 0s - loss: 0.3509 - acc: 0.8762Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 153s 196ms/step - loss: 0.3508 - acc: 0.8762 - val_loss: 0.4408 - val_acc: 0.8582
Epoch 24/40
780/781 [============================>.] - ETA: 0s - loss: 0.3483 - acc: 0.8774Epoch 00024: val_acc improved from 0.86433 to 0.86604, saving model to ./resnet/results/b0_1/b0_best.h5
Epoch 00024: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 157s 201ms/step - loss: 0.3482 - acc: 0.8775 - val_loss: 0.4100 - val_acc: 0.8660
Epoch 25/40
780/781 [============================>.] - ETA: 0s - loss: 0.3429 - acc: 0.8792Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 172s 220ms/step - loss: 0.3429 - acc: 0.8792 - val_loss: 0.4252 - val_acc: 0.8607
Epoch 26/40
780/781 [============================>.] - ETA: 0s - loss: 0.3399 - acc: 0.8811Epoch 00026: val_acc did not improve
Epoch 00026: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 154s 197ms/step - loss: 0.3398 - acc: 0.8811 - val_loss: 0.4164 - val_acc: 0.8657
Epoch 27/40
780/781 [============================>.] - ETA: 0s - loss: 0.3409 - acc: 0.8807Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 168s 215ms/step - loss: 0.3408 - acc: 0.8807 - val_loss: 0.4006 - val_acc: 0.8656
Epoch 28/40
780/781 [============================>.] - ETA: 0s - loss: 0.3386 - acc: 0.8809Epoch 00028: val_acc did not improve
Epoch 00028: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 173s 222ms/step - loss: 0.3386 - acc: 0.8809 - val_loss: 0.4030 - val_acc: 0.8654
Epoch 29/40
780/781 [============================>.] - ETA: 0s - loss: 0.3374 - acc: 0.8840Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 159s 203ms/step - loss: 0.3374 - acc: 0.8840 - val_loss: 0.4096 - val_acc: 0.8599
Epoch 30/40
780/781 [============================>.] - ETA: 0s - loss: 0.3322 - acc: 0.8840Epoch 00030: val_acc improved from 0.86604 to 0.87017, saving model to ./resnet/results/b0_1/b0_best.h5
Epoch 00030: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 177s 227ms/step - loss: 0.3320 - acc: 0.8840 - val_loss: 0.3911 - val_acc: 0.8702
Epoch 31/40
780/781 [============================>.] - ETA: 0s - loss: 0.3301 - acc: 0.8834Epoch 00031: val_acc did not improve
Epoch 00031: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 170s 218ms/step - loss: 0.3300 - acc: 0.8834 - val_loss: 0.4221 - val_acc: 0.8597
Epoch 32/40
780/781 [============================>.] - ETA: 0s - loss: 0.3315 - acc: 0.8827Epoch 00032: val_acc did not improve
Epoch 00032: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 162s 207ms/step - loss: 0.3314 - acc: 0.8827 - val_loss: 0.4296 - val_acc: 0.8618
Epoch 33/40
780/781 [============================>.] - ETA: 0s - loss: 0.3240 - acc: 0.8859Epoch 00033: val_acc did not improve
Epoch 00033: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 162s 207ms/step - loss: 0.3242 - acc: 0.8858 - val_loss: 0.4244 - val_acc: 0.8591
Epoch 34/40
780/781 [============================>.] - ETA: 0s - loss: 0.3251 - acc: 0.8853Epoch 00034: val_acc did not improve
Epoch 00034: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 153s 196ms/step - loss: 0.3253 - acc: 0.8853 - val_loss: 0.5602 - val_acc: 0.8219
Epoch 35/40
780/781 [============================>.] - ETA: 0s - loss: 0.3223 - acc: 0.8860Epoch 00035: val_acc did not improve
Epoch 00035: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 152s 195ms/step - loss: 0.3222 - acc: 0.8860 - val_loss: 0.4026 - val_acc: 0.8690
Epoch 36/40
780/781 [============================>.] - ETA: 0s - loss: 0.3166 - acc: 0.8887Epoch 00036: val_acc did not improve
Epoch 00036: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 152s 195ms/step - loss: 0.3165 - acc: 0.8887 - val_loss: 0.3997 - val_acc: 0.8685
Epoch 37/40
780/781 [============================>.] - ETA: 0s - loss: 0.3175 - acc: 0.8883Epoch 00037: val_acc did not improve
Epoch 00037: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 154s 197ms/step - loss: 0.3174 - acc: 0.8883 - val_loss: 0.4070 - val_acc: 0.8683
Epoch 38/40
780/781 [============================>.] - ETA: 0s - loss: 0.3182 - acc: 0.8885Epoch 00038: val_acc did not improve
Epoch 00038: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 159s 204ms/step - loss: 0.3182 - acc: 0.8885 - val_loss: 0.4292 - val_acc: 0.8585
Epoch 39/40
780/781 [============================>.] - ETA: 0s - loss: 0.3170 - acc: 0.8883Epoch 00039: val_acc did not improve
Epoch 00039: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 153s 196ms/step - loss: 0.3169 - acc: 0.8883 - val_loss: 0.4034 - val_acc: 0.8676
Epoch 40/40
780/781 [============================>.] - ETA: 0s - loss: 0.3083 - acc: 0.8912Epoch 00040: val_acc did not improve
Epoch 00040: saving model to ./resnet/results/b0_1/b0.h5
781/781 [==============================] - 158s 203ms/step - loss: 0.3081 - acc: 0.8913 - val_loss: 0.4503 - val_acc: 0.8546

/home/xiao/anaconda2/envs/tf/bin/python /home/xiao/projects/MSDNet/ResNet50.py
Using TensorFlow backend.
2017-11-21 17:57:12.596090: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 17:57:12.596110: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 17:57:12.596114: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 17:57:12.596117: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 17:57:12.596120: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-11-21 17:57:12.863873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.6705
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 10.02GiB
2017-11-21 17:57:12.863895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2017-11-21 17:57:12.863899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2017-11-21 17:57:12.863905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
##### Training resnetb10 #####
2017-11-21 17:57:15.265391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
2017-11-21 17:57:41.036220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
[4.7218788174482489, 0.11989182692307693]
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 112, 112, 32) 4736        input_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 112, 112, 32) 128         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 32) 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 32)   0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 55, 55, 8)    264         max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 55, 55, 8)    32          res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 8)    0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 55, 55, 8)    584         activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 55, 55, 8)    32          res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 8)    0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 55, 55, 64)   576         activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, 55, 55, 64)   2112        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 55, 55, 64)   256         res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 64)   0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 64)   0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 55, 55, 8)    520         activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 55, 55, 8)    32          res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 8)    0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 55, 55, 8)    584         activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 55, 55, 8)    32          res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 8)    0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 55, 55, 64)   576         activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 64)   0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 64)   0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 55, 55, 8)    520         activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 55, 55, 8)    32          res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 8)    0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 55, 55, 8)    584         activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 55, 55, 8)    32          res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 8)    0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 55, 55, 64)   576         activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 55, 55, 64)   256         res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 64)   0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 64)   0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 8)    520         activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 8)    32          res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 8)    0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 8)    584         activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 8)    32          res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 8)    0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 128)  1152        activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, 28, 28, 128)  8320        activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 128)  512         res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 128)  0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 128)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 8)    1032        activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 8)    32          res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 8)    0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 8)    584         activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 8)    32          res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 8)    0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 128)  1152        activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 128)  0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 128)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 8)    1032        activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 8)    32          res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 8)    0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 8)    584         activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 8)    32          res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 8)    0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 128)  1152        activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 128)  0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 128)  0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, 28, 28, 8)    1032        activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, 28, 28, 8)    32          res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 8)    0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, 28, 28, 8)    584         activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, 28, 28, 8)    32          res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 8)    0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, 28, 28, 128)  1152        activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, 28, 28, 128)  512         res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 128)  0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 128)  0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 8)    1032        activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 8)    32          res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 8)    0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 8)    584         activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 8)    32          res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 8)    0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 128)  1152        activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, 14, 14, 128)  16512       activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 128)  512         res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 128)  0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 128)  0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 8)    1032        activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 8)    32          res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 8)    0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 8)    584         activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 8)    32          res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 8)    0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 128)  1152        activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 128)  0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 128)  0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 8)    1032        activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 8)    32          res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 8)    0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 8)    584         activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 8)    32          res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 8)    0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 128)  1152        activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 128)  0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 128)  0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 8)    1032        activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 8)    32          res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 8)    0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 8)    584         activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 8)    32          res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 8)    0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 128)  1152        activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 128)  0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 128)  0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 8)    1032        activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 8)    32          res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 8)    0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 8)    584         activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 8)    32          res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 8)    0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 128)  1152        activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 128)  0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 128)  0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, 14, 14, 8)    1032        activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, 14, 14, 8)    32          res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 8)    0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, 14, 14, 8)    584         activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, 14, 14, 8)    32          res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 8)    0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, 14, 14, 128)  1152        activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, 14, 14, 128)  512         res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 128)  0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 128)  0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 8)      1032        activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 8)      32          res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 8)      0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 8)      584         activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 8)      32          res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 8)      0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 256)    2304        activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, 7, 7, 256)    33024       activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 256)    1024        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 256)    0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 256)    0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 8)      2056        activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 8)      32          res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 8)      0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 8)      584         activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 8)      32          res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 8)      0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 256)    2304        activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 256)    0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 256)    0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 8)      2056        activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 8)      32          res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 8)      0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 8)      584         activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 8)      32          res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 8)      0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 256)    2304        activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 256)    1024        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 256)    0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 256)    0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 256)    0           activation_49[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 256)          0           avg_pool[0][0]
__________________________________________________________________________________________________
fc1000 (Dense)                  (None, 10)           2570        flatten_1[0][0]
==================================================================================================
Total params: 125,450
Trainable params: 119,242
Non-trainable params: 6,208
__________________________________________________________________________________________________
Epoch 1/40
780/781 [============================>.] - ETA: 0s - loss: 1.7009 - acc: 0.4049Epoch 00001: val_acc improved from -inf to 0.51663, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00001: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 148s 189ms/step - loss: 1.7004 - acc: 0.4050 - val_loss: 1.3197 - val_acc: 0.5166
Epoch 2/40
780/781 [============================>.] - ETA: 0s - loss: 1.2651 - acc: 0.5422Epoch 00002: val_acc improved from 0.51663 to 0.59430, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00002: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 141s 181ms/step - loss: 1.2651 - acc: 0.5423 - val_loss: 1.1362 - val_acc: 0.5943
Epoch 3/40
780/781 [============================>.] - ETA: 0s - loss: 1.1052 - acc: 0.6075Epoch 00003: val_acc improved from 0.59430 to 0.64040, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00003: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 142s 181ms/step - loss: 1.1049 - acc: 0.6076 - val_loss: 0.9992 - val_acc: 0.6404
Epoch 4/40
780/781 [============================>.] - ETA: 0s - loss: 1.0057 - acc: 0.6435Epoch 00004: val_acc improved from 0.64040 to 0.66858, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00004: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 141s 181ms/step - loss: 1.0054 - acc: 0.6437 - val_loss: 0.9452 - val_acc: 0.6686
Epoch 5/40
780/781 [============================>.] - ETA: 0s - loss: 0.9385 - acc: 0.6707Epoch 00005: val_acc improved from 0.66858 to 0.68025, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00005: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 145s 186ms/step - loss: 0.9386 - acc: 0.6707 - val_loss: 0.8985 - val_acc: 0.6803
Epoch 6/40
780/781 [============================>.] - ETA: 0s - loss: 0.8852 - acc: 0.6882Epoch 00006: val_acc improved from 0.68025 to 0.70773, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00006: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 174s 223ms/step - loss: 0.8849 - acc: 0.6884 - val_loss: 0.8317 - val_acc: 0.7077
Epoch 7/40
780/781 [============================>.] - ETA: 0s - loss: 0.8439 - acc: 0.7050Epoch 00007: val_acc improved from 0.70773 to 0.71769, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00007: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 166s 212ms/step - loss: 0.8435 - acc: 0.7051 - val_loss: 0.7969 - val_acc: 0.7177
Epoch 8/40
780/781 [============================>.] - ETA: 0s - loss: 0.8091 - acc: 0.7149Epoch 00008: val_acc improved from 0.71769 to 0.74889, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00008: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 166s 212ms/step - loss: 0.8088 - acc: 0.7151 - val_loss: 0.7151 - val_acc: 0.7489
Epoch 9/40
780/781 [============================>.] - ETA: 0s - loss: 0.7789 - acc: 0.7269Epoch 00009: val_acc did not improve
Epoch 00009: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 149s 191ms/step - loss: 0.7789 - acc: 0.7270 - val_loss: 0.7317 - val_acc: 0.7486
Epoch 10/40
780/781 [============================>.] - ETA: 0s - loss: 0.7507 - acc: 0.7389Epoch 00010: val_acc improved from 0.74889 to 0.76872, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00010: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 159s 203ms/step - loss: 0.7508 - acc: 0.7389 - val_loss: 0.6760 - val_acc: 0.7687
Epoch 11/40
780/781 [============================>.] - ETA: 0s - loss: 0.7294 - acc: 0.7461Epoch 00011: val_acc did not improve
Epoch 00011: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 139s 178ms/step - loss: 0.7292 - acc: 0.7462 - val_loss: 0.6713 - val_acc: 0.7685
Epoch 12/40
780/781 [============================>.] - ETA: 0s - loss: 0.7085 - acc: 0.7525Epoch 00012: val_acc improved from 0.76872 to 0.77043, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00012: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 146s 187ms/step - loss: 0.7086 - acc: 0.7525 - val_loss: 0.6568 - val_acc: 0.7704
Epoch 13/40
780/781 [============================>.] - ETA: 0s - loss: 0.6897 - acc: 0.7574Epoch 00013: val_acc did not improve
Epoch 00013: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 150s 192ms/step - loss: 0.6897 - acc: 0.7575 - val_loss: 0.6784 - val_acc: 0.7684
Epoch 14/40
780/781 [============================>.] - ETA: 0s - loss: 0.6770 - acc: 0.7647Epoch 00014: val_acc improved from 0.77043 to 0.78200, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00014: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 146s 187ms/step - loss: 0.6770 - acc: 0.7646 - val_loss: 0.6319 - val_acc: 0.7820
Epoch 15/40
780/781 [============================>.] - ETA: 0s - loss: 0.6612 - acc: 0.7701Epoch 00015: val_acc improved from 0.78200 to 0.78613, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00015: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 140s 180ms/step - loss: 0.6613 - acc: 0.7700 - val_loss: 0.6204 - val_acc: 0.7861
Epoch 16/40
780/781 [============================>.] - ETA: 0s - loss: 0.6513 - acc: 0.7723Epoch 00016: val_acc did not improve
Epoch 00016: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 140s 180ms/step - loss: 0.6512 - acc: 0.7723 - val_loss: 0.6388 - val_acc: 0.7761
Epoch 17/40
780/781 [============================>.] - ETA: 0s - loss: 0.6385 - acc: 0.7767Epoch 00017: val_acc improved from 0.78613 to 0.79549, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00017: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 152s 195ms/step - loss: 0.6382 - acc: 0.7768 - val_loss: 0.5938 - val_acc: 0.7955
Epoch 18/40
780/781 [============================>.] - ETA: 0s - loss: 0.6296 - acc: 0.7796Epoch 00018: val_acc improved from 0.79549 to 0.80465, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00018: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 152s 195ms/step - loss: 0.6296 - acc: 0.7796 - val_loss: 0.5826 - val_acc: 0.8046
Epoch 19/40
780/781 [============================>.] - ETA: 0s - loss: 0.6234 - acc: 0.7827Epoch 00019: val_acc did not improve
Epoch 00019: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 153s 195ms/step - loss: 0.6233 - acc: 0.7828 - val_loss: 0.5902 - val_acc: 0.7988
Epoch 20/40
780/781 [============================>.] - ETA: 0s - loss: 0.6141 - acc: 0.7864Epoch 00020: val_acc did not improve
Epoch 00020: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 158s 202ms/step - loss: 0.6143 - acc: 0.7864 - val_loss: 0.6170 - val_acc: 0.7928
Epoch 21/40
780/781 [============================>.] - ETA: 0s - loss: 0.6037 - acc: 0.7905Epoch 00021: val_acc did not improve
Epoch 00021: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 162s 208ms/step - loss: 0.6036 - acc: 0.7905 - val_loss: 0.5999 - val_acc: 0.7906
Epoch 22/40
780/781 [============================>.] - ETA: 0s - loss: 0.5975 - acc: 0.7913Epoch 00022: val_acc improved from 0.80465 to 0.80988, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00022: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 161s 206ms/step - loss: 0.5975 - acc: 0.7913 - val_loss: 0.5579 - val_acc: 0.8099
Epoch 23/40
780/781 [============================>.] - ETA: 0s - loss: 0.5933 - acc: 0.7917Epoch 00023: val_acc did not improve
Epoch 00023: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 157s 201ms/step - loss: 0.5933 - acc: 0.7917 - val_loss: 0.5727 - val_acc: 0.8007
Epoch 24/40
780/781 [============================>.] - ETA: 0s - loss: 0.5832 - acc: 0.7971Epoch 00024: val_acc did not improve
Epoch 00024: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 156s 199ms/step - loss: 0.5831 - acc: 0.7971 - val_loss: 0.5698 - val_acc: 0.8098
Epoch 25/40
780/781 [============================>.] - ETA: 0s - loss: 0.5796 - acc: 0.7973Epoch 00025: val_acc did not improve
Epoch 00025: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 142s 182ms/step - loss: 0.5798 - acc: 0.7973 - val_loss: 0.5748 - val_acc: 0.8002
Epoch 26/40
780/781 [============================>.] - ETA: 0s - loss: 0.5715 - acc: 0.7993Epoch 00026: val_acc improved from 0.80988 to 0.81320, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00026: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 154s 197ms/step - loss: 0.5715 - acc: 0.7993 - val_loss: 0.5338 - val_acc: 0.8132
Epoch 27/40
780/781 [============================>.] - ETA: 0s - loss: 0.5648 - acc: 0.8030Epoch 00027: val_acc did not improve
Epoch 00027: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 151s 193ms/step - loss: 0.5649 - acc: 0.8030 - val_loss: 0.5414 - val_acc: 0.8121
Epoch 28/40
780/781 [============================>.] - ETA: 0s - loss: 0.5579 - acc: 0.8055Epoch 00028: val_acc improved from 0.81320 to 0.81572, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00028: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 158s 203ms/step - loss: 0.5578 - acc: 0.8056 - val_loss: 0.5315 - val_acc: 0.8157
Epoch 29/40
780/781 [============================>.] - ETA: 0s - loss: 0.5548 - acc: 0.8063Epoch 00029: val_acc did not improve
Epoch 00029: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 155s 198ms/step - loss: 0.5548 - acc: 0.8063 - val_loss: 0.5471 - val_acc: 0.8139
Epoch 30/40
780/781 [============================>.] - ETA: 0s - loss: 0.5489 - acc: 0.8081Epoch 00030: val_acc improved from 0.81572 to 0.83283, saving model to ./resnet/results/b10_1/b10_best.h5
Epoch 00030: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 155s 198ms/step - loss: 0.5490 - acc: 0.8080 - val_loss: 0.4933 - val_acc: 0.8328
Epoch 31/40
780/781 [============================>.] - ETA: 0s - loss: 0.5463 - acc: 0.8095Epoch 00031: val_acc did not improve
Epoch 00031: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 160s 204ms/step - loss: 0.5464 - acc: 0.8094 - val_loss: 0.5163 - val_acc: 0.8196
Epoch 32/40
780/781 [============================>.] - ETA: 0s - loss: 0.5393 - acc: 0.8116Epoch 00032: val_acc did not improve
Epoch 00032: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 153s 196ms/step - loss: 0.5391 - acc: 0.8117 - val_loss: 0.5991 - val_acc: 0.7932
Epoch 33/40
780/781 [============================>.] - ETA: 0s - loss: 0.5340 - acc: 0.8150Epoch 00033: val_acc did not improve
Epoch 00033: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 164s 210ms/step - loss: 0.5336 - acc: 0.8151 - val_loss: 0.5627 - val_acc: 0.8065
Epoch 34/40
780/781 [============================>.] - ETA: 0s - loss: 0.5348 - acc: 0.8129Epoch 00034: val_acc did not improve
Epoch 00034: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 171s 219ms/step - loss: 0.5349 - acc: 0.8128 - val_loss: 0.5411 - val_acc: 0.8167
Epoch 35/40
780/781 [============================>.] - ETA: 0s - loss: 0.5270 - acc: 0.8157Epoch 00035: val_acc did not improve
Epoch 00035: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 170s 218ms/step - loss: 0.5269 - acc: 0.8158 - val_loss: 0.5184 - val_acc: 0.8240
Epoch 36/40
780/781 [============================>.] - ETA: 0s - loss: 0.5301 - acc: 0.8154Epoch 00036: val_acc did not improve
Epoch 00036: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 167s 214ms/step - loss: 0.5301 - acc: 0.8153 - val_loss: 0.5626 - val_acc: 0.8060
Epoch 37/40
780/781 [============================>.] - ETA: 0s - loss: 0.5164 - acc: 0.8205Epoch 00037: val_acc did not improve
Epoch 00037: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 163s 208ms/step - loss: 0.5164 - acc: 0.8205 - val_loss: 0.5064 - val_acc: 0.8256
Epoch 38/40
780/781 [============================>.] - ETA: 0s - loss: 0.5165 - acc: 0.8197Epoch 00038: val_acc did not improve
Epoch 00038: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 163s 209ms/step - loss: 0.5164 - acc: 0.8198 - val_loss: 0.5124 - val_acc: 0.8198
Epoch 39/40
780/781 [============================>.] - ETA: 0s - loss: 0.5139 - acc: 0.8208Epoch 00039: val_acc did not improve
Epoch 00039: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 167s 214ms/step - loss: 0.5140 - acc: 0.8207 - val_loss: 0.5555 - val_acc: 0.8097
Epoch 40/40
780/781 [============================>.] - ETA: 0s - loss: 0.5130 - acc: 0.8214Epoch 00040: val_acc did not improve
Epoch 00040: saving model to ./resnet/results/b10_1/b10.h5
781/781 [==============================] - 169s 217ms/step - loss: 0.5129 - acc: 0.8214 - val_loss: 0.5162 - val_acc: 0.8238

Process finished with exit code 0
